(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{133:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parse=exports.download=exports.canUseDOM=exports.MIMETYPES=exports.parseCSV=exports.parseExcel=void 0;const excel_1=__webpack_require__(956);Object.defineProperty(exports,"parseExcel",{enumerable:!0,get:function(){return excel_1.parseExcel}});const csv_1=__webpack_require__(958);var MIMETYPES;Object.defineProperty(exports,"parseCSV",{enumerable:!0,get:function(){return csv_1.parseCSV}}),function(MIMETYPES){MIMETYPES.CSV="text/csv",MIMETYPES.EXCEL="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}(MIMETYPES=exports.MIMETYPES||(exports.MIMETYPES={})),exports.canUseDOM=!("undefined"==typeof window||!window.document||!window.document.createElement),exports.download=async({sheets:sheets=[],filename:filename="download",type:type="excel"})=>{switch(type){case"excel":{const buffer=await excel_1.createExcelFileFromSheets(sheets),blob=new Blob([buffer],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});if(!exports.canUseDOM)return blob;const url=window.URL.createObjectURL(blob),anchor=document.createElement("a");anchor.href=url,anchor.download=filename+".xlsx",anchor.dispatchEvent(new MouseEvent("click"));break}case"csv":{const buffer=await csv_1.createCSVFromSheets(sheets),blob=new Blob([buffer],{type:"text/csv"});if(!exports.canUseDOM)return blob;const url=window.URL.createObjectURL(blob),anchor=document.createElement("a");anchor.href=url,anchor.download=filename+".csv",anchor.dispatchEvent(new MouseEvent("click"))}}},exports.parse=async({file:file})=>{if(!file)throw"File is invalid";switch(file.type){case MIMETYPES.CSV:return csv_1.parseCSV({file:file});case MIMETYPES.EXCEL:return excel_1.parseExcel({file:file});default:throw"File type is not supported. Supported file types are xlsx and csv"}}},253:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const Cell_1=__importDefault(__webpack_require__(935));exports.default=Cell_1.default},254:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.FILTER_ICON_DIM=void 0;const react_1=__importStar(__webpack_require__(1)),react_konva_1=__webpack_require__(10);exports.FILTER_ICON_DIM=16;exports.default=({x:x=0,y:y=0,width:width=0,height:height=0,rowIndex:rowIndex,columnIndex:columnIndex,onClick:onClick,isActive:isActive})=>{const[isHovered,setIsHovered]=react_1.useState(!1),padding=(height-exports.FILTER_ICON_DIM)/2,posX=x+width-exports.FILTER_ICON_DIM-2,posY=y+padding+.5,handleMouseEnter=react_1.useCallback(()=>{setIsHovered(!0)},[]),handleMouseLeave=react_1.useCallback(()=>{setIsHovered(!1)},[]);return react_1.default.createElement(react_konva_1.Group,{onClick:e=>{null==onClick||onClick({rowIndex:rowIndex,columnIndex:columnIndex})},onMouseEnter:handleMouseEnter,onMouseLeave:handleMouseLeave},react_1.default.createElement(react_konva_1.Rect,{x:posX,y:posY,width:exports.FILTER_ICON_DIM,height:exports.FILTER_ICON_DIM,fill:isHovered?"green":"white",cornerRadius:2}),react_1.default.createElement(react_konva_1.Path,{data:isActive?"M19 6h-14c-1.1 0-1.4.6-.6 1.4l4.2 4.2c.8.8 1.4 2.3 1.4 3.4v5l4-2v-3.5c0-.8.6-2.1 1.4-2.9l4.2-4.2c.8-.8.5-1.4-.6-1.4z":"M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z",x:posX+1,y:posY+1,fill:isHovered?"white":"green",scaleY:.6,scaleX:.6,listening:!1}))}},30:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.DEFAULT_CHECKBOX_VALUES=exports.getEditorType=exports.changeDecimals=exports.splitDecimals=exports.cellsInSelectionVariant=exports.dashArray=exports.dotArray=exports.luminance=exports.DEFAULT_FONT_FAMILY=exports.DEFAULT_FONT_SIZE=exports.DEFAULT_DATE_FORMAT=exports.SCALE_VALUES=exports.AVAILABLE_CURRENCY_FORMATS=exports.AVAILABLE_FORMATS=exports.FONT_FAMILIES=exports.FONT_SIZES=exports.detectDataType=exports.isNumeric=exports.format=exports.castToString=exports.uuid=exports.createNewSheet=exports.cellToAddress=exports.addressToCell=exports.alpha2number=exports.number2Alpha=exports.HYPERLINK_COLOR=exports.INFO_COLOR=exports.ERROR_COLOR=exports.INVALID_COLOR=exports.SYSTEM_FONT=exports.FORMAT_DEFAULT_DECIMAL=exports.FORMAT_CURRENCY=exports.FORMAT_PERCENT=exports.CELL_BORDER_COLOR=exports.HEADER_BORDER_COLOR=exports.EMPTY_ARRAY=exports.DARK_MODE_COLOR_LIGHT=exports.DARK_MODE_COLOR=exports.DEFAULT_COLUMN_WIDTH=exports.DEFAULT_ROW_HEIGHT=exports.ROW_HEADER_HEIGHT=exports.FORMULABAR_LEFT_CORNER_WIDTH=exports.COLUMN_HEADER_WIDTH=exports.DEFAULT_COLUMN_COUNT=exports.DEFAULT_ROW_COUNT=void 0;const types_1=__webpack_require__(90),grid_1=__webpack_require__(6),ssf_1=__importDefault(__webpack_require__(835));exports.DEFAULT_ROW_COUNT=1e3,exports.DEFAULT_COLUMN_COUNT=1e3,exports.COLUMN_HEADER_WIDTH=46,exports.FORMULABAR_LEFT_CORNER_WIDTH=47,exports.ROW_HEADER_HEIGHT=24,exports.DEFAULT_ROW_HEIGHT=21,exports.DEFAULT_COLUMN_WIDTH=100,exports.DARK_MODE_COLOR="rgb(26, 32, 44)",exports.DARK_MODE_COLOR_LIGHT="#252E3E",exports.EMPTY_ARRAY=[],exports.HEADER_BORDER_COLOR="#C0C0C0",exports.CELL_BORDER_COLOR="#E3E2E2",exports.FORMAT_PERCENT="0.00%",exports.FORMAT_CURRENCY="$0.00",exports.FORMAT_DEFAULT_DECIMAL="0.0",exports.SYSTEM_FONT="-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji",exports.INVALID_COLOR="#FF5621",exports.ERROR_COLOR="#C63929",exports.INFO_COLOR="#1D72E8",exports.HYPERLINK_COLOR="#1155CC",exports.number2Alpha=i=>((i>=26?exports.number2Alpha((i/26>>0)-1):"")+"abcdefghijklmnopqrstuvwxyz"[i%26>>0]).toUpperCase(),exports.alpha2number=letters=>letters.split("").reduce((r,a)=>26*r+parseInt(a,36)-9,0),exports.addressToCell=address=>{const regex=/([A-Z]+)(\d+)/gim;let m,matches=[];for(;null!==(m=regex.exec(address));)m.index===regex.lastIndex&&regex.lastIndex++,m.forEach((match,groupIndex)=>{groupIndex>0&&matches.push(match)});if(!matches.length)return null;const[columnAlpha,rowIndex]=matches;return{rowIndex:parseInt(rowIndex),columnIndex:exports.alpha2number(columnAlpha)}},exports.cellToAddress=cell=>cell?`${exports.number2Alpha(cell.columnIndex-1)}${cell.rowIndex}`:null,exports.createNewSheet=({count:count})=>({id:exports.uuid(),name:"Sheet"+count,cells:{},activeCell:{rowIndex:1,columnIndex:1},selections:[],scrollState:{scrollTop:0,scrollLeft:0},columnSizes:{},rowSizes:{}}),exports.uuid=()=>"_"+Math.random().toString(36).substr(2,9),exports.castToString=value=>{if(null!=value)return"string"!=typeof value?""+value:value},exports.format=(value,datatype,cellConfig)=>{if(void 0===value||grid_1.isNull(value)||grid_1.isNull(datatype))return exports.castToString(value);if(!cellConfig)return exports.castToString(value);if("date"===datatype)return ssf_1.default.format(cellConfig.format||exports.DEFAULT_DATE_FORMAT,value);const num=parseFloat("string"!=typeof value?""+value:value);try{if(cellConfig.decimals){let fmt=Array.from({length:cellConfig.decimals}).map((_,i)=>"0").join("");value=ssf_1.default.format("#."+fmt,num)}cellConfig.percent&&(value=ssf_1.default.format(exports.FORMAT_PERCENT,num)),cellConfig.currency&&(value=ssf_1.default.format(`${cellConfig.currencySymbol||"$"}${exports.FORMAT_CURRENCY}`,num)),cellConfig.format&&(value=ssf_1.default.format(cellConfig.format,num))}catch(err){console.error("Error while formatting ",num,err)}return""+value},exports.isNumeric=cell=>cell&&"number"===cell.datatype,exports.detectDataType=value=>{var _a;if(!grid_1.isNull(value))return isNaN(Number(value))?(null===(_a=exports.castToString(value))||void 0===_a?void 0:_a.startsWith("="))?"formula":void 0:"number"},exports.FONT_SIZES=[6,7,8,9,10,11,12,14,18,24,36],exports.FONT_FAMILIES=["Arial","Helvetica","Source Sans Pro","Comic Sans MS","Courier New","Verdana","Times New Roman"],exports.AVAILABLE_FORMATS=[{label:"Number",value:"0.00",sample:"1,000.12"},{label:"Percent",value:exports.FORMAT_PERCENT,sample:"10.12%"},{label:"Scientific",value:"0.00E+00",sample:"1.01E+03"}],exports.AVAILABLE_CURRENCY_FORMATS=[{label:"Accounting",value:"$(0.00)",sample:"$(1,000.12)"},{label:"Financial",value:"(0.00)",sample:"(1,000.12)"},{label:"Currency",value:exports.FORMAT_CURRENCY,sample:"$1,000.00"},{label:"Currency (rounded)",value:"$#",sample:"$1,000"}],exports.SCALE_VALUES=[{label:"50%",value:.5},{label:"75%",value:.75},{label:"100%",value:1},{label:"125%",value:1.25},{label:"150%",value:1.5},{label:"200%",value:2}],exports.DEFAULT_DATE_FORMAT="d-mmm-yy",exports.DEFAULT_FONT_SIZE=12,exports.DEFAULT_FONT_FAMILY="Arial",exports.luminance=(color,amount)=>color&&color.startsWith("#")?"#"+color.replace(/^#/,"").replace(/../g,color=>("0"+Math.min(255,Math.max(0,parseInt(color,16)+amount)).toString(16)).substr(-2)):color;const dpr=grid_1.canUseDOM?window.devicePixelRatio:1,dprRounded=Math.floor(dpr/2),dashDotWidth=Math.max(Math.floor(dpr/2),.5);exports.dotArray=1===dpr?[dashDotWidth,dashDotWidth+dpr]:[dashDotWidth+dprRounded,dashDotWidth+dprRounded],exports.dashArray=[2,2],exports.cellsInSelectionVariant=(selections,variant,borderStyle=types_1.BORDER_STYLE.THIN,color,boundGetter)=>{var _a;const thickness=borderStyle===types_1.BORDER_STYLE.MEDIUM?2:borderStyle===types_1.BORDER_STYLE.THICK?3:1,dash=borderStyle===types_1.BORDER_STYLE.DASHED?exports.dashArray:borderStyle===types_1.BORDER_STYLE.DOTTED?exports.dotArray:[],lineCap=dash.length>0?"butt":"square",cells={};for(let i=0;i<selections.length;i++){const{bounds:bounds}=selections[i];for(let j=bounds.top;j<=bounds.bottom;j++){cells[j]=null!==(_a=cells[j])&&void 0!==_a?_a:{};for(let k=bounds.left;k<=bounds.right;k++){cells[j][k]=cells[j][k]||{};const actualBounds=null==boundGetter?void 0:boundGetter({rowIndex:j,columnIndex:k}),{rowIndex:rowIndex,columnIndex:columnIndex}=actualBounds?{rowIndex:actualBounds.top,columnIndex:actualBounds.left}:{rowIndex:j,columnIndex:k};switch(variant){case types_1.BORDER_VARIANT.OUTER:j===bounds.top&&(cells[rowIndex][columnIndex]={...cells[rowIndex][columnIndex],strokeTopColor:color,strokeTopWidth:thickness,strokeTopDash:dash,lineCap:lineCap}),k===bounds.right&&(cells[rowIndex][columnIndex]={...cells[rowIndex][columnIndex],strokeRightColor:color,strokeRightWidth:thickness,strokeRightDash:dash,lineCap:lineCap}),j===bounds.bottom&&(cells[rowIndex][columnIndex]={...cells[rowIndex][columnIndex],strokeBottomColor:color,strokeBottomWidth:thickness,strokeBottomDash:dash,lineCap:lineCap}),k===bounds.left&&(cells[rowIndex][columnIndex]={...cells[rowIndex][columnIndex],strokeLeftColor:color,strokeLeftWidth:thickness,strokeLeftDash:dash,lineCap:lineCap});break;case types_1.BORDER_VARIANT.ALL:cells[rowIndex][columnIndex]={strokeTopColor:color,strokeTopWidth:thickness,strokeTopDash:dash,strokeLeftColor:color,strokeLeftWidth:thickness,strokeLeftDash:dash,strokeRightColor:color,strokeRightDash:dash,strokeRightWidth:thickness,strokeBottomColor:color,strokeBottomDash:dash,strokeBottomWidth:thickness,lineCap:lineCap};break;case types_1.BORDER_VARIANT.INNER:k!==bounds.left&&k!==bounds.right&&(cells[rowIndex][columnIndex]={...cells[rowIndex][columnIndex],strokeLeftColor:color,strokeLeftWidth:thickness,strokeLeftDash:dash,strokeRightColor:color,strokeRightDash:dash,strokeRightWidth:thickness}),j!==bounds.top&&j!==bounds.bottom&&(cells[rowIndex][columnIndex]={...cells[rowIndex][columnIndex],strokeTopColor:color,strokeTopWidth:thickness,strokeTopDash:dash,strokeBottomColor:color,strokeBottomDash:dash,strokeBottomWidth:thickness}),bounds.top!==bounds.bottom&&(j===bounds.top&&(cells[rowIndex][columnIndex]={...cells[rowIndex][columnIndex],strokeBottomColor:color,strokeBottomDash:dash,strokeBottomWidth:thickness}),j===bounds.bottom&&(cells[rowIndex][columnIndex]={...cells[rowIndex][columnIndex],strokeTopColor:color,strokeTopDash:dash,strokeTopWidth:thickness})),bounds.left!==bounds.right&&(k===bounds.left&&(cells[rowIndex][columnIndex]={...cells[rowIndex][columnIndex],strokeRightColor:color,strokeRightDash:dash,strokeRightWidth:thickness}),k===bounds.right&&(cells[rowIndex][columnIndex]={...cells[rowIndex][columnIndex],strokeLeftColor:color,strokeLeftDash:dash,strokeLeftWidth:thickness}));break;case types_1.BORDER_VARIANT.HORIZONTAL:cells[rowIndex][columnIndex]={strokeBottomColor:color,strokeBottomDash:dash,strokeBottomWidth:thickness,lineCap:lineCap},j===bounds.bottom&&(cells[rowIndex][columnIndex]={});break;case types_1.BORDER_VARIANT.VERTICAL:cells[rowIndex][columnIndex]={strokeRightColor:color,strokeRightDash:dash,strokeRightWidth:thickness,lineCap:lineCap},k===bounds.right&&(cells[rowIndex][columnIndex]={});break;case types_1.BORDER_VARIANT.LEFT:k===bounds.left&&(cells[rowIndex][columnIndex]={...cells[rowIndex][columnIndex],strokeLeftColor:color,strokeLeftDash:dash,strokeLeftWidth:thickness,lineCap:lineCap});break;case types_1.BORDER_VARIANT.RIGHT:k===bounds.right&&(cells[rowIndex][columnIndex]={...cells[rowIndex][columnIndex],strokeRightColor:color,strokeRightDash:dash,strokeRightWidth:thickness,lineCap:lineCap});break;case types_1.BORDER_VARIANT.TOP:j===bounds.top&&(cells[rowIndex][columnIndex]={...cells[rowIndex][columnIndex],strokeTopColor:color,strokeTopDash:dash,strokeTopWidth:thickness,lineCap:lineCap});break;case types_1.BORDER_VARIANT.BOTTOM:j===bounds.bottom&&(cells[rowIndex][columnIndex]={...cells[rowIndex][columnIndex],strokeBottomColor:color,strokeBottomDash:dash,strokeBottomWidth:thickness,lineCap:lineCap})}}}}return cells},exports.splitDecimals=str=>{const regex=/(\d+)(.*)/gm;let m;const matches=[];for(;null!==(m=regex.exec(str));)m.index===regex.lastIndex&&regex.lastIndex++,m.forEach((match,groupIndex)=>{groupIndex>0&&matches.push(match)});return matches},exports.changeDecimals=(format,step=1)=>{if(step<0&&!format)return format;if(!format)return exports.FORMAT_DEFAULT_DECIMAL;const DEFAULT_FORMAT=format+".0",decimalIndex=format.indexOf(".");if(-1===decimalIndex)return step<0?format:DEFAULT_FORMAT;const decimalPortion=format.substr(decimalIndex+1),[num,suffix]=exports.splitDecimals(decimalPortion);if(""===num)return DEFAULT_FORMAT;const len=num.length+step;return len<=0?format.substr(0,decimalIndex):format.substr(0,decimalIndex)+"."+Array.from({length:len}).map((_,i)=>"0").join("")+suffix},exports.getEditorType=type=>{switch(type){case"list":return types_1.EditorType.LIST;default:return types_1.EditorType.TEXT}},exports.DEFAULT_CHECKBOX_VALUES=["TRUE","FALSE"]},370:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.RESET_SCROLL_EVENTS_DEBOUNCE_INTERVAL=void 0;const react_1=__importStar(__webpack_require__(1)),ReactKonvaCore_1=__webpack_require__(371),helpers_1=__webpack_require__(61),Cell_1=__webpack_require__(378),CellOverlay_1=__webpack_require__(383),Selection_1=__importDefault(__webpack_require__(789)),FillHandle_1=__importDefault(__webpack_require__(790)),GridLine_1=__importDefault(__webpack_require__(791)),utils_1=__webpack_require__(384),tiny_invariant_1=__importDefault(__webpack_require__(249)),types_1=__webpack_require__(62),defaultShadowSettings={strokeWidth:1},defaultRowHeight=()=>20,defaultColumnWidth=()=>60,defaultSelectionRenderer=props=>react_1.default.createElement(Selection_1.default,Object.assign({},props)),defaultGridLineRenderer=props=>react_1.default.createElement(GridLine_1.default,Object.assign({},props));exports.RESET_SCROLL_EVENTS_DEBOUNCE_INTERVAL=150;const EMPTY_ARRAY=[],Grid=react_1.memo(react_1.forwardRef((props,forwardedRef)=>{const{width:containerWidth=800,height:containerHeight=600,estimatedColumnWidth:estimatedColumnWidth,estimatedRowHeight:estimatedRowHeight,rowHeight:rowHeight=defaultRowHeight,columnWidth:columnWidth=defaultColumnWidth,rowCount:rowCount=0,columnCount:columnCount=0,scrollbarSize:scrollbarSize=13,onScroll:onScroll,onImmediateScroll:onImmediateScroll,showScrollbar:showScrollbar=!0,selectionBackgroundColor:selectionBackgroundColor="rgb(14, 101, 235, 0.1)",selectionBorderColor:selectionBorderColor="#1a73e8",selectionStrokeWidth:selectionStrokeWidth=1,activeCellStrokeWidth:activeCellStrokeWidth=2,activeCell:activeCell,selections:selections=EMPTY_ARRAY,frozenRows:frozenRows=0,frozenColumns:frozenColumns=0,itemRenderer:itemRenderer=Cell_1.CellRenderer,enableCellOverlay:enableCellOverlay=!1,overlayRenderer:overlayRenderer=CellOverlay_1.CellRenderer,mergedCells:mergedCells=EMPTY_ARRAY,snap:snap=!1,scrollThrottleTimeout:scrollThrottleTimeout=100,onViewChange:onViewChange,selectionRenderer:selectionRenderer=defaultSelectionRenderer,onBeforeRenderRow:onBeforeRenderRow,showFrozenShadow:showFrozenShadow=!1,shadowSettings:shadowSettings=defaultShadowSettings,borderStyles:borderStyles=EMPTY_ARRAY,children:children,stageProps:stageProps,wrapper:wrapper=(children=>children),cellAreas:cellAreas=EMPTY_ARRAY,showFillHandle:showFillHandle=!0,fillSelection:fillSelection,overscanCount:overscanCount=1,fillHandleProps:fillHandleProps,fillhandleBorderColor:fillhandleBorderColor="white",showGridLines:showGridLines=!1,gridLineColor:gridLineColor="#E3E2E2",gridLineWidth:gridLineWidth=1,gridLineRenderer:gridLineRenderer=defaultGridLineRenderer,isHiddenRow:isHiddenRow,isHiddenColumn:isHiddenColumn,isHiddenCell:isHiddenCell,scale:scale=1,...rest}=props;tiny_invariant_1.default(!(children&&"function"!=typeof children),"Children should be a function"),react_1.useImperativeHandle(forwardedRef,()=>({scrollTo:scrollTo,scrollBy:scrollBy,scrollToItem:scrollToItem,stage:stageRef.current,container:containerRef.current,resetAfterIndices:resetAfterIndices,getScrollPosition:getScrollPosition,isMergedCell:isMergedCell,getCellBounds:getCellBounds,getCellCoordsFromOffset:getCellCoordsFromOffset,getCellOffsetFromCoords:getCellOffsetFromCoords,getActualCellCoords:getActualCellCoords,focus:focusContainer,resizeColumns:resizeColumns,resizeRows:resizeRows,getViewPort:getViewPort,getRelativePositionFromOffset:getRelativePositionFromOffset,scrollToTop:scrollToTop,getDimensions:getDimensions}));const instanceProps=react_1.useRef({columnMetadataMap:{},rowMetadataMap:{},lastMeasuredColumnIndex:-1,lastMeasuredRowIndex:-1,estimatedColumnWidth:estimatedColumnWidth||50,estimatedRowHeight:estimatedRowHeight||50,recalcColumnIndices:[],recalcRowIndices:[]}),stageRef=react_1.useRef(null),containerRef=react_1.useRef(null),verticalScrollRef=react_1.useRef(null),wheelingRef=react_1.useRef(null),horizontalScrollRef=react_1.useRef(null),[_,forceRender]=(react_1.useRef(null),react_1.useReducer(s=>s+1,0)),[scrollState,setScrollState]=react_1.useState({scrollTop:0,scrollLeft:0,isScrolling:!1,verticalScrollDirection:types_1.Direction.Down,horizontalScrollDirection:types_1.Direction.Right}),scrollSnapRefs=react_1.useRef(null),{scrollTop:scrollTop,scrollLeft:scrollLeft,isScrolling:isScrolling,verticalScrollDirection:verticalScrollDirection,horizontalScrollDirection:horizontalScrollDirection}=scrollState,isMounted=react_1.useRef(!1),focusContainer=react_1.useCallback(()=>{var _a;return null===(_a=containerRef.current)||void 0===_a?void 0:_a.focus()},[]);react_1.useEffect(()=>{isMounted.current&&(null==onScroll||onScroll({scrollTop:scrollTop,scrollLeft:scrollLeft}))},[scrollTop,scrollLeft]),react_1.useEffect(()=>{var _a;return null===(_a=containerRef.current)||void 0===_a||_a.addEventListener("wheel",handleWheel,{passive:!1}),isMounted.current=!0,()=>{var _a;null===(_a=containerRef.current)||void 0===_a||_a.removeEventListener("wheel",handleWheel)}},[]);const getScrollPosition=react_1.useCallback(()=>({scrollTop:scrollTop,scrollLeft:scrollLeft}),[scrollTop,scrollLeft]),resetAfterIndices=react_1.useCallback(({columnIndex:columnIndex,rowIndex:rowIndex},shouldForceUpdate=!0)=>{"number"==typeof columnIndex&&(instanceProps.current.recalcColumnIndices=[],instanceProps.current.lastMeasuredColumnIndex=Math.min(instanceProps.current.lastMeasuredColumnIndex,columnIndex-1)),"number"==typeof rowIndex&&(instanceProps.current.recalcRowIndices=[],instanceProps.current.lastMeasuredRowIndex=Math.min(instanceProps.current.lastMeasuredRowIndex,rowIndex-1)),shouldForceUpdate&&forceRender()},[]),mergedCellMap=react_1.useMemo(()=>{const mergedCellMap=new Map;for(let i=0;i<mergedCells.length;i++){const bounds=mergedCells[i],{top:top,left:left}=bounds;for(const cell of helpers_1.getBoundedCells(bounds))mergedCellMap.set(cell,bounds)}return mergedCellMap},[mergedCells]),isMergedCell=react_1.useCallback(({rowIndex:rowIndex,columnIndex:columnIndex})=>mergedCellMap.has(helpers_1.cellIdentifier(rowIndex,columnIndex)),[mergedCells]),getCellBounds=react_1.useCallback(({rowIndex:rowIndex,columnIndex:columnIndex},spanMerges=!0)=>{if(spanMerges){if(isMergedCell({rowIndex:rowIndex,columnIndex:columnIndex}))return mergedCellMap.get(helpers_1.cellIdentifier(rowIndex,columnIndex))}return{top:rowIndex,left:columnIndex,right:columnIndex,bottom:rowIndex}},[mergedCellMap]),getActualCellCoords=react_1.useCallback(({rowIndex:rowIndex,columnIndex:columnIndex})=>{if(isMergedCell({rowIndex:rowIndex,columnIndex:columnIndex})){const cell=mergedCellMap.get(helpers_1.cellIdentifier(rowIndex,columnIndex));return{rowIndex:null==cell?void 0:cell.top,columnIndex:null==cell?void 0:cell.left}}return{rowIndex:rowIndex,columnIndex:columnIndex}},[mergedCellMap]),[rowStartIndex,rowStopIndex,visibleRowStartIndex,visibleRowStopIndex]=(()=>{const frozenRowHeight=helpers_1.getRowOffset({index:frozenRows,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),startIndex=helpers_1.getRowStartIndexForOffset({rowHeight:rowHeight,columnWidth:columnWidth,rowCount:rowCount,columnCount:columnCount,instanceProps:instanceProps.current,offset:scrollTop+frozenRowHeight,scale:scale}),stopIndex=helpers_1.getRowStopIndexForStartIndex({startIndex:startIndex,rowCount:rowCount,rowHeight:rowHeight,columnWidth:columnWidth,scrollTop:scrollTop,containerHeight:containerHeight,instanceProps:instanceProps.current,scale:scale}),overscanBackward=isScrolling&&verticalScrollDirection!==types_1.Direction.Up?1:Math.max(1,overscanCount),overscanForward=isScrolling&&verticalScrollDirection!==types_1.Direction.Down?1:Math.max(1,overscanCount);return[Math.max(0,startIndex-overscanBackward),Math.max(0,Math.min(rowCount-1,stopIndex+overscanForward)),startIndex,stopIndex]})(),[columnStartIndex,columnStopIndex,visibleColumnStartIndex,visibleColumnStopIndex]=(()=>{const frozenColumnWidth=helpers_1.getColumnOffset({index:frozenColumns,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),startIndex=helpers_1.getColumnStartIndexForOffset({rowHeight:rowHeight,columnWidth:columnWidth,rowCount:rowCount,columnCount:columnCount,instanceProps:instanceProps.current,offset:scrollLeft+frozenColumnWidth,scale:scale}),stopIndex=helpers_1.getColumnStopIndexForStartIndex({startIndex:startIndex,columnCount:columnCount,rowHeight:rowHeight,columnWidth:columnWidth,scrollLeft:scrollLeft,containerWidth:containerWidth,instanceProps:instanceProps.current,scale:scale}),overscanBackward=isScrolling&&horizontalScrollDirection!==types_1.Direction.Left?1:Math.max(1,overscanCount),overscanForward=isScrolling&&horizontalScrollDirection!==types_1.Direction.Right?1:Math.max(1,overscanCount);return[Math.max(0,startIndex-overscanBackward),Math.max(0,Math.min(columnCount-1,stopIndex+overscanForward)),startIndex,stopIndex]})(),estimatedTotalHeight=helpers_1.getEstimatedTotalHeight(rowCount,instanceProps.current),estimatedTotalWidth=helpers_1.getEstimatedTotalWidth(columnCount,instanceProps.current),getDimensions=react_1.useCallback(()=>({containerWidth:containerWidth,containerHeight:containerHeight,estimatedTotalWidth:estimatedTotalWidth,estimatedTotalHeight:estimatedTotalHeight}),[containerWidth,containerHeight,estimatedTotalWidth,estimatedTotalHeight]);react_1.useEffect(()=>{snap&&(scrollSnapRefs.current={visibleRowStartIndex:visibleRowStartIndex,rowCount:rowCount,frozenRows:frozenRows,visibleColumnStartIndex:visibleColumnStartIndex,columnCount:columnCount,frozenColumns:frozenColumns,isHiddenRow:isHiddenRow,isHiddenColumn:isHiddenColumn})},[snap,visibleRowStartIndex,rowCount,frozenRows,visibleColumnStartIndex,columnCount,frozenColumns,isHiddenRow,isHiddenColumn]);const snapToRowFn=react_1.useCallback(({deltaY:deltaY})=>{if(verticalScrollRef.current&&scrollSnapRefs.current&&0!==deltaY){const direction=deltaY<0?types_1.Direction.Up:types_1.Direction.Down,{visibleRowStartIndex:visibleRowStartIndex,rowCount:rowCount,isHiddenRow:isHiddenRow}=scrollSnapRefs.current;let nextRowIndex=direction===types_1.Direction.Up?Math.max(0,visibleRowStartIndex-1):Math.min(visibleRowStartIndex,rowCount-1);nextRowIndex=helpers_1.clampIndex(nextRowIndex,isHiddenRow,direction);const rowHeight=helpers_1.getRowHeight(nextRowIndex,instanceProps.current);verticalScrollRef.current.scrollTop+=(direction===types_1.Direction.Up?-1:1)*rowHeight}},[]),snapToColumnFn=react_1.useCallback(({deltaX:deltaX})=>{if(horizontalScrollRef.current&&scrollSnapRefs.current&&0!==deltaX){const{visibleColumnStartIndex:visibleColumnStartIndex,columnCount:columnCount,isHiddenColumn:isHiddenColumn}=scrollSnapRefs.current,direction=deltaX<0?types_1.Direction.Left:types_1.Direction.Right;let nextColumnIndex=direction===types_1.Direction.Left?Math.max(0,visibleColumnStartIndex-1):Math.min(visibleColumnStartIndex,columnCount-1);nextColumnIndex=helpers_1.clampIndex(nextColumnIndex,isHiddenColumn,direction);const columnWidth=helpers_1.getColumnWidth(nextColumnIndex,instanceProps.current);horizontalScrollRef.current.scrollLeft+=(direction===types_1.Direction.Left?-1:1)*columnWidth}},[]),snapToRowThrottler=react_1.useRef(helpers_1.throttle(snapToRowFn,scrollThrottleTimeout)),snapToColumnThrottler=react_1.useRef(helpers_1.throttle(snapToColumnFn,scrollThrottleTimeout)),frozenColumnWidth=helpers_1.getColumnOffset({index:frozenColumns,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),frozenRowHeight=helpers_1.getRowOffset({index:frozenRows,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),isWithinFrozenColumnBoundary=react_1.useCallback(x=>frozenColumns>0&&x<frozenColumnWidth,[frozenColumns,frozenColumnWidth]),isWithinFrozenRowBoundary=react_1.useCallback(y=>frozenRows>0&&y<frozenRowHeight,[frozenRows,frozenRowHeight]),getRelativePositionFromOffset=react_1.useCallback((left,top)=>{var _a;if(tiny_invariant_1.default("number"==typeof left&&"number"==typeof top,"Top and left should be a number"),!stageRef.current)return null;const stage=stageRef.current.getStage(),rect=null===(_a=containerRef.current)||void 0===_a?void 0:_a.getBoundingClientRect();rect&&(left-=rect.x,top-=rect.y);const{x:x,y:y}=stage.getAbsoluteTransform().copy().invert().point({x:left,y:top});return{x:x,y:y}},[]),getCellCoordsFromOffset=react_1.useCallback((left,top)=>{const pos=getRelativePositionFromOffset(left,top);if(!pos)return null;const{x:x,y:y}=pos,rowIndex=helpers_1.getRowStartIndexForOffset({rowHeight:rowHeight,columnWidth:columnWidth,rowCount:rowCount,columnCount:columnCount,instanceProps:instanceProps.current,offset:isWithinFrozenRowBoundary(y)?y:y+scrollTop,scale:scale}),columnIndex=helpers_1.getColumnStartIndexForOffset({rowHeight:rowHeight,columnWidth:columnWidth,rowCount:rowCount,columnCount:columnCount,instanceProps:instanceProps.current,offset:isWithinFrozenColumnBoundary(x)?x:x+scrollLeft,scale:scale}),bounds=getCellBounds({rowIndex:rowIndex,columnIndex:columnIndex});return{rowIndex:bounds.top,columnIndex:bounds.left}},[scrollLeft,rowHeight,columnWidth,scrollTop,rowCount,columnCount,mergedCellMap]),getCellOffsetFromCoords=react_1.useCallback(cell=>{const{top:rowIndex,left:columnIndex,right:right,bottom:bottom}=getCellBounds(cell),x=helpers_1.getColumnOffset({index:columnIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),y=helpers_1.getRowOffset({index:rowIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});return{x:x,y:y,width:helpers_1.getColumnOffset({index:right+1,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-x,height:helpers_1.getRowOffset({index:bottom+1,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-y}},[mergedCellMap]),resizeColumns=react_1.useCallback(indices=>{const leftMost=Math.min(...indices);resetAfterIndices({columnIndex:leftMost},!1),instanceProps.current.recalcColumnIndices=indices,forceRender()},[]),resizeRows=react_1.useCallback(indices=>{const topMost=Math.min(...indices);resetAfterIndices({rowIndex:topMost},!1),instanceProps.current.recalcRowIndices=indices,forceRender()},[]);react_1.useEffect(()=>{instanceProps.current.recalcColumnIndices.length&&(instanceProps.current.recalcColumnIndices.length=0),instanceProps.current.recalcRowIndices.length&&(instanceProps.current.recalcRowIndices.length=0)},[rowStopIndex,columnStopIndex,scale]);const getViewPort=react_1.useCallback(()=>({rowStartIndex:rowStartIndex,rowStopIndex:rowStopIndex,columnStartIndex:columnStartIndex,columnStopIndex:columnStopIndex,visibleRowStartIndex:visibleRowStartIndex,visibleRowStopIndex:visibleRowStopIndex,visibleColumnStartIndex:visibleColumnStartIndex,visibleColumnStopIndex:visibleColumnStopIndex}),[rowStartIndex,rowStopIndex,columnStartIndex,columnStopIndex,visibleRowStartIndex,visibleRowStopIndex,visibleColumnStartIndex,visibleColumnStopIndex]),resetIsScrollingTimeoutID=react_1.useRef(null),resetIsScrollingDebounced=react_1.useCallback(()=>{null!==resetIsScrollingTimeoutID.current&&helpers_1.cancelTimeout(resetIsScrollingTimeoutID.current),resetIsScrollingTimeoutID.current=helpers_1.requestTimeout(resetIsScrolling,exports.RESET_SCROLL_EVENTS_DEBOUNCE_INTERVAL)},[]),resetIsScrolling=react_1.useCallback(()=>{resetIsScrollingTimeoutID.current=null,setScrollState(prev=>({...prev,isScrolling:!1}))},[]),handleScroll=react_1.useCallback(e=>{const{scrollTop:scrollTop}=e.target;setScrollState(prev=>({...prev,isScrolling:!0,verticalScrollDirection:prev.scrollTop>scrollTop?types_1.Direction.Up:types_1.Direction.Down,scrollTop:scrollTop})),null==onImmediateScroll||onImmediateScroll({scrollTop:scrollTop,scrollLeft:scrollLeft}),resetIsScrollingDebounced()},[scrollLeft]),handleScrollLeft=react_1.useCallback(e=>{const{scrollLeft:scrollLeft}=e.target;setScrollState(prev=>({...prev,isScrolling:!0,horizontalScrollDirection:prev.scrollLeft>scrollLeft?types_1.Direction.Left:types_1.Direction.Right,scrollLeft:scrollLeft})),null==onImmediateScroll||onImmediateScroll({scrollLeft:scrollLeft,scrollTop:scrollTop}),resetIsScrollingDebounced()},[scrollTop]),scrollTo=react_1.useCallback(({scrollTop:scrollTop,scrollLeft:scrollLeft})=>{showScrollbar?(horizontalScrollRef.current&&void 0!==scrollLeft&&(horizontalScrollRef.current.scrollLeft=scrollLeft),verticalScrollRef.current&&void 0!==scrollTop&&(verticalScrollRef.current.scrollTop=scrollTop)):setScrollState(prev=>({...prev,scrollLeft:null==scrollLeft?prev.scrollLeft:scrollLeft,scrollTop:null==scrollTop?prev.scrollTop:scrollTop}))},[showScrollbar]),scrollToTop=react_1.useCallback(()=>{scrollTo({scrollTop:0,scrollLeft:0})},[]),scrollBy=react_1.useCallback(({x:x,y:y})=>{showScrollbar?(horizontalScrollRef.current&&void 0!==x&&(horizontalScrollRef.current.scrollLeft+=x),verticalScrollRef.current&&void 0!==y&&(verticalScrollRef.current.scrollTop+=y)):setScrollState(prev=>({...prev,scrollLeft:null==x?prev.scrollLeft:prev.scrollLeft+x,scrollTop:null==y?prev.scrollTop:prev.scrollTop+y}))},[]),scrollToItem=react_1.useCallback(({rowIndex:rowIndex,columnIndex:columnIndex},align=helpers_1.Align.smart)=>{const isFrozenRow=rowIndex&&rowIndex<frozenRows,isFrozenColumn=columnIndex&&columnIndex<frozenColumns,frozenColumnOffset=helpers_1.getColumnOffset({index:frozenColumns,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),width=(columnIndex&&helpers_1.getColumnOffset({index:columnIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),rowIndex&&helpers_1.getRowOffset({index:rowIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),columnIndex?helpers_1.getColumnWidth(columnIndex,instanceProps.current):0),height=rowIndex?helpers_1.getRowHeight(rowIndex,instanceProps.current):0,columnAlign=width>containerWidth?helpers_1.Align.start:align,rowAlign=height>containerHeight?helpers_1.Align.start:align,newScrollLeft=void 0===columnIndex||isFrozenColumn?void 0:helpers_1.getOffsetForColumnAndAlignment({index:columnIndex,containerHeight:containerHeight,containerWidth:containerWidth,columnCount:columnCount,columnWidth:columnWidth,rowCount:rowCount,rowHeight:rowHeight,scrollOffset:scrollLeft,instanceProps:instanceProps.current,scrollbarSize:scrollbarSize,frozenOffset:frozenColumnOffset,align:columnAlign,scale:scale}),frozenRowOffset=helpers_1.getRowOffset({index:frozenRows,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),coords={scrollLeft:newScrollLeft,scrollTop:void 0===rowIndex||isFrozenRow?void 0:helpers_1.getOffsetForRowAndAlignment({index:rowIndex,containerHeight:containerHeight,containerWidth:containerWidth,columnCount:columnCount,columnWidth:columnWidth,rowCount:rowCount,rowHeight:rowHeight,scrollOffset:scrollTop,instanceProps:instanceProps.current,scrollbarSize:scrollbarSize,frozenOffset:frozenRowOffset,align:rowAlign,scale:scale})};void 0!==rowIndex&&rowIndex>rowStopIndex+(rowStopIndex-rowStartIndex)||void 0!==columnIndex&&columnIndex>columnStopIndex+(columnStopIndex-columnStartIndex)?window.requestAnimationFrame(()=>{scrollTo(coords)}):scrollTo(coords)},[containerHeight,containerWidth,rowCount,columnCount,scrollbarSize,scrollLeft,scrollTop,frozenRows,frozenColumns]),handleWheel=react_1.useCallback(event=>{var _a,_b;event.preventDefault();const{deltaX:deltaX,deltaY:deltaY,deltaMode:deltaMode}=event;if(snap)return snapToRowThrottler.current({deltaY:deltaY}),void snapToColumnThrottler.current({deltaX:deltaX});if(wheelingRef.current)return;let dx=deltaX,dy=deltaY;const isHorizontal=Math.abs(dx)>Math.abs(dy);if(1===deltaMode&&(dy*=scrollbarSize),!horizontalScrollRef.current||!verticalScrollRef.current)return;const currentScroll=isHorizontal?null===(_a=horizontalScrollRef.current)||void 0===_a?void 0:_a.scrollLeft:null===(_b=verticalScrollRef.current)||void 0===_b?void 0:_b.scrollTop;wheelingRef.current=window.requestAnimationFrame(()=>{wheelingRef.current=null,isHorizontal?horizontalScrollRef.current&&(horizontalScrollRef.current.scrollLeft=currentScroll+dx):verticalScrollRef.current&&(verticalScrollRef.current.scrollTop=currentScroll+dy)})},[]);react_1.useEffect(()=>{null==onViewChange||onViewChange({rowStartIndex:rowStartIndex,rowStopIndex:rowStopIndex,columnStartIndex:columnStartIndex,columnStopIndex:columnStopIndex,visibleRowStartIndex:visibleRowStartIndex,visibleRowStopIndex:visibleRowStopIndex,visibleColumnStartIndex:visibleColumnStartIndex,visibleColumnStopIndex:visibleColumnStopIndex})},[rowStartIndex,rowStopIndex,columnStartIndex,columnStopIndex,visibleRowStartIndex,visibleRowStopIndex,visibleColumnStartIndex,visibleColumnStopIndex]);const gridLines=[],gridLinesFrozenRow=[],gridLinesFrozenColumn=[],gridLinesFrozenIntersection=[];if(showGridLines){for(let rowIndex=rowStartIndex;rowIndex<=rowStopIndex;rowIndex++){if(rowIndex<frozenRows||(null==isHiddenRow?void 0:isHiddenRow(rowIndex)))continue;const x1=helpers_1.getColumnOffset({index:frozenColumns,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),x2=helpers_1.getColumnOffset({index:Math.min(columnStopIndex+1,columnCount),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),y1=helpers_1.getRowOffset({index:Math.min(rowIndex+1,rowCount),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),y2=y1;gridLines.push(gridLineRenderer({points:[x1,y1,x2,y2],stroke:gridLineColor,strokeWidth:gridLineWidth,offsetY:-.5,key:helpers_1.itemKey({rowIndex:rowIndex,columnIndex:y1})})),gridLinesFrozenColumn.push(gridLineRenderer({points:[0,y1,x2,y2],stroke:gridLineColor,strokeWidth:gridLineWidth,offsetY:-.5,key:helpers_1.itemKey({rowIndex:rowIndex,columnIndex:y1})}))}for(let columnIndex=columnStartIndex;columnIndex<=columnStopIndex;columnIndex++){const x1=helpers_1.getColumnOffset({index:Math.min(columnIndex+1,columnCount),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),x2=x1,y1=helpers_1.getRowOffset({index:frozenRows,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),y2=helpers_1.getRowOffset({index:Math.min(rowStopIndex+1,rowCount),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});gridLines.push(gridLineRenderer({points:[x1,y1,x2,y2],stroke:gridLineColor,strokeWidth:gridLineWidth,offsetX:-.5,key:helpers_1.itemKey({rowIndex:x1,columnIndex:columnIndex})})),gridLinesFrozenRow.push(gridLineRenderer({points:[x1,0,x2,y2],stroke:gridLineColor,strokeWidth:gridLineWidth,offsetX:-.5,key:helpers_1.itemKey({rowIndex:x1,columnIndex:columnIndex})}))}for(let rowIndex=0;rowIndex<Math.min(columnStopIndex,frozenRows);rowIndex++){if(null==isHiddenRow?void 0:isHiddenRow(rowIndex))continue;const x1=0,x2=helpers_1.getColumnOffset({index:Math.min(columnStopIndex+1,columnCount),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),y1=helpers_1.getRowOffset({index:Math.min(rowIndex+1,rowCount),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),y2=y1;gridLinesFrozenRow.push(gridLineRenderer({points:[x1,y1,x2,y2],stroke:gridLineColor,strokeWidth:gridLineWidth,offsetY:-.5,key:helpers_1.itemKey({rowIndex:rowIndex,columnIndex:y1})})),gridLinesFrozenIntersection.push(gridLineRenderer({points:[x1,y1,x2,y2],stroke:gridLineColor,strokeWidth:gridLineWidth,offsetY:-.5,key:helpers_1.itemKey({rowIndex:rowIndex,columnIndex:y1})}))}for(let columnIndex=0;columnIndex<Math.min(columnStopIndex,frozenColumns);columnIndex++){const x1=helpers_1.getColumnOffset({index:Math.min(columnIndex+1,columnCount),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),x2=x1,y1=0,y2=helpers_1.getRowOffset({index:Math.min(rowStopIndex+1,rowCount),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});gridLinesFrozenColumn.push(gridLineRenderer({points:[x1,y1,x2,y2],stroke:gridLineColor,strokeWidth:gridLineWidth,offsetX:-.5,key:helpers_1.itemKey({rowIndex:x1,columnIndex:columnIndex})})),gridLinesFrozenIntersection.push(gridLineRenderer({points:[x1,y1,x2,y2],stroke:gridLineColor,strokeWidth:gridLineWidth,offsetX:-.5,key:helpers_1.itemKey({rowIndex:x1,columnIndex:columnIndex})}))}}const mergedCellRenderMap=new Set,cells=[],cellOverlays=[];if(columnCount>0&&rowCount)for(let rowIndex=rowStartIndex;rowIndex<=rowStopIndex;rowIndex++)if(!(rowIndex<frozenRows||(null==isHiddenRow?void 0:isHiddenRow(rowIndex)))){null==onBeforeRenderRow||onBeforeRenderRow(rowIndex);for(let columnIndex=columnStartIndex;columnIndex<=columnStopIndex;columnIndex++){if(columnIndex<frozenColumns)continue;const isMerged=isMergedCell({rowIndex:rowIndex,columnIndex:columnIndex}),bounds=getCellBounds({rowIndex:rowIndex,columnIndex:columnIndex}),actualRowIndex=isMerged?bounds.top:rowIndex,actualColumnIndex=isMerged?bounds.left:columnIndex,actualBottom=Math.max(rowIndex,bounds.bottom),actualRight=Math.max(columnIndex,bounds.right);if(!isMerged&&(null==isHiddenCell?void 0:isHiddenCell(actualRowIndex,actualColumnIndex)))continue;if(isMerged){const cellId=helpers_1.cellIdentifier(bounds.top,bounds.left);if(mergedCellRenderMap.has(cellId))continue;mergedCellRenderMap.add(cellId)}const y=helpers_1.getRowOffset({index:actualRowIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),height=helpers_1.getRowOffset({index:actualBottom,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-y+helpers_1.getRowHeight(actualBottom,instanceProps.current),x=helpers_1.getColumnOffset({index:actualColumnIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),width=helpers_1.getColumnOffset({index:actualRight,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-x+helpers_1.getColumnWidth(actualRight,instanceProps.current);cells.push(itemRenderer({x:x,y:y,width:width,height:height,rowIndex:actualRowIndex,columnIndex:actualColumnIndex,isMergedCell:isMerged,key:helpers_1.itemKey({rowIndex:actualRowIndex,columnIndex:actualColumnIndex})})),enableCellOverlay&&cellOverlays.push(overlayRenderer({x:x,y:y,width:width,height:height,rowIndex:actualRowIndex,columnIndex:actualColumnIndex,isMergedCell:isMerged,key:helpers_1.itemKey({rowIndex:actualRowIndex,columnIndex:actualColumnIndex})}))}}const ranges=[];for(const{rowIndex:rowIndex,columnIndex:columnIndex,toColumnIndex:toColumnIndex}of cellAreas){if(rowIndex<frozenRows||columnIndex<frozenColumns||isMergedCell({rowIndex:rowIndex,columnIndex:columnIndex})||(null==isHiddenCell?void 0:isHiddenCell(rowIndex,columnIndex)))continue;const x=helpers_1.getColumnOffset({index:columnIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),y=helpers_1.getRowOffset({index:rowIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),height=helpers_1.getRowHeight(rowIndex,instanceProps.current),{x:offsetX=0}=getCellOffsetFromCoords({rowIndex:rowIndex,columnIndex:toColumnIndex+1});ranges.push(itemRenderer({x:x,y:y,width:offsetX-x,height:height,rowIndex:rowIndex,columnIndex:columnIndex,key:"range:"+helpers_1.itemKey({rowIndex:rowIndex,columnIndex:columnIndex})}))}const frozenRowCells=[],frozenRowCellOverlays=[];for(let rowIndex=0;rowIndex<Math.min(rowStopIndex,frozenRows);rowIndex++)if(!(null==isHiddenRow?void 0:isHiddenRow(rowIndex))){null==onBeforeRenderRow||onBeforeRenderRow(rowIndex);for(let columnIndex=columnStartIndex;columnIndex<=columnStopIndex;columnIndex++){if(columnIndex<frozenColumns)continue;const isMerged=isMergedCell({rowIndex:rowIndex,columnIndex:columnIndex}),bounds=getCellBounds({rowIndex:rowIndex,columnIndex:columnIndex}),actualRowIndex=isMerged?bounds.top:rowIndex,actualColumnIndex=isMerged?bounds.left:columnIndex,actualBottom=Math.max(rowIndex,bounds.bottom),actualRight=Math.max(columnIndex,bounds.right);if(!isMerged&&(null==isHiddenCell?void 0:isHiddenCell(actualRowIndex,actualColumnIndex)))continue;if(isMerged){const cellId=helpers_1.cellIdentifier(bounds.top,bounds.left);if(mergedCellRenderMap.has(cellId))continue;mergedCellRenderMap.add(cellId)}const y=helpers_1.getRowOffset({index:actualRowIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),height=helpers_1.getRowOffset({index:actualBottom,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-y+helpers_1.getRowHeight(actualBottom,instanceProps.current),x=helpers_1.getColumnOffset({index:actualColumnIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),width=helpers_1.getColumnOffset({index:actualRight,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-x+helpers_1.getColumnWidth(actualRight,instanceProps.current);frozenRowCells.push(itemRenderer({x:x,y:y,width:width,height:height,rowIndex:actualRowIndex,columnIndex:actualColumnIndex,isMergedCell:isMerged,key:helpers_1.itemKey({rowIndex:actualRowIndex,columnIndex:actualColumnIndex})})),enableCellOverlay&&frozenRowCellOverlays.push(overlayRenderer({x:x,y:y,width:width,height:height,rowIndex:actualRowIndex,columnIndex:actualColumnIndex,isMergedCell:isMerged,key:helpers_1.itemKey({rowIndex:actualRowIndex,columnIndex:actualColumnIndex})}))}}const frozenColumnCells=[],frozenColumnCellOverlays=[];for(let rowIndex=rowStartIndex;rowIndex<=rowStopIndex;rowIndex++)if(!(rowIndex<frozenRows||(null==isHiddenRow?void 0:isHiddenRow(rowIndex)))){null==onBeforeRenderRow||onBeforeRenderRow(rowIndex);for(let columnIndex=0;columnIndex<Math.min(columnStopIndex,frozenColumns);columnIndex++){const isMerged=isMergedCell({rowIndex:rowIndex,columnIndex:columnIndex}),bounds=getCellBounds({rowIndex:rowIndex,columnIndex:columnIndex}),actualRowIndex=isMerged?bounds.top:rowIndex,actualColumnIndex=isMerged?bounds.left:columnIndex,actualBottom=Math.max(rowIndex,bounds.bottom),actualRight=Math.max(columnIndex,bounds.right);if(!isMerged&&(null==isHiddenCell?void 0:isHiddenCell(actualRowIndex,actualColumnIndex)))continue;if(isMerged){const cellId=helpers_1.cellIdentifier(bounds.top,bounds.left);if(mergedCellRenderMap.has(cellId))continue;mergedCellRenderMap.add(cellId)}const y=helpers_1.getRowOffset({index:actualRowIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),height=helpers_1.getRowOffset({index:actualBottom,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-y+helpers_1.getRowHeight(actualBottom,instanceProps.current),x=helpers_1.getColumnOffset({index:actualColumnIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),width=helpers_1.getColumnOffset({index:actualRight,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-x+helpers_1.getColumnWidth(actualRight,instanceProps.current);frozenColumnCells.push(itemRenderer({x:x,y:y,width:width,height:height,rowIndex:actualRowIndex,columnIndex:actualColumnIndex,isMergedCell:isMerged,key:helpers_1.itemKey({rowIndex:actualRowIndex,columnIndex:actualColumnIndex})})),enableCellOverlay&&frozenColumnCellOverlays.push(overlayRenderer({x:x,y:y,width:width,height:height,rowIndex:actualRowIndex,columnIndex:actualColumnIndex,isMergedCell:isMerged,key:helpers_1.itemKey({rowIndex:actualRowIndex,columnIndex:actualColumnIndex})}))}}const frozenColumnShadow=react_1.useMemo(()=>{const frozenColumnLineX=helpers_1.getColumnOffset({index:frozenColumns,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),frozenColumnLineY=helpers_1.getRowOffset({index:Math.min(rowStopIndex+1,rowCount),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});return react_1.default.createElement(ReactKonvaCore_1.Line,Object.assign({points:[frozenColumnLineX,0,frozenColumnLineX,frozenColumnLineY],offsetX:-.5,strokeWidth:1,shadowForStrokeEnabled:!1,strokeScaleEnabled:!1,hitStrokeWidth:0,listening:!1,perfectDrawEnabled:!1},shadowSettings))},[shadowSettings,frozenColumns,rowStopIndex,rowCount,instanceProps.current.lastMeasuredColumnIndex,instanceProps.current.recalcColumnIndices]),frozenRowShadow=react_1.useMemo(()=>{const frozenRowLineY=helpers_1.getRowOffset({index:frozenRows,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),frozenRowLineX=helpers_1.getColumnOffset({index:Math.min(columnStopIndex+1,columnCount),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});return react_1.default.createElement(ReactKonvaCore_1.Line,Object.assign({points:[0,frozenRowLineY,frozenRowLineX,frozenRowLineY],offsetY:-.5,strokeWidth:1,shadowForStrokeEnabled:!1,strokeScaleEnabled:!1,hitStrokeWidth:0,listening:!1,perfectDrawEnabled:!1},shadowSettings))},[shadowSettings,frozenRows,columnStopIndex,columnCount,instanceProps.current.lastMeasuredRowIndex,instanceProps.current.recalcRowIndices]),frozenIntersectionCells=[],frozenIntersectionCellOverlays=[];for(let rowIndex=0;rowIndex<Math.min(rowStopIndex,frozenRows);rowIndex++)if(!(null==isHiddenRow?void 0:isHiddenRow(rowIndex)))for(let columnIndex=0;columnIndex<Math.min(columnStopIndex,frozenColumns);columnIndex++){const isMerged=isMergedCell({rowIndex:rowIndex,columnIndex:columnIndex}),bounds=getCellBounds({rowIndex:rowIndex,columnIndex:columnIndex}),actualRowIndex=isMerged?bounds.top:rowIndex,actualColumnIndex=isMerged?bounds.left:columnIndex,actualBottom=Math.max(rowIndex,bounds.bottom),actualRight=Math.max(columnIndex,bounds.right);if(!isMerged&&(null==isHiddenCell?void 0:isHiddenCell(actualRowIndex,actualColumnIndex)))continue;if(isMerged){const cellId=helpers_1.cellIdentifier(bounds.top,bounds.left);if(mergedCellRenderMap.has(cellId))continue;mergedCellRenderMap.add(cellId)}const y=helpers_1.getRowOffset({index:actualRowIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),height=helpers_1.getRowOffset({index:actualBottom,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-y+helpers_1.getRowHeight(actualBottom,instanceProps.current),x=helpers_1.getColumnOffset({index:actualColumnIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),width=helpers_1.getColumnOffset({index:actualRight,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-x+helpers_1.getColumnWidth(actualRight,instanceProps.current);frozenIntersectionCells.push(itemRenderer({x:x,y:y,width:width,height:height,rowIndex:actualRowIndex,columnIndex:actualColumnIndex,isMergedCell:isMerged,key:helpers_1.itemKey({rowIndex:actualRowIndex,columnIndex:actualColumnIndex})})),enableCellOverlay&&frozenIntersectionCellOverlays.push(overlayRenderer({x:x,y:y,width:width,height:height,rowIndex:actualRowIndex,columnIndex:actualColumnIndex,isMergedCell:isMerged,key:helpers_1.itemKey({rowIndex:actualRowIndex,columnIndex:actualColumnIndex})}))}let fillHandleDimension={},activeCellSelection=null,activeCellSelectionFrozenColumn=null,activeCellSelectionFrozenRow=null,activeCellSelectionFrozenIntersection=null;if(activeCell){const bounds=getCellBounds(activeCell),{top:top,left:left,right:right,bottom:bottom}=bounds,actualBottom=Math.min(rowStopIndex,bottom),actualRight=Math.min(columnStopIndex,right),isInFrozenColumn=left<frozenColumns,isInFrozenRow=top<frozenRows,isInFrozenIntersection=isInFrozenRow&&isInFrozenColumn,y=helpers_1.getRowOffset({index:top,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),height=helpers_1.getRowOffset({index:actualBottom,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-y+helpers_1.getRowHeight(actualBottom,instanceProps.current),x=helpers_1.getColumnOffset({index:left,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),width=helpers_1.getColumnOffset({index:actualRight,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-x+helpers_1.getColumnWidth(actualRight,instanceProps.current),cell=selectionRenderer({stroke:selectionBorderColor,strokeWidth:activeCellStrokeWidth,fill:"transparent",x:x,y:y,width:width,height:height});isInFrozenIntersection?activeCellSelectionFrozenIntersection=cell:isInFrozenRow?activeCellSelectionFrozenRow=cell:isInFrozenColumn?activeCellSelectionFrozenColumn=cell:activeCellSelection=cell,fillHandleDimension={x:x+width,y:y+height}}let isSelectionInProgress=!1;const selectionAreas=[],selectionAreasFrozenColumns=[],selectionAreasFrozenRows=[],selectionAreasIntersection=[];for(let i=0;i<selections.length;i++){const{bounds:bounds,inProgress:inProgress,style:style}=selections[i],{top:top,left:left,right:right,bottom:bottom}=bounds,selectionBounds={x:0,y:0,width:0,height:0},actualBottom=Math.min(rowStopIndex,bottom),actualRight=Math.min(columnStopIndex,right),isLeftBoundFrozen=left<frozenColumns,isTopBoundFrozen=top<frozenRows,isIntersectionFrozen=top<frozenRows&&left<frozenColumns,isLast=i===selections.length-1,styles={stroke:inProgress?selectionBackgroundColor:selectionBorderColor,fill:selectionBackgroundColor,...style};if(inProgress&&(isSelectionInProgress=!0),selectionBounds.y=helpers_1.getRowOffset({index:top,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),selectionBounds.height=helpers_1.getRowOffset({index:actualBottom,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-selectionBounds.y+helpers_1.getRowHeight(actualBottom,instanceProps.current),selectionBounds.x=helpers_1.getColumnOffset({index:left,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),selectionBounds.width=helpers_1.getColumnOffset({index:actualRight,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-selectionBounds.x+helpers_1.getColumnWidth(actualRight,instanceProps.current),isLeftBoundFrozen){const frozenColumnSelectionWidth=helpers_1.getColumnOffset({index:Math.min(right+1,frozenColumns),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-helpers_1.getColumnOffset({index:left,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});selectionAreasFrozenColumns.push(selectionRenderer({...styles,key:i,x:selectionBounds.x,y:selectionBounds.y,width:frozenColumnSelectionWidth,height:selectionBounds.height,strokeRightWidth:frozenColumnSelectionWidth===selectionBounds.width?selectionStrokeWidth:0}))}if(isTopBoundFrozen){const frozenRowSelectionHeight=helpers_1.getRowOffset({index:Math.min(bottom+1,frozenRows),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-helpers_1.getRowOffset({index:top,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});selectionAreasFrozenRows.push(selectionRenderer({...styles,key:i,x:selectionBounds.x,y:selectionBounds.y,width:selectionBounds.width,height:frozenRowSelectionHeight,strokeBottomWidth:frozenRowSelectionHeight===selectionBounds.height?selectionStrokeWidth:0}))}if(isIntersectionFrozen){const frozenIntersectionSelectionHeight=helpers_1.getRowOffset({index:Math.min(bottom+1,frozenRows),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-helpers_1.getRowOffset({index:top,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),frozenIntersectionSelectionWidth=helpers_1.getColumnOffset({index:Math.min(right+1,frozenColumns),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-helpers_1.getColumnOffset({index:left,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});selectionAreasIntersection.push(selectionRenderer({...styles,key:i,x:selectionBounds.x,y:selectionBounds.y,width:frozenIntersectionSelectionWidth,height:frozenIntersectionSelectionHeight,strokeBottomWidth:frozenIntersectionSelectionHeight===selectionBounds.height?selectionStrokeWidth:0,strokeRightWidth:frozenIntersectionSelectionWidth===selectionBounds.width?selectionStrokeWidth:0}))}selectionAreas.push(selectionRenderer({...styles,key:i,x:selectionBounds.x,y:selectionBounds.y,width:selectionBounds.width,height:selectionBounds.height})),isLast&&(fillHandleDimension={x:selectionBounds.x+selectionBounds.width,y:selectionBounds.y+selectionBounds.height})}let fillSelections=null;if(fillSelection){const{bounds:bounds}=fillSelection,{top:top,left:left,right:right,bottom:bottom}=bounds,actualBottom=Math.min(rowStopIndex,bottom),actualRight=Math.min(columnStopIndex,right),x=helpers_1.getColumnOffset({index:left,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),y=helpers_1.getRowOffset({index:top,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),height=helpers_1.getRowOffset({index:actualBottom,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-y+helpers_1.getRowHeight(actualBottom,instanceProps.current);fillSelections=selectionRenderer({x:x,y:y,width:helpers_1.getColumnOffset({index:actualRight,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-x+helpers_1.getColumnWidth(actualRight,instanceProps.current),height:height,stroke:"gray",strokeStyle:"dashed"})}const borderStyleCells=[],borderStyleCellsFrozenColumns=[],borderStyleCellsFrozenRows=[],borderStyleCellsIntersection=[];for(let i=0;i<borderStyles.length;i++){const{bounds:bounds,style:style}=borderStyles[i],{top:top,right:right,bottom:bottom,left:left}=bounds,isLeftBoundFrozen=left<frozenColumns,isTopBoundFrozen=top<frozenRows,isIntersectionFrozen=top<frozenRows&&left<frozenColumns,x=helpers_1.getColumnOffset({index:left,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),y=helpers_1.getRowOffset({index:top,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),width=helpers_1.getColumnOffset({index:Math.min(columnCount-1,right+1),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-x,height=helpers_1.getRowOffset({index:Math.min(rowCount-1,bottom+1),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-y;if(borderStyleCells.push(utils_1.createHTMLBox({x:x,y:y,key:i,width:width,height:height,...style})),isLeftBoundFrozen){const frozenColumnSelectionWidth=helpers_1.getColumnOffset({index:Math.min(right+1,frozenColumns),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-helpers_1.getColumnOffset({index:left,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});borderStyleCellsFrozenColumns.push(utils_1.createHTMLBox({...style,x:x,y:y,key:i,width:frozenColumnSelectionWidth,height:height,strokeRightWidth:frozenColumnSelectionWidth===width?(null==style?void 0:style.strokeRightWidth)||(null==style?void 0:style.strokeWidth):0}))}if(isTopBoundFrozen){const frozenRowSelectionHeight=helpers_1.getRowOffset({index:Math.min(bottom+1,frozenRows),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-helpers_1.getRowOffset({index:top,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});borderStyleCellsFrozenRows.push(utils_1.createHTMLBox({...style,x:x,y:y,key:i,width:width,height:frozenRowSelectionHeight,strokeBottomWidth:frozenRowSelectionHeight===height?(null==style?void 0:style.strokeBottomWidth)||(null==style?void 0:style.strokeWidth):0}))}if(isIntersectionFrozen){const frozenIntersectionSelectionHeight=helpers_1.getRowOffset({index:Math.min(bottom+1,frozenRows),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-helpers_1.getRowOffset({index:top,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),frozenIntersectionSelectionWidth=helpers_1.getColumnOffset({index:Math.min(right+1,frozenColumns),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-helpers_1.getColumnOffset({index:left,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});borderStyleCellsIntersection.push(utils_1.createHTMLBox({...style,x:x,y:y,key:i,width:frozenIntersectionSelectionWidth,height:frozenIntersectionSelectionHeight,strokeBottomWidth:frozenIntersectionSelectionHeight===height?selectionStrokeWidth:0,strokeRightWidth:frozenIntersectionSelectionWidth===width?selectionStrokeWidth:0}))}}const listenToEvents=!isScrolling,frozenRowShadowComponent=showFrozenShadow&&0!==frozenRows?frozenRowShadow:null,frozenColumnShadowComponent=showFrozenShadow&&0!==frozenColumns?frozenColumnShadow:null,stageChildren=react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(ReactKonvaCore_1.Layer,null,react_1.default.createElement(ReactKonvaCore_1.Group,{clipX:frozenColumnWidth,clipY:frozenRowHeight,clipWidth:containerWidth-frozenColumnWidth,clipHeight:containerHeight-frozenRowHeight},react_1.default.createElement(ReactKonvaCore_1.Group,{offsetY:scrollTop,offsetX:scrollLeft},gridLines,cells,cellOverlays,ranges)),react_1.default.createElement(ReactKonvaCore_1.Group,{clipX:frozenColumnWidth,clipY:0,clipWidth:containerWidth-frozenColumnWidth,clipHeight:frozenRowHeight+1},react_1.default.createElement(ReactKonvaCore_1.Group,{offsetY:0,offsetX:scrollLeft},gridLinesFrozenRow,frozenRowCells,frozenRowShadowComponent,frozenRowCellOverlays)),react_1.default.createElement(ReactKonvaCore_1.Group,{clipX:0,clipY:frozenRowHeight,clipWidth:frozenColumnWidth+1,clipHeight:containerHeight-frozenRowHeight},react_1.default.createElement(ReactKonvaCore_1.Group,{offsetY:scrollTop,offsetX:0},gridLinesFrozenColumn,frozenColumnCells,frozenColumnShadowComponent,frozenColumnCellOverlays)),react_1.default.createElement(ReactKonvaCore_1.Group,{offsetY:0,offsetX:0,clipX:0,clipY:0,clipWidth:frozenColumnWidth+1,clipHeight:frozenRowHeight+1},gridLinesFrozenIntersection,frozenIntersectionCells,frozenRowShadowComponent,frozenColumnShadowComponent,frozenIntersectionCellOverlays)),children&&"function"==typeof children?children({scrollLeft:scrollLeft,scrollTop:scrollTop}):null),fillhandleComponent=showFillHandle&&!isSelectionInProgress?react_1.default.createElement(FillHandle_1.default,Object.assign({},fillHandleDimension,{stroke:selectionBorderColor,size:8,borderColor:fillhandleBorderColor},fillHandleProps)):null,selectionChildren=react_1.default.createElement("div",{style:{pointerEvents:"none"}},react_1.default.createElement("div",{style:{position:"absolute",left:frozenColumnWidth,top:frozenRowHeight,right:0,bottom:0,overflow:"hidden"}},react_1.default.createElement("div",{style:{transform:`translate(-${scrollLeft+frozenColumnWidth}px, -${scrollTop+frozenRowHeight}px)`}},borderStyleCells,fillSelections,selectionAreas,activeCellSelection,fillhandleComponent)),frozenColumns?react_1.default.createElement("div",{style:{position:"absolute",width:frozenColumnWidth+8,top:frozenRowHeight,left:0,bottom:0,overflow:"hidden"}},react_1.default.createElement("div",{style:{transform:`translate(0, -${scrollTop+frozenRowHeight}px)`}},borderStyleCellsFrozenColumns,selectionAreasFrozenColumns,activeCellSelectionFrozenColumn,fillhandleComponent)):null,frozenRows?react_1.default.createElement("div",{style:{position:"absolute",height:frozenRowHeight+8,left:frozenColumnWidth,right:0,top:0,overflow:"hidden"}},react_1.default.createElement("div",{style:{transform:`translate(-${scrollLeft+frozenColumnWidth}px, 0)`}},borderStyleCellsFrozenRows,selectionAreasFrozenRows,activeCellSelectionFrozenRow,fillhandleComponent)):null,frozenRows&&frozenColumns?react_1.default.createElement("div",{style:{position:"absolute",height:frozenRowHeight+8,width:frozenColumnWidth+8,left:0,top:0,overflow:"hidden",pointerEvents:"none"}},borderStyleCellsIntersection,selectionAreasIntersection,activeCellSelectionFrozenIntersection,fillhandleComponent):null);return react_1.default.createElement("div",{style:{position:"relative",width:containerWidth,userSelect:"none"},className:"rowsncolumns-grid"},react_1.default.createElement("div",Object.assign({className:"rowsncolumns-grid-container",tabIndex:0,ref:containerRef},rest),react_1.default.createElement(ReactKonvaCore_1.Stage,Object.assign({width:containerWidth,height:containerHeight,ref:stageRef,listening:listenToEvents},stageProps),wrapper(stageChildren))),selectionChildren,showScrollbar?react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement("div",{className:"rowsncolumns-grid-scrollbar rowsncolumns-grid-scrollbar-y",tabIndex:-1,style:{height:containerHeight,overflow:"scroll",position:"absolute",right:0,top:0,width:scrollbarSize,willChange:"transform"},onScroll:handleScroll,ref:verticalScrollRef},react_1.default.createElement("div",{style:{position:"absolute",height:estimatedTotalHeight,width:1}})),react_1.default.createElement("div",{className:"rowsncolumns-grid-scrollbar rowsncolumns-grid-scrollbar-x",tabIndex:-1,style:{overflow:"scroll",position:"absolute",bottom:0,left:0,width:containerWidth,height:scrollbarSize,willChange:"transform"},onScroll:handleScrollLeft,ref:horizontalScrollRef},react_1.default.createElement("div",{style:{position:"absolute",width:estimatedTotalWidth,height:1}}))):null)}));exports.default=Grid},378:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Cell=exports.CellRenderer=void 0;const react_1=__importStar(__webpack_require__(1)),react_konva_1=__webpack_require__(10),helpers_1=__webpack_require__(61),Cell=react_1.memo(props=>{const{x:x,y:y,width:width,height:height,value:value,fill:fill="white",strokeWidth:strokeWidth=1,stroke:stroke="#d9d9d9",align:align="left",verticalAlign:verticalAlign="middle",textColor:textColor="#333",padding:padding=5,fontFamily:fontFamily="Arial",fontSize:fontSize=12,children:children,wrap:wrap="none",fontWeight:fontWeight="normal",fontStyle:fontStyle="normal",textDecoration:textDecoration,alpha:alpha=1,strokeEnabled:strokeEnabled=!0,globalCompositeOperation:globalCompositeOperation="multiply",isOverlay:isOverlay,...rest}=props;if(isOverlay)return null;const fillEnabled=!!fill,textStyle=`${fontWeight} ${fontStyle}`;return react_1.default.createElement(react_konva_1.Group,Object.assign({},rest),react_1.default.createElement(react_konva_1.Rect,{x:x,y:y,height:height,width:width,fill:fill,stroke:stroke,strokeWidth:strokeWidth,shadowForStrokeEnabled:!1,strokeScaleEnabled:!1,hitStrokeWidth:0,alpha:alpha,fillEnabled:fillEnabled,strokeEnabled:strokeEnabled}),helpers_1.isNull(value)?null:react_1.default.createElement(react_konva_1.Text,{x:x,y:y,height:height,width:width,text:value,fill:textColor,verticalAlign:verticalAlign,align:align,fontFamily:fontFamily,fontStyle:textStyle,textDecoration:textDecoration,padding:padding,wrap:wrap,fontSize:fontSize,hitStrokeWidth:0}),children)});exports.Cell=Cell;const CellRenderer=props=>react_1.default.createElement(Cell,Object.assign({},props));exports.CellRenderer=CellRenderer,exports.default=CellRenderer},383:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.CellOverlay=exports.CellRenderer=void 0;const react_1=__importStar(__webpack_require__(1)),react_konva_1=__webpack_require__(10),EMPTY_ARRAY=[],CellOverlay=react_1.memo(props=>{const{x:x,y:y,width:width,height:height,strokeTopColor:strokeTopColor,strokeRightColor:strokeRightColor,strokeBottomColor:strokeBottomColor,strokeLeftColor:strokeLeftColor,strokeTopDash:strokeTopDash=EMPTY_ARRAY,strokeRightDash:strokeRightDash=EMPTY_ARRAY,strokeBottomDash:strokeBottomDash=EMPTY_ARRAY,strokeLeftDash:strokeLeftDash=EMPTY_ARRAY,strokeTopWidth:strokeTopWidth,strokeRightWidth:strokeRightWidth,strokeBottomWidth:strokeBottomWidth,strokeLeftWidth:strokeLeftWidth,lineCap:lineCap}=props;return strokeTopColor||strokeRightColor||strokeBottomColor||strokeLeftColor?react_1.default.createElement(react_konva_1.Shape,{x:x,y:y,width:width,height:height,sceneFunc:(context,shape)=>{strokeTopColor&&(context.beginPath(),context.moveTo(.5,.5),context.lineTo(shape.width(),.5),context.setAttr("strokeStyle",strokeTopColor),context.setAttr("lineWidth",strokeTopWidth),context.setAttr("lineCap",lineCap),context.setLineDash(strokeTopDash),context.stroke()),strokeBottomColor&&(context.beginPath(),context.moveTo(.5,shape.height()+.5),context.lineTo(shape.width()+.5,shape.height()+.5),context.setAttr("lineWidth",strokeBottomWidth),context.setAttr("strokeStyle",strokeBottomColor),context.setAttr("lineCap",lineCap),context.setLineDash(strokeBottomDash),context.stroke()),strokeLeftColor&&(context.beginPath(),context.moveTo(.5,.5),context.lineTo(.5,shape.height()+.5),context.setAttr("strokeStyle",strokeLeftColor),context.setAttr("lineWidth",strokeLeftWidth),context.setAttr("lineCap",lineCap),context.setLineDash(strokeLeftDash),context.stroke()),strokeRightColor&&(context.beginPath(),context.moveTo(shape.width()+.5,.5),context.lineTo(shape.width()+.5,shape.height()+.5),context.setAttr("strokeStyle",strokeRightColor),context.setAttr("lineWidth",strokeRightWidth),context.setAttr("lineCap",lineCap),context.setLineDash(strokeRightDash),context.stroke())}}):null});exports.CellOverlay=CellOverlay;const CellRenderer=props=>{const{x:x,y:y,width:width,height:height,stroke:stroke,strokeTopColor:strokeTopColor=stroke,strokeRightColor:strokeRightColor=stroke,strokeBottomColor:strokeBottomColor=stroke,strokeLeftColor:strokeLeftColor=stroke,strokeDash:strokeDash=EMPTY_ARRAY,strokeTopDash:strokeTopDash=EMPTY_ARRAY,strokeRightDash:strokeRightDash=EMPTY_ARRAY,strokeBottomDash:strokeBottomDash=EMPTY_ARRAY,strokeLeftDash:strokeLeftDash=EMPTY_ARRAY,strokeWidth:strokeWidth=1,strokeTopWidth:strokeTopWidth=strokeWidth,strokeRightWidth:strokeRightWidth=strokeWidth,strokeBottomWidth:strokeBottomWidth=strokeWidth,strokeLeftWidth:strokeLeftWidth=strokeWidth,lineCap:lineCap="square",key:key}=props;return strokeTopColor||strokeRightColor||strokeBottomColor||strokeLeftColor?react_1.default.createElement(CellOverlay,{key:key,x:x,y:y,width:width,height:height,strokeTopColor:strokeTopColor,strokeRightColor:strokeRightColor,strokeBottomColor:strokeBottomColor,strokeLeftColor:strokeLeftColor,strokeDash:strokeDash,strokeTopDash:strokeTopDash,strokeRightDash:strokeRightDash,strokeBottomDash:strokeBottomDash,strokeLeftDash:strokeLeftDash,strokeTopWidth:strokeTopWidth,strokeRightWidth:strokeRightWidth,strokeBottomWidth:strokeBottomWidth,strokeLeftWidth:strokeLeftWidth,lineCap:lineCap}):null};exports.CellRenderer=CellRenderer,exports.default=CellRenderer},384:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.createHTMLBox=exports.createCanvasBox=void 0;const react_1=__importDefault(__webpack_require__(1)),react_konva_1=__webpack_require__(10);exports.createCanvasBox=({x:x=0,y:y=0,width:width=0,height:height=0,fill:fill,stroke:stroke,strokeLeftColor:strokeLeftColor=stroke,strokeTopColor:strokeTopColor=stroke,strokeRightColor:strokeRightColor=stroke,strokeBottomColor:strokeBottomColor=stroke,strokeWidth:strokeWidth=0,strokeTopWidth:strokeTopWidth=strokeWidth,strokeRightWidth:strokeRightWidth=strokeWidth,strokeBottomWidth:strokeBottomWidth=strokeWidth,strokeLeftWidth:strokeLeftWidth=strokeWidth,dash:dash,dashEnabled:dashEnabled,lineCap:lineCap="square",key:key})=>{const commonProps={perfectDrawEnabled:!1,shadowForStrokeEnabled:!1,hitStrokeWidth:0,listening:!1},lines=[react_1.default.createElement(react_konva_1.Line,Object.assign({points:[x,y,x+width,y],stroke:strokeTopColor,strokeWidth:strokeTopWidth,dash:dash,dashEnabled:dashEnabled,lineCap:lineCap,key:"top",globalCompositeOperation:void 0},commonProps)),react_1.default.createElement(react_konva_1.Line,Object.assign({points:[x+width,y,x+width,y+height],stroke:strokeRightColor,strokeWidth:strokeRightWidth,dash:dash,dashEnabled:dashEnabled,lineCap:lineCap,key:"right",globalCompositeOperation:void 0},commonProps)),react_1.default.createElement(react_konva_1.Line,Object.assign({points:[x+width,y+height,x,y+height],stroke:strokeBottomColor,strokeWidth:strokeBottomWidth,dash:dash,dashEnabled:dashEnabled,lineCap:lineCap,key:"bottom",globalCompositeOperation:void 0},commonProps)),react_1.default.createElement(react_konva_1.Line,Object.assign({points:[x,y+height,x,y],stroke:strokeLeftColor,strokeWidth:strokeLeftWidth,dash:dash,dashEnabled:dashEnabled,lineCap:lineCap,key:"left",globalCompositeOperation:void 0},commonProps))];return react_1.default.createElement(react_1.default.Fragment,{key:key},fill&&react_1.default.createElement(react_konva_1.Rect,Object.assign({globalCompositeOperation:void 0,fill:fill,x:x,y:y,width:width,height:height},commonProps)),lines)},exports.createHTMLBox=({x:x=0,y:y=0,width:width=0,height:height=0,fill:fill,stroke:stroke,strokeLeftColor:strokeLeftColor=stroke,strokeTopColor:strokeTopColor=stroke,strokeRightColor:strokeRightColor=stroke,strokeBottomColor:strokeBottomColor=stroke,strokeWidth:strokeWidth=0,strokeTopWidth:strokeTopWidth=strokeWidth,strokeRightWidth:strokeRightWidth=strokeWidth,strokeBottomWidth:strokeBottomWidth=strokeWidth,strokeLeftWidth:strokeLeftWidth=strokeWidth,key:key,strokeStyle:strokeStyle="solid"})=>{const commonProps={};width-=Math.floor(strokeWidth/2),height-=Math.floor(strokeWidth/2);const lines=[react_1.default.createElement("div",Object.assign({style:{position:"absolute",left:x,top:y,width:width,height:strokeTopWidth,borderWidth:0,borderColor:strokeTopColor,borderTopWidth:strokeTopWidth,borderStyle:strokeStyle},key:"top"},commonProps)),react_1.default.createElement("div",Object.assign({style:{position:"absolute",left:x+width,top:y,width:strokeRightWidth,height:height,borderWidth:0,borderColor:strokeRightColor,borderRightWidth:strokeRightWidth,borderStyle:strokeStyle},key:"right"},commonProps)),,react_1.default.createElement("div",Object.assign({style:{position:"absolute",left:x,top:y+height,width:width+strokeTopWidth,height:strokeBottomWidth,borderWidth:0,borderColor:strokeBottomColor,borderBottomWidth:strokeBottomWidth,borderStyle:strokeStyle},key:"bottom"},commonProps)),react_1.default.createElement("div",Object.assign({style:{position:"absolute",left:x,top:y,width:strokeLeftWidth,height:height,borderWidth:0,borderColor:strokeLeftColor,borderLeftWidth:strokeLeftWidth,borderStyle:strokeStyle},key:"left"},commonProps))];return react_1.default.createElement(react_1.default.Fragment,{key:key},fill&&react_1.default.createElement("div",Object.assign({style:{position:"absolute",top:y,left:x,height:height,width:width,backgroundColor:fill,userSelect:"none",pointerEvents:"none"}},commonProps)),lines)}},385:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(1)),types_1=__webpack_require__(62),helpers_1=__webpack_require__(61),DefaultEditor=props=>{const{rowIndex:rowIndex,columnIndex:columnIndex,onChange:onChange,onSubmit:onSubmit,onCancel:onCancel,position:position,cell:cell,nextFocusableCell:nextFocusableCell,value:value="",activeCell:activeCell,autoFocus:autoFocus=!0,...rest}=props,textSizer=react_1.useRef(helpers_1.AutoSizerCanvas()),inputRef=react_1.useRef(null),{x:x=0,y:y=0,width:width=0,height:height=0}=position,getWidth=react_1.useCallback(text=>{var _a;const textWidth=(null===(_a=textSizer.current.measureText(text))||void 0===_a?void 0:_a.width)||0;return Math.max(textWidth+10,width+1)},[width]);react_1.useEffect(()=>{setInputWidth(getWidth(value))},[value]);const[inputWidth,setInputWidth]=react_1.useState(()=>getWidth(value));react_1.useEffect(()=>{inputRef.current&&(autoFocus&&inputRef.current.focus(),inputRef.current.selectionStart=value.length)},[]);const inputHeight=height;return react_1.default.createElement("div",{style:{top:y-1,left:x,position:"absolute",width:inputWidth,height:inputHeight+2,padding:2,boxShadow:"0 2px 6px 2px rgba(60,64,67,.15)",border:"2px #1a73e8 solid",background:"white"}},react_1.default.createElement("textarea",Object.assign({rows:1,cols:1,ref:inputRef,value:value,style:{font:"12px Arial",lineHeight:1.2,width:"100%",height:"100%",padding:"0 1px",margin:0,boxSizing:"border-box",borderWidth:0,outline:"none",resize:"none",overflow:"hidden",verticalAlign:"top",background:"transparent"},onChange:e=>{onChange(e.target.value,cell)},onKeyDown:e=>{if(!inputRef.current)return;const isShiftKey=e.nativeEvent.shiftKey,value=inputRef.current.value;e.which===types_1.KeyCodes.Enter&&onSubmit&&onSubmit(value,cell,nextFocusableCell(cell,isShiftKey?types_1.Direction.Up:types_1.Direction.Down)),e.which===types_1.KeyCodes.Escape&&onCancel&&onCancel(e),e.which===types_1.KeyCodes.Tab&&(e.preventDefault(),onSubmit&&onSubmit(value,cell,nextFocusableCell(cell,isShiftKey?types_1.Direction.Left:types_1.Direction.Right)))}},rest)))},getDefaultEditor=cell=>DefaultEditor,defaultCanEdit=cell=>!0,defaultIsHidden=i=>!1;exports.default=({getEditor:getEditor=getDefaultEditor,gridRef:gridRef,getValue:getValue,onChange:onChange,onSubmit:onSubmit,onCancel:onCancel,onDelete:onDelete,selections:selections=[],activeCell:activeCell,canEdit:canEdit=defaultCanEdit,frozenRows:frozenRows=0,frozenColumns:frozenColumns=0,hideOnBlur:hideOnBlur=!0,isHiddenRow:isHiddenRow=defaultIsHidden,isHiddenColumn:isHiddenColumn=defaultIsHidden})=>{const[isEditorShown,setShowEditor]=react_1.useState(!1),[value,setValue]=react_1.useState(""),[position,setPosition]=react_1.useState({x:0,y:0,width:0,height:0}),currentActiveCellRef=react_1.useRef(null),initialActiveCell=react_1.useRef(),[scrollPosition,setScrollPosition]=react_1.useState({scrollLeft:0,scrollTop:0}),[autoFocus,setAutoFocus]=react_1.useState(!0),isDirtyRef=react_1.useRef(!1),currentValueRef=react_1.useRef(value),getValueRef=react_1.useRef(getValue),showEditor=react_1.useCallback(()=>setShowEditor(!0),[]),hideEditor=react_1.useCallback(()=>{setShowEditor(!1),currentActiveCellRef.current=null},[]),focusGrid=react_1.useCallback(()=>{requestAnimationFrame(()=>gridRef.current&&gridRef.current.focus())},[]);react_1.useEffect(()=>{currentValueRef.current=value}),react_1.useEffect(()=>{getValueRef.current=getValue},[getValue]);const makeEditable=react_1.useCallback((coords,initialValue,autoFocus=!0)=>{var _a;if(gridRef.current&&(coords=gridRef.current.getActualCellCoords(coords),!helpers_1.isEqualCells(coords,currentActiveCellRef.current)&&canEdit(coords))){null===(_a=gridRef.current)||void 0===_a||_a.scrollToItem(coords),currentActiveCellRef.current=coords;const pos=gridRef.current.getCellOffsetFromCoords(coords),scrollPosition=gridRef.current.getScrollPosition(),value=initialValue||getValueRef.current(coords)||"";null==handleChange||handleChange(value,coords),setAutoFocus(autoFocus),setPosition(getCellPosition(pos,scrollPosition)),showEditor()}},[]),getCellPosition=(position,scrollPosition)=>{var _a,_b;if(!currentActiveCellRef.current)return{x:0,y:0};const isFrozenRow=(null===(_a=currentActiveCellRef.current)||void 0===_a?void 0:_a.rowIndex)<frozenRows,isFrozenColumn=(null===(_b=currentActiveCellRef.current)||void 0===_b?void 0:_b.columnIndex)<frozenColumns;return{...position,x:position.x-(isFrozenColumn?0:scrollPosition.scrollLeft),y:position.y-(isFrozenRow?0:scrollPosition.scrollTop)}},handleDoubleClick=react_1.useCallback(e=>{if(!gridRef.current)return;const coords=gridRef.current.getCellCoordsFromOffset(e.nativeEvent.clientX,e.nativeEvent.clientY);if(!coords)return;const{rowIndex:rowIndex,columnIndex:columnIndex}=coords;makeEditable({rowIndex:rowIndex,columnIndex:columnIndex})},[getValue,frozenRows,frozenColumns]),isSelectionKey=react_1.useCallback(keyCode=>[types_1.KeyCodes.Right,types_1.KeyCodes.Left,types_1.KeyCodes.Up,types_1.KeyCodes.Down,types_1.KeyCodes.Meta,types_1.KeyCodes.Escape,types_1.KeyCodes.Tab,types_1.KeyCodes.Home,types_1.KeyCodes.End,types_1.KeyCodes.CapsLock].includes(keyCode),[]),handleKeyDown=react_1.useCallback(e=>{const keyCode=e.nativeEvent.keyCode;if(keyCode!==types_1.KeyCodes.Tab||initialActiveCell.current||(initialActiveCell.current=activeCell),isSelectionKey(keyCode)||e.nativeEvent.ctrlKey||e.nativeEvent.shiftKey&&("Shift"===e.nativeEvent.key||e.nativeEvent.which===types_1.KeyCodes.SPACE)||e.nativeEvent.metaKey||e.nativeEvent.which===types_1.KeyCodes.ALT)return;if(!activeCell)return;const{rowIndex:rowIndex,columnIndex:columnIndex}=activeCell;if(keyCode===types_1.KeyCodes.Delete||keyCode===types_1.KeyCodes.BackSpace)return void(onDelete&&onDelete(activeCell,selections));const initialValue=keyCode===types_1.KeyCodes.Enter?void 0:e.nativeEvent.key;makeEditable({rowIndex:rowIndex,columnIndex:columnIndex},initialValue),e.preventDefault()},[getValue,selections,activeCell]),nextFocusableCell=react_1.useCallback((currentCell,direction=types_1.Direction.Right)=>{var _a,_b,_c,_d,_e;const bounds=null===(_a=gridRef.current)||void 0===_a?void 0:_a.getCellBounds(currentCell);if(!bounds)return null;let nextActiveCell=currentCell;switch(direction){case types_1.Direction.Right:{let columnIndex=helpers_1.clampIndex(bounds.right+1,isHiddenColumn,direction);nextActiveCell={rowIndex:bounds.top,columnIndex:columnIndex};break}case types_1.Direction.Up:nextActiveCell={rowIndex:helpers_1.clampIndex(bounds.top-1,isHiddenRow,direction),columnIndex:bounds.left};break;case types_1.Direction.Left:{let columnIndex=helpers_1.clampIndex(bounds.left-1,isHiddenColumn,direction);nextActiveCell={rowIndex:bounds.top,columnIndex:columnIndex};break}default:nextActiveCell={rowIndex:helpers_1.clampIndex((null!==(_c=null===(_b=initialActiveCell.current)||void 0===_b?void 0:_b.rowIndex)&&void 0!==_c?_c:bounds.bottom)+1,isHiddenRow,direction),columnIndex:null!==(_e=null===(_d=initialActiveCell.current)||void 0===_d?void 0:_d.columnIndex)&&void 0!==_e?_e:bounds.left};break}if(direction!==types_1.Direction.Right||initialActiveCell.current||(initialActiveCell.current=currentCell),direction===types_1.Direction.Down&&(initialActiveCell.current=void 0),selections.length&&currentCell&&gridRef.current){const{bounds:bounds}=selections[selections.length-1],activeCellBounds=gridRef.current.getCellBounds(currentCell),nextCell=helpers_1.findNextCellWithinBounds(activeCellBounds,bounds,direction);nextCell&&(nextActiveCell=nextCell)}return nextActiveCell},[selections,isHiddenRow,isHiddenColumn]),handleSubmit=(value,activeCell,nextActiveCell)=>{hideEditor(),onSubmit&&onSubmit(value,activeCell,nextActiveCell),focusGrid()},handleMouseDown=react_1.useCallback(e=>{hideOnBlur&&(currentActiveCellRef.current&&(isDirtyRef.current?handleSubmit(currentValueRef.current,currentActiveCellRef.current):handleCancel()),initialActiveCell.current=void 0)},[hideOnBlur]),handleChange=react_1.useCallback((newValue,activeCell)=>{currentActiveCellRef.current&&(isDirtyRef.current=newValue!==value,setValue(newValue),null==onChange||onChange(newValue,activeCell))},[value]),handleCancel=react_1.useCallback(()=>{hideEditor(),onCancel&&onCancel(),focusGrid()},[]),handleScroll=react_1.useCallback(scrollPos=>{currentActiveCellRef.current&&setScrollPosition(scrollPos)},[]),editingCell=currentActiveCellRef.current,Editor=react_1.useMemo(()=>editingCell?getEditor(editingCell)||getDefaultEditor():null,[editingCell]),handleBlur=react_1.useCallback(e=>{currentActiveCellRef.current&&focusGrid()},[]);return{editorComponent:isEditorShown&&Editor?react_1.default.createElement(Editor,{cell:editingCell,activeCell:activeCell,autoFocus:autoFocus,value:value,selections:selections,onChange:handleChange,onSubmit:handleSubmit,onCancel:handleCancel,position:position,scrollPosition:scrollPosition,nextFocusableCell:nextFocusableCell,onBlur:handleBlur}):null,onDoubleClick:handleDoubleClick,onKeyDown:handleKeyDown,nextFocusableCell:nextFocusableCell,isEditInProgress:!!editingCell,editingCell:editingCell,makeEditable:makeEditable,setValue:handleChange,hideEditor:hideEditor,showEditor:showEditor,submitEditor:handleSubmit,cancelEditor:handleCancel,onMouseDown:handleMouseDown,onScroll:handleScroll}}},386:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(1)),helpers_1=__webpack_require__(61),DefaultTooltipComponent=({x:x=0,y:y=0})=>react_1.default.createElement("div",{style:{position:"absolute",left:0,top:0,transform:`translate(${x}px, ${y}px)`,maxWidth:200,background:"white",boxShadow:"0 4px 8px 3px rgba(60,64,67,.15)",padding:12,borderRadius:4,fontSize:13}},x),getDefaultTooltip=()=>DefaultTooltipComponent;exports.default=({gridRef:gridRef,getTooltip:getTooltip=getDefaultTooltip})=>{const[activeCell,setActiveCell]=react_1.useState(null),isTooltipActive=react_1.useRef(!1),activeCellRef=react_1.useRef(activeCell),[tooltipPosition,setTooltipPosition]=react_1.useState({}),showTooltip=!!activeCell,TooltipComponent=react_1.useMemo(()=>getTooltip(activeCell),[activeCell]),handleTooltipMouseEnter=react_1.useCallback(()=>{isTooltipActive.current=!0},[]),handleTooltipMouseLeave=react_1.useCallback(()=>{isTooltipActive.current=!1,setActiveCell(null)},[]),tooltipComponent=showTooltip&&TooltipComponent?react_1.default.createElement(TooltipComponent,Object.assign({},tooltipPosition,{onMouseEnter:handleTooltipMouseEnter,onMouseLeave:handleTooltipMouseLeave})):null,handleMouseMove=react_1.useCallback(e=>{if(!gridRef.current)return;const coords=gridRef.current.getCellCoordsFromOffset(e.clientX,e.clientY);if(!coords)return;const{rowIndex:rowIndex,columnIndex:columnIndex}=coords;if(activeCellRef.current&&activeCellRef.current.rowIndex===rowIndex&&activeCellRef.current.columnIndex===columnIndex)return;const pos=gridRef.current.getCellOffsetFromCoords(coords),scrollPosition=gridRef.current.getScrollPosition();setTooltipPosition({...pos,...scrollPosition}),setActiveCell({rowIndex:rowIndex,columnIndex:columnIndex})},[]),handleMouseLeave=react_1.useCallback(()=>{isTooltipActive.current||setActiveCell(null)},[]),mouseMoveThrottler=react_1.useRef(helpers_1.throttle(handleMouseMove,100)),mouseLeaveThrottler=react_1.useRef(helpers_1.debounce(handleMouseLeave,2e3));return react_1.useEffect(()=>{activeCellRef.current=activeCell},[activeCell]),{tooltipComponent:tooltipComponent,onMouseMove:mouseMoveThrottler.current,onMouseLeave:mouseLeaveThrottler.current}}},388:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__webpack_require__(1),types_1=__webpack_require__(62);exports.default=(props={})=>{const{onRedo:onRedo,onUndo:onUndo}=props,undoStack=react_1.useRef([]),undoStackPointer=react_1.useRef(-1),[_,forceRender]=react_1.useReducer(s=>s+1,0),handleKeyDown=react_1.useCallback(e=>{const isUndo=(e.metaKey||e.ctrlKey)&&e.which===types_1.KeyCodes.Z,isRedo=e.shiftKey&&isUndo||e.which===types_1.KeyCodes.KEY_Y;(isRedo||isUndo)&&(isRedo?handleRedo():handleUndo())},[]),handleUndo=()=>{if(undoStackPointer.current<0)return;const patches=undoStack.current[undoStackPointer.current].inversePatches;undoStackPointer.current--,onUndo&&onUndo(patches),forceRender()},handleRedo=()=>{if(undoStackPointer.current===undoStack.current.length-1)return;undoStackPointer.current++;const patches=undoStack.current[undoStackPointer.current].patches;onRedo&&onRedo(patches),forceRender()};return{undo:handleUndo,redo:handleRedo,add:history=>{const{patches:patches,inversePatches:inversePatches}=history,pointer=++undoStackPointer.current;undoStack.current.length=pointer,undoStack.current[pointer]={patches:patches,inversePatches:inversePatches},forceRender()},onKeyDown:handleKeyDown,canUndo:!(undoStackPointer.current<0),canRedo:!(undoStackPointer.current===undoStack.current.length-1)}}},389:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(1)),helpers_1=__webpack_require__(61),getDefaultFilerComponent=cell=>null;exports.default=({getFilterComponent:getFilterComponent=getDefaultFilerComponent,gridRef:gridRef,width:width=220,offset:offset=20,getValue:getValue,frozenRows:frozenRows=0,frozenColumns:frozenColumns=0})=>{const[filterCell,setFilterCell]=react_1.useState(null),[isFilterVisible,setIsFilterVisible]=react_1.useState(!1),[currentFilter,setCurrentFilter]=react_1.useState(null),[position,setPosition]=react_1.useState({x:0,y:0}),FilterComponent=react_1.useMemo(()=>getFilterComponent(filterCell),[filterCell]),handleShowFilter=react_1.useCallback((coords,index,filterView,filter)=>{if(!gridRef.current)return;coords=gridRef.current.getActualCellCoords(coords);const scrollPosition=gridRef.current.getScrollPosition(),pos=gridRef.current.getCellOffsetFromCoords(coords),isFrozenColumn=coords.columnIndex<frozenColumns,isFrozenRow=coords.rowIndex<frozenRows;setPosition(prev=>{const left=pos.x,top=pos.y,cellWidth=pos.width;return{x:left+cellWidth-(isFrozenColumn?0:scrollPosition.scrollLeft)<width?left+cellWidth-offset-(isFrozenColumn?0:scrollPosition.scrollLeft):left+cellWidth-(isFrozenColumn?0:scrollPosition.scrollLeft)-width,y:top-(isFrozenRow?0:scrollPosition.scrollTop)+offset}}),setFilterCell(coords),setCurrentFilter({filter:filter,filterView:filterView,index:index}),showFilter()},[frozenRows,frozenColumns]),hideFilter=react_1.useCallback(()=>{setIsFilterVisible(!1)},[]),showFilter=react_1.useCallback(()=>{setIsFilterVisible(!0)},[]),values=react_1.useMemo(()=>{if(!filterCell||!currentFilter)return[];const{filter:filter,filterView:filterView}=currentFilter,{columnIndex:columnIndex}=filterCell,{bounds:bounds}=filterView;var filterValues=new Set;for(let i=bounds.top+1;i<=bounds.bottom;i++){const text=getValue({rowIndex:i,columnIndex:columnIndex}),value=helpers_1.isNull(text)?"":text;filterValues.add(value)}return Array.from(filterValues)},[filterCell,currentFilter]);return{filterComponent:isFilterVisible&&FilterComponent?react_1.default.createElement(FilterComponent,{position:position,width:width,values:values,index:null==currentFilter?void 0:currentFilter.index,filter:null==currentFilter?void 0:currentFilter.filter,columnIndex:null==filterCell?void 0:filterCell.columnIndex}):null,showFilter:handleShowFilter,hideFilter:hideFilter}}},390:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultSheets=void 0;const react_1=__importStar(__webpack_require__(1)),Toolbar_1=__importDefault(__webpack_require__(803)),Formulabar_1=__importDefault(__webpack_require__(927)),Workbook_1=__importDefault(__webpack_require__(929)),core_1=__webpack_require__(33),core_2=__webpack_require__(2),grid_1=__webpack_require__(6),constants_1=__webpack_require__(30),types_1=__webpack_require__(90),types_2=__webpack_require__(62),tiny_invariant_1=__importDefault(__webpack_require__(249)),Editor_1=__importDefault(__webpack_require__(412)),StatusBar_1=__importDefault(__webpack_require__(949)),useFonts_1=__importDefault(__webpack_require__(951)),state_1=__webpack_require__(415),ContextMenu_1=__importDefault(__webpack_require__(954)),Tooltip_1=__importDefault(__webpack_require__(413)),validation_1=__importDefault(__webpack_require__(416)),defaultActiveSheet=constants_1.uuid();exports.defaultSheets=[{id:defaultActiveSheet,name:"Sheet1",rowCount:1e3,columnCount:1e3,frozenColumns:0,frozenRows:0,activeCell:{rowIndex:1,columnIndex:1},mergedCells:[],selections:[],cells:{},scrollState:{scrollTop:0,scrollLeft:0},filterViews:[]}];const Spreadsheet=react_1.memo(react_1.forwardRef((props,forwardedRef)=>{const{sheets:initialSheets=exports.defaultSheets,showFormulabar:showFormulabar=!0,minColumnWidth:minColumnWidth=constants_1.DEFAULT_COLUMN_WIDTH,minRowHeight:minRowHeight=constants_1.DEFAULT_ROW_HEIGHT,CellRenderer:CellRenderer,HeaderCellRenderer:HeaderCellRenderer,activeSheet:activeSheet,onChangeSelectedSheet:onChangeSelectedSheet,onChange:onChange,onChangeCell:onChangeCell,showToolbar:showToolbar=!0,formatter:formatter=constants_1.format,enableDarkMode:enableDarkMode=!0,fontFamily:fontFamily=constants_1.SYSTEM_FONT,minHeight:minHeight=400,CellEditor:CellEditor=Editor_1.default,onActiveCellChange:onActiveCellChange,onSelectionChange:onSelectionChange,selectionMode:selectionMode,showTabStrip:showTabStrip=!0,isTabEditable:isTabEditable=!0,allowNewSheet:allowNewSheet=!0,showStatusBar:showStatusBar=!0,StatusBar:StatusBar=StatusBar_1.default,ContextMenu:ContextMenu=ContextMenu_1.default,Tooltip:Tooltip=Tooltip_1.default,initialScale:initialScale=1,onScaleChange:onScaleChange,fontLoaderConfig:fontLoaderConfig,fontList:fontList=constants_1.FONT_FAMILIES,selectionPolicy:selectionPolicy,snap:snap=!1,stateReducer:stateReducer,onValidate:onValidate=validation_1.default}=props,lastActiveCellRef=react_1.useRef(null),lastSelectionsRef=react_1.useRef([]),beforeUndoRedo=react_1.useCallback(patches=>{var _a,_b;patches.some(item=>item.path.includes("filterViews"))&&(null===(_b=null===(_a=currentGrid.current)||void 0===_a?void 0:_a.resetAfterIndices)||void 0===_b||_b.call(_a,{rowIndex:0},!1))},[]),{add:addUndoPatch,canRedo:canRedo,canUndo:canUndo,undo:undo,redo:redo,onKeyDown:onUndoKeyDown}=grid_1.useUndo({onUndo:patches=>{var _a,_b;beforeUndoRedo(patches),dispatch({type:state_1.ACTION_TYPE.APPLY_PATCHES,patches:patches,undoable:!1}),lastActiveCellRef.current&&(null===(_a=currentGrid.current)||void 0===_a||_a.setActiveCell(lastActiveCellRef.current)),lastSelectionsRef.current&&(null===(_b=currentGrid.current)||void 0===_b||_b.setSelections(lastSelectionsRef.current))},onRedo:patches=>{var _a,_b;beforeUndoRedo(patches),dispatch({type:state_1.ACTION_TYPE.APPLY_PATCHES,patches:patches,undoable:!1});const activeCellPatch=patches.find(item=>item.path.includes("currentActiveCell")),selectionsPatch=patches.find(item=>item.path.includes("currentSelections"));activeCellPatch&&(null===(_a=currentGrid.current)||void 0===_a||_a.setActiveCell(activeCellPatch.value)),selectionsPatch&&(null===(_b=currentGrid.current)||void 0===_b||_b.setSelections(selectionsPatch.value))}}),getCellBounds=react_1.useCallback(cell=>{var _a,_b;if(cell)return null===(_b=null===(_a=currentGrid.current)||void 0===_a?void 0:_a.getCellBounds)||void 0===_b?void 0:_b.call(_a,cell)},[]),[state,dispatch]=react_1.useReducer(react_1.useCallback(state_1.createStateReducer({addUndoPatch:addUndoPatch,getCellBounds:getCellBounds,stateReducer:stateReducer}),[]),{sheets:initialSheets,selectedSheet:void 0===activeSheet?initialSheets.length?initialSheets[0].id:null:activeSheet}),{selectedSheet:selectedSheet,sheets:sheets,currentActiveCell:currentActiveCell,currentSelections:currentSelections}=state,[scale,setScale]=react_1.useState(initialScale),selectedSheetRef=react_1.useRef(selectedSheet),currentGrid=react_1.useRef(null),[formulaInput,setFormulaInput]=react_1.useState("");react_1.useEffect(()=>{lastActiveCellRef.current=currentActiveCell,lastSelectionsRef.current=currentSelections},[currentActiveCell,currentSelections]);const setSelectedSheet=react_1.useCallback(id=>{id!==selectedSheet&&dispatch({type:state_1.ACTION_TYPE.SELECT_SHEET,id:id})},[selectedSheet]);tiny_invariant_1.default(null!==selectedSheet,"Exception, selectedSheet is empty, Please specify a selected sheet using `selectedSheet` prop");const{isFontActive:isFontActive}=useFonts_1.default(fontLoaderConfig);react_1.useEffect(()=>{var _a,_b;isFontActive&&(null===(_b=null===(_a=currentGrid.current)||void 0===_a?void 0:_a.resetAfterIndices)||void 0===_b||_b.call(_a,{rowIndex:0,columnIndex:0}))},[isFontActive]),react_1.useEffect(()=>{null==onScaleChange||onScaleChange(scale)},[scale]),react_1.useImperativeHandle(forwardedRef,()=>({grid:currentGrid.current}),[]),react_1.useEffect(()=>{null==onChange||onChange(sheets)},[sheets]),react_1.useEffect(()=>{null==onChangeSelectedSheet||onChangeSelectedSheet(selectedSheet)},[selectedSheet]),react_1.useEffect(()=>{selectedSheetRef.current=selectedSheet}),react_1.useEffect(()=>{sheets!==initialSheets&&dispatch({type:state_1.ACTION_TYPE.REPLACE_SHEETS,sheets:initialSheets})},[initialSheets]);const handleNewSheet=react_1.useCallback(()=>{var _a;const count=sheets.length,newSheet=constants_1.createNewSheet({count:count+1});dispatch({type:state_1.ACTION_TYPE.NEW_SHEET,sheet:newSheet}),null===(_a=currentGrid.current)||void 0===_a||_a.focus()},[sheets,selectedSheet]),currentSheet=react_1.useMemo(()=>sheets.find(sheet=>sheet.id===selectedSheet),[sheets,selectedSheet]),getCellConfig=react_1.useCallback(cell=>{var _a;return null===(_a=currentSheet.cells[cell.rowIndex])||void 0===_a?void 0:_a[cell.columnIndex]},[currentSheet]),[activeCellConfig,activeCell]=react_1.useMemo(()=>{var _a;const{activeCell:activeCell,cells:cells}=currentSheet||{};return[activeCell?null===(_a=null==cells?void 0:cells[activeCell.rowIndex])||void 0===_a?void 0:_a[activeCell.columnIndex]:null,activeCell]},[currentSheet]),handleChange=react_1.useCallback(async(id,value,cell)=>{const config=getCellConfig(cell),datatype=constants_1.detectDataType(value);dispatch({type:state_1.ACTION_TYPE.CHANGE_SHEET_CELL,value:value,cell:cell,id:id,datatype:datatype}),null==onChangeCell||onChangeCell(id,value,cell),requestAnimationFrame(async()=>{const{valid:valid,message:message}=await onValidate(value,id,cell,config)||{};dispatch({type:state_1.ACTION_TYPE.VALIDATION_SUCCESS,cell:cell,id:id,valid:valid,prompt:message})})},[activeCellConfig]),handleSheetAttributesChange=react_1.useCallback((id,{activeCell:activeCell,selections:selections})=>{dispatch({type:state_1.ACTION_TYPE.SHEET_SELECTION_CHANGE,id:id,activeCell:activeCell,selections:selections,undoable:!1})},[]),handleChangeSheetName=react_1.useCallback((id,name)=>{dispatch({type:state_1.ACTION_TYPE.CHANGE_SHEET_NAME,id:id,name:name})},[]),handleDeleteSheet=react_1.useCallback(id=>{var _a;1!==sheets.length&&(dispatch({type:state_1.ACTION_TYPE.DELETE_SHEET,id:id}),null===(_a=currentGrid.current)||void 0===_a||_a.focus())},[sheets,selectedSheet]),handleDuplicateSheet=react_1.useCallback(id=>{const newSheetId=constants_1.uuid(),index=sheets.findIndex(sheet=>sheet.id===id);if(-1===index)return;const newSheet={...sheets[index],id:newSheetId,name:"Copy of "+currentSheet.name};dispatch({type:state_1.ACTION_TYPE.NEW_SHEET,sheet:newSheet,index:index})},[sheets,selectedSheet]),handleFormattingChangeAuto=react_1.useCallback(()=>{var _a,_b;const sheet=sheets.find(sheet=>sheet.id===selectedSheet);if(sheet){const{selections:selections,activeCell:activeCell}=sheet,sel=selections.length?selections:activeCell?[{bounds:null===(_b=null===(_a=currentGrid.current)||void 0===_a?void 0:_a.getCellBounds)||void 0===_b?void 0:_b.call(_a,activeCell)}]:[];dispatch({type:state_1.ACTION_TYPE.FORMATTING_CHANGE_AUTO,id:selectedSheet,selections:sel,activeCell:activeCell})}},[selectedSheet,sheets]),handleFormattingChangePlain=react_1.useCallback(()=>{var _a,_b;const sheet=sheets.find(sheet=>sheet.id===selectedSheet);if(sheet){const{selections:selections,activeCell:activeCell}=sheet,sel=selections.length?selections:activeCell?[{bounds:null===(_b=null===(_a=currentGrid.current)||void 0===_a?void 0:_a.getCellBounds)||void 0===_b?void 0:_b.call(_a,activeCell)}]:[];dispatch({type:state_1.ACTION_TYPE.FORMATTING_CHANGE_PLAIN,id:selectedSheet,selections:sel,activeCell:activeCell})}},[selectedSheet,sheets]),handleFormattingChange=react_1.useCallback((key,value)=>{dispatch({type:state_1.ACTION_TYPE.FORMATTING_CHANGE,id:selectedSheet,key:key,value:value})},[selectedSheet,sheets]),handleActiveCellChange=react_1.useCallback((id,cell,value)=>{cell&&(setFormulaInput(value||""),null==onActiveCellChange||onActiveCellChange(id,cell))},[]),handleActiveCellValueChange=react_1.useCallback(value=>{setFormulaInput(value)},[]),handleFormulabarFocus=react_1.useCallback(e=>{var _a;const input=e.target;activeCell&&(null===(_a=currentGrid.current)||void 0===_a||_a.makeEditable(activeCell,input.value,!1),requestAnimationFrame(()=>null==input?void 0:input.focus()))},[activeCell]),handleFormulabarChange=react_1.useCallback(e=>{var _a;if(!activeCell)return;const value=e.target.value;setFormulaInput(value),0!==(null==activeCell?void 0:activeCell.rowIndex)&&0!==(null==activeCell?void 0:activeCell.columnIndex)&&(null===(_a=currentGrid.current)||void 0===_a||_a.setEditorValue(value,activeCell))},[activeCell,selectedSheet]),submitEditor=(value,activeCell,direction=types_2.Direction.Down)=>{var _a,_b;const nextActiveCell=null===(_a=currentGrid.current)||void 0===_a?void 0:_a.getNextFocusableCell(activeCell,direction);null===(_b=currentGrid.current)||void 0===_b||_b.submitEditor(value,activeCell,nextActiveCell)},handleFormulabarKeydown=react_1.useCallback(e=>{var _a,_b;activeCell&&0!==(null==activeCell?void 0:activeCell.rowIndex)&&0!==(null==activeCell?void 0:activeCell.columnIndex)&&(e.which===types_2.KeyCodes.Enter&&submitEditor(formulaInput,activeCell),e.which===types_2.KeyCodes.Escape&&(null===(_a=currentGrid.current)||void 0===_a||_a.cancelEditor(),setFormulaInput((null===(_b=null==activeCellConfig?void 0:activeCellConfig.text)||void 0===_b?void 0:_b.toString())||"")),e.which===types_2.KeyCodes.Tab&&(submitEditor(formulaInput,activeCell,types_2.Direction.Right),e.preventDefault()))},[activeCell,formulaInput,activeCellConfig]),handleFill=react_1.useCallback((id,activeCell,fillSelection)=>{var _a;fillSelection&&(dispatch({type:state_1.ACTION_TYPE.UPDATE_FILL,id:id,activeCell:activeCell,fillSelection:fillSelection}),null===(_a=currentGrid.current)||void 0===_a||_a.focus())},[sheets]),handleDelete=react_1.useCallback((id,activeCell,selections)=>{dispatch({type:state_1.ACTION_TYPE.DELETE_CELLS,id:id,activeCell:activeCell,selections:selections}),setFormulaInput("")},[]),handleClearFormatting=react_1.useCallback(()=>{dispatch({type:state_1.ACTION_TYPE.CLEAR_FORMATTING,id:selectedSheet})},[sheets,selectedSheet]),handleResize=react_1.useCallback((id,axis,index,dimension)=>{var _a,_b,_c,_d;dispatch({type:state_1.ACTION_TYPE.RESIZE,id:id,index:index,dimension:dimension,axis:axis,undoable:!1}),axis===types_1.AXIS.X?null===(_b=null===(_a=currentGrid.current)||void 0===_a?void 0:_a.resizeColumns)||void 0===_b||_b.call(_a,[index]):null===(_d=null===(_c=currentGrid.current)||void 0===_c?void 0:_c.resizeRows)||void 0===_d||_d.call(_c,[index])},[]),handleMergeCells=react_1.useCallback(()=>{dispatch({type:state_1.ACTION_TYPE.MERGE_CELLS,id:selectedSheet})},[selectedSheet,sheets]),handleFrozenRowChange=react_1.useCallback(count=>{dispatch({type:state_1.ACTION_TYPE.FROZEN_ROW_CHANGE,id:selectedSheet,count:count})},[selectedSheet]),handleFrozenColumnChange=react_1.useCallback(count=>{dispatch({type:state_1.ACTION_TYPE.FROZEN_COLUMN_CHANGE,id:selectedSheet,count:count})},[selectedSheet]),handleBorderChange=react_1.useCallback((color,borderStyle,variant)=>{dispatch({type:state_1.ACTION_TYPE.SET_BORDER,id:selectedSheet,color:color,borderStyle:borderStyle,variant:variant})},[selectedSheet]),handleScroll=react_1.useCallback((id,scrollState)=>{dispatch({type:state_1.ACTION_TYPE.UPDATE_SCROLL,id:id,scrollState:scrollState})},[]),handlePaste=react_1.useCallback((id,rows,activeCell)=>{var _a;if(!activeCell)return;const{rowIndex:rowIndex,columnIndex:columnIndex}=activeCell,endRowIndex=Math.max(rowIndex,rowIndex+rows.length-1),endColumnIndex=Math.max(columnIndex,columnIndex+(rows.length&&rows[0].length-1));dispatch({type:state_1.ACTION_TYPE.PASTE,id:id,rows:rows,activeCell:activeCell}),rowIndex===endRowIndex&&columnIndex===endColumnIndex||null===(_a=currentGrid.current)||void 0===_a||_a.setSelections([{bounds:{top:rowIndex,left:columnIndex,bottom:endRowIndex,right:endColumnIndex}}])},[]),handleCut=react_1.useCallback((id,selection)=>{dispatch({type:state_1.ACTION_TYPE.REMOVE_CELLS,id:id,activeCell:null,selections:[selection]})},[]),handleInsertRow=react_1.useCallback((id,activeCell)=>{null!==activeCell&&dispatch({type:state_1.ACTION_TYPE.INSERT_ROW,id:id,activeCell:activeCell})},[]),handleInsertColumn=react_1.useCallback((id,activeCell)=>{null!==activeCell&&dispatch({type:state_1.ACTION_TYPE.INSERT_COLUMN,id:id,activeCell:activeCell})},[]),handleDeleteRow=react_1.useCallback((id,activeCell)=>{null!==activeCell&&dispatch({type:state_1.ACTION_TYPE.DELETE_ROW,id:id,activeCell:activeCell})},[]),handleDeleteColumn=react_1.useCallback((id,activeCell)=>{null!==activeCell&&dispatch({type:state_1.ACTION_TYPE.DELETE_COLUMN,id:id,activeCell:activeCell})},[]),handleKeyDown=react_1.useCallback((id,event,activeCell)=>{var _a,_b,_c,_d;if(!activeCell)return;const isMeta=event.metaKey||event.ctrlKey,isShift=event.shiftKey,keyCode=event.which,getCellConfig=cell=>{var _a,_b;const sheet=sheets.find(sheet=>sheet.id===id);return null===(_b=null===(_a=null==sheet?void 0:sheet.cells)||void 0===_a?void 0:_a[cell.rowIndex])||void 0===_b?void 0:_b[cell.columnIndex]};switch(keyCode){case types_2.KeyCodes.KEY_B:if(!isMeta)return;handleFormattingChange(types_1.FORMATTING_TYPE.BOLD,!(null===(_a=getCellConfig(activeCell))||void 0===_a?void 0:_a.bold));break;case types_2.KeyCodes.KEY_I:if(!isMeta)return;handleFormattingChange(types_1.FORMATTING_TYPE.ITALIC,!(null===(_b=getCellConfig(activeCell))||void 0===_b?void 0:_b.italic));break;case types_2.KeyCodes.KEY_U:if(!isMeta)return;handleFormattingChange(types_1.FORMATTING_TYPE.UNDERLINE,!(null===(_c=getCellConfig(activeCell))||void 0===_c?void 0:_c.underline));break;case types_2.KeyCodes.KEY_X:if(!isMeta||!isShift)return;handleFormattingChange(types_1.FORMATTING_TYPE.STRIKE,!(null===(_d=getCellConfig(activeCell))||void 0===_d?void 0:_d.strike));break;case types_2.KeyCodes.BACK_SLASH:if(!isMeta)return;handleClearFormatting(),null==event||event.preventDefault();break;case types_2.KeyCodes.KEY_L:case types_2.KeyCodes.KEY_E:case types_2.KeyCodes.KEY_R:if(!isMeta||!isShift)return;const align=keyCode===types_2.KeyCodes.KEY_L?"left":keyCode===types_2.KeyCodes.KEY_E?"center":"right";handleFormattingChange(types_1.FORMATTING_TYPE.HORIZONTAL_ALIGN,align),null==event||event.preventDefault()}null==onUndoKeyDown||onUndoKeyDown(event)},[sheets,currentSheet]),handleChangeFilter=react_1.useCallback((id,filterViewIndex,columnIndex,filter)=>{var _a,_b;null===(_b=null===(_a=currentGrid.current)||void 0===_a?void 0:_a.resetAfterIndices)||void 0===_b||_b.call(_a,{rowIndex:0},!1),dispatch({type:state_1.ACTION_TYPE.CHANGE_FILTER,id:id,filterViewIndex:filterViewIndex,columnIndex:columnIndex,filter:filter})},[]),handleScaleChange=react_1.useCallback(value=>{var _a,_b;null===(_b=null===(_a=currentGrid.current)||void 0===_a?void 0:_a.resetAfterIndices)||void 0===_b||_b.call(_a,{rowIndex:0,columnIndex:0},!1),setScale(value)},[selectedSheet]);return react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_2.Global,{styles:core_2.css`
            .rowsncolumns-spreadsheet {
              font-family: ${fontFamily};
            }
            .rowsncolumns-grid-container:focus {
              outline: none;
            }
          `}),react_1.default.createElement(core_1.Flex,{flexDirection:"column",flex:1,minWidth:0,minHeight:minHeight,className:"rowsncolumns-spreadsheet"},showToolbar?react_1.default.createElement(Toolbar_1.default,{wrap:null==activeCellConfig?void 0:activeCellConfig.wrap,datatype:null==activeCellConfig?void 0:activeCellConfig.datatype,plaintext:null==activeCellConfig?void 0:activeCellConfig.plaintext,format:null==activeCellConfig?void 0:activeCellConfig.format,fontSize:null==activeCellConfig?void 0:activeCellConfig.fontSize,fontFamily:null==activeCellConfig?void 0:activeCellConfig.fontFamily,fill:null==activeCellConfig?void 0:activeCellConfig.fill,bold:null==activeCellConfig?void 0:activeCellConfig.bold,italic:null==activeCellConfig?void 0:activeCellConfig.italic,strike:null==activeCellConfig?void 0:activeCellConfig.strike,underline:null==activeCellConfig?void 0:activeCellConfig.underline,color:null==activeCellConfig?void 0:activeCellConfig.color,percent:null==activeCellConfig?void 0:activeCellConfig.percent,currency:null==activeCellConfig?void 0:activeCellConfig.currency,verticalAlign:null==activeCellConfig?void 0:activeCellConfig.verticalAlign,horizontalAlign:null==activeCellConfig?void 0:activeCellConfig.horizontalAlign,onFormattingChange:handleFormattingChange,onFormattingChangeAuto:handleFormattingChangeAuto,onFormattingChangePlain:handleFormattingChangePlain,onClearFormatting:handleClearFormatting,onMergeCells:handleMergeCells,frozenRows:currentSheet.frozenRows,frozenColumns:currentSheet.frozenColumns,onFrozenRowChange:handleFrozenRowChange,onFrozenColumnChange:handleFrozenColumnChange,onBorderChange:handleBorderChange,onRedo:redo,onUndo:undo,canRedo:canRedo,canUndo:canUndo,enableDarkMode:enableDarkMode,scale:scale,onScaleChange:handleScaleChange,fontList:fontList}):null,showFormulabar?react_1.default.createElement(Formulabar_1.default,{value:formulaInput,onChange:handleFormulabarChange,onKeyDown:handleFormulabarKeydown,onFocus:handleFormulabarFocus}):null,react_1.default.createElement(Workbook_1.default,{scale:scale,StatusBar:StatusBar,showTabStrip:showTabStrip,isTabEditable:isTabEditable,allowNewSheet:allowNewSheet,onResize:handleResize,formatter:formatter,ref:currentGrid,onDelete:handleDelete,onFill:handleFill,onActiveCellValueChange:handleActiveCellValueChange,onActiveCellChange:handleActiveCellChange,currentSheet:currentSheet,selectedSheet:selectedSheet,onChangeSelectedSheet:setSelectedSheet,onNewSheet:handleNewSheet,theme:core_1.theme,sheets:sheets,onChange:handleChange,onSheetChange:handleSheetAttributesChange,minColumnWidth:minColumnWidth,minRowHeight:minRowHeight,CellRenderer:CellRenderer,HeaderCellRenderer:HeaderCellRenderer,onChangeSheetName:handleChangeSheetName,onDeleteSheet:handleDeleteSheet,onDuplicateSheet:handleDuplicateSheet,onScroll:handleScroll,onKeyDown:handleKeyDown,onPaste:handlePaste,onCut:handleCut,onInsertRow:handleInsertRow,onInsertColumn:handleInsertColumn,onDeleteRow:handleDeleteRow,onDeleteColumn:handleDeleteColumn,CellEditor:CellEditor,onSelectionChange:onSelectionChange,selectionMode:selectionMode,onChangeFilter:handleChangeFilter,showStatusBar:showStatusBar,selectionPolicy:selectionPolicy,ContextMenu:ContextMenu,snap:snap,Tooltip:Tooltip})))})),ThemeWrapper=react_1.forwardRef((props,forwardedRef)=>{const{theme:defaultTheme=core_1.theme,initialColorMode:initialColorMode,...rest}=props;return react_1.default.createElement(core_1.ThemeProvider,{theme:defaultTheme},react_1.default.createElement(core_1.ColorModeProvider,{value:initialColorMode},react_1.default.createElement(Spreadsheet,Object.assign({},rest,{ref:forwardedRef}))))});exports.default=ThemeWrapper},398:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.translations=void 0,exports.translations={undo:"Undo",redo:"Redo",print:"Print",format_as_currency:"Format as currency",format_as_percent:"Format as percent",decrease_decimal:"Decrease decimal places",increase_decimal:"Increase decimal places",bold:"Bold",italic:"Italic",underline:"Underline",text_color:"Text color",fill_color:"Fill color",strikethrough:"Strikethrough",borders:"Borders",border_all:"All borders",border_inner:"Inner border",border_horizontal:"Horizontal border",border_vertical:"Vertical border",border_outer:"Outer border",border_left:"Left border",border_right:"Right border",border_bottom:"Bottom border",border_top:"Top border",border_none:"Clear borders",border_color:"Border color",border_style:"Border style",merge_cells:"Merge cells",freeze:"Freeze rows and columns",freeze_rows:"Freeze rows",freeze_columns:"Freeze columns",horizontal_align:"Horizontal align",vertical_align:"Vertical align",switch_light_mode:"Switch to light mode",switch_dark_mode:"Switch to dark mode",clear_formatting:"Clear formatting",add_sheet:"Add sheet",all_sheets:"All sheets",text_wrapping:"Text wrapping",text_wrap:"Wrap",text_clip:"Clip",more_formats:"More formats",zoom:"Zoom",font:"Font"}},408:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(1)),styled_1=__webpack_require__(89),downshift_1=__importDefault(__webpack_require__(417)),core_1=__webpack_require__(33),constants_1=__webpack_require__(30),types_1=__webpack_require__(62),Select=react_1.memo(props=>{const{options:options,value:value,onChange:onChange,format:format,inputWidth:inputWidth=44,enableInput:enableInput=!0}=props,theme=core_1.useTheme(),{colorMode:colorMode}=core_1.useColorMode(),isLight="light"===colorMode,borderColor=isLight?theme.colors.gray[300]:theme.colors.gray[600],inputBorderColor=isLight?theme.colors.gray[300]:theme.colors.gray[600],inputBgColor=isLight?theme.colors.white:constants_1.DARK_MODE_COLOR,inputColor=isLight?constants_1.DARK_MODE_COLOR:theme.colors.white,dropdownBgColor=isLight?theme.colors.white:theme.colors.gray[700];return react_1.default.createElement(downshift_1.default,{selectedItem:value,onChange:sel=>null==onChange?void 0:onChange(sel),itemToString:item=>item?item.value.toString():""},({getInputProps:getInputProps,getMenuProps:getMenuProps,getRootProps:getRootProps,isOpen:isOpen,getItemProps:getItemProps,inputValue:inputValue,highlightedIndex:highlightedIndex,selectedItem:selectedItem,selectItem:selectItem,closeMenu:closeMenu,getToggleButtonProps:getToggleButtonProps,openMenu:openMenu})=>{const inputProps=getInputProps();return react_1.default.createElement(core_1.Box,Object.assign({position:"relative"},getRootProps()),react_1.default.createElement(core_1.Box,{display:"flex",alignItems:"center"},enableInput?react_1.default.createElement("input",Object.assign({style:{width:inputWidth,height:24,paddingLeft:4,paddingRight:2,borderColor:inputBorderColor,background:inputBgColor,color:inputColor,borderStyle:"solid",borderWidth:1,fontSize:12}},inputProps,{onKeyDown:e=>{if(inputProps&&inputProps.onKeyDown&&inputProps.onKeyDown(e),e.which===types_1.KeyCodes.Enter&&null===highlightedIndex){const value=null==format?void 0:format(e.currentTarget.value);null==selectItem||selectItem({value:value,label:value}),closeMenu()}},onFocus:()=>openMenu()})):react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":inputValue||"",label:inputValue||"",placement:"bottom-start"},react_1.default.createElement(core_1.Box,Object.assign({cursor:"pointer",pl:2,pr:2,title:inputValue},getToggleButtonProps(),{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontSize:12,width:inputWidth}),inputValue)),react_1.default.createElement(styled_1.IconButton,Object.assign({color:inputColor,height:5,minWidth:5,"aria-label":"Open",icon:"chevron-down",size:"sm",fontSize:16},getToggleButtonProps()))),react_1.default.createElement(core_1.Box,Object.assign({background:dropdownBgColor,shadow:"md",position:"absolute",top:"100%",zIndex:1,borderRadius:5},getMenuProps(),{pb:1,pt:1,borderColor:borderColor,borderStyle:"solid",borderWidth:1,display:isOpen?"block":"none"}),options.map((item,index)=>{const{label:label,value:value}=item;return react_1.default.createElement(core_1.Box,Object.assign({fontSize:12,padding:2,pl:3,pr:3,whiteSpace:"nowrap"},getItemProps({key:value,index:index,item:item,style:{cursor:"pointer",backgroundColor:highlightedIndex===index||(null==selectedItem?void 0:selectedItem.value)===item.value?isLight?theme.colors.gray[100]:"rgba(255,255,255,0.06)":dropdownBgColor,fontWeight:(null==selectedItem?void 0:selectedItem.value)===item.value?"bold":"normal"}})),label)})))})});exports.default=Select},409:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(1)),resize_observer_1=__webpack_require__(965),react_use_measure_1=__importDefault(__webpack_require__(930)),Grid_1=__importDefault(__webpack_require__(931)),core_1=__webpack_require__(33),styled_1=__webpack_require__(89),Tabs_1=__importDefault(__webpack_require__(945)),grid_1=__webpack_require__(6),constants_1=__webpack_require__(30),Workbook=react_1.memo(react_1.forwardRef((props,forwardedRef)=>{const{selectedSheet:selectedSheet,onChangeSelectedSheet:onChangeSelectedSheet,sheets:sheets,onChange:onChange,minColumnWidth:minColumnWidth,minRowHeight:minRowHeight,CellRenderer:CellRenderer,HeaderCellRenderer:HeaderCellRenderer,onNewSheet:onNewSheet,onSheetChange:onSheetChange,theme:theme,onChangeSheetName:onChangeSheetName,onDeleteSheet:onDeleteSheet,onDuplicateSheet:onDuplicateSheet,currentSheet:currentSheet,onActiveCellChange:onActiveCellChange,onActiveCellValueChange:onActiveCellValueChange,onFill:onFill,onDelete:onDelete,formatter:formatter,onResize:onResize,onScroll:onScroll,onKeyDown:onKeyDown,onPaste:onPaste,onCut:onCut,onInsertRow:onInsertRow,onInsertColumn:onInsertColumn,onDeleteColumn:onDeleteColumn,onDeleteRow:onDeleteRow,CellEditor:CellEditor,selectionPolicy:selectionPolicy,onSelectionChange:onSelectionChange,selectionMode:selectionMode,onChangeFilter:onChangeFilter,showTabStrip:showTabStrip,isTabEditable:isTabEditable,allowNewSheet:allowNewSheet,StatusBar:StatusBar,showStatusBar:showStatusBar,scale:scale=1,ContextMenu:ContextMenu,Tooltip:Tooltip,snap:snap}=props,{colorMode:colorMode}=core_1.useColorMode(),isLight="light"===colorMode,[containerRef,{width:width,height:height}]=react_use_measure_1.default({polyfill:resize_observer_1.ResizeObserver}),{cells:cells,activeCell:activeCell,selections:selections,scrollState:scrollState,columnSizes:columnSizes={},rowSizes:rowSizes={},mergedCells:mergedCells,frozenRows:frozenRows,frozenColumns:frozenColumns,hiddenColumns:hiddenColumns=constants_1.EMPTY_ARRAY,hiddenRows:hiddenRows=constants_1.EMPTY_ARRAY,showGridLines:showGridLines=!0,filterViews:filterViews,rowCount:rowCount=constants_1.DEFAULT_ROW_COUNT,columnCount:columnCount=constants_1.DEFAULT_COLUMN_COUNT}=currentSheet,selectedSheetRef=react_1.useRef(selectedSheet);react_1.useEffect(()=>{selectedSheetRef.current=selectedSheet});const handleChange=react_1.useCallback((value,cell)=>{grid_1.isNull(selectedSheetRef.current)||null==onChange||onChange(selectedSheetRef.current,value,cell)},[]),handleFill=react_1.useCallback((cell,currentSelection,selections)=>{null==onFill||onFill(selectedSheetRef.current,cell,currentSelection,selections)},[]),handleSheetChange=react_1.useCallback(args=>{grid_1.isNull(selectedSheetRef.current)||null==onSheetChange||onSheetChange(selectedSheetRef.current,args)},[]),handleScroll=react_1.useCallback(scrollState=>{grid_1.isNull(selectedSheetRef.current)||null==onScroll||onScroll(selectedSheetRef.current,scrollState)},[]),handleDelete=react_1.useCallback((activeCell,selections)=>{grid_1.isNull(selectedSheetRef.current)||null==onDelete||onDelete(selectedSheetRef.current,activeCell,selections)},[]),handleResize=react_1.useCallback((axis,index,dimension)=>{grid_1.isNull(selectedSheetRef.current)||null==onResize||onResize(selectedSheetRef.current,axis,index,dimension)},[]),handlePaste=react_1.useCallback((rows,activeCell)=>{null==onPaste||onPaste(selectedSheetRef.current,rows,activeCell)},[]),handleCut=react_1.useCallback(selection=>{null==onCut||onCut(selectedSheetRef.current,selection)},[]),handleInsertRow=react_1.useCallback((cell,selections)=>{null==onInsertRow||onInsertRow(selectedSheetRef.current,cell,selections)},[]),handleInsertColumn=react_1.useCallback((cell,selections)=>{null==onInsertColumn||onInsertColumn(selectedSheetRef.current,cell,selections)},[]),handleDeleteRow=react_1.useCallback((cell,selections)=>{null==onDeleteRow||onDeleteRow(selectedSheetRef.current,cell,selections)},[]),handleDeleteColumn=react_1.useCallback((cell,selections)=>{null==onDeleteColumn||onDeleteColumn(selectedSheetRef.current,cell,selections)},[]),handleActiveCellChange=react_1.useCallback((cell,value)=>{grid_1.isNull(selectedSheetRef.current)||null==onActiveCellChange||onActiveCellChange(selectedSheetRef.current,cell,value)},[]),handleSelectionChange=react_1.useCallback((cell,selections)=>{grid_1.isNull(selectedSheetRef.current)||null==onSelectionChange||onSelectionChange(selectedSheetRef.current,cell,selections)},[]),handleChangeFilter=react_1.useCallback((filterIndex,columnIndex,filter)=>{grid_1.isNull(selectedSheetRef.current)||null==onChangeFilter||onChangeFilter(selectedSheetRef.current,filterIndex,columnIndex,filter)},[]),handleKeyDown=react_1.useCallback((e,activeCell,selections)=>{grid_1.isNull(selectedSheetRef.current)||null==onKeyDown||onKeyDown(selectedSheetRef.current,e,activeCell,selections)},[currentSheet]);return react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.Flex,{flex:1,ref:containerRef,background:isLight?"white":constants_1.DARK_MODE_COLOR_LIGHT},react_1.default.createElement(Grid_1.default,{scale:scale,isLightMode:isLight,ref:forwardedRef,onResize:handleResize,onDelete:handleDelete,onActiveCellValueChange:onActiveCellValueChange,onActiveCellChange:handleActiveCellChange,onSelectionChange:handleSelectionChange,selectedSheet:selectedSheet,activeCell:activeCell,selections:selections,scrollState:scrollState,width:width,height:height,cells:cells,onChange:handleChange,onFill:handleFill,minColumnWidth:minColumnWidth,minRowHeight:minRowHeight,CellRenderer:CellRenderer,HeaderCellRenderer:HeaderCellRenderer,onSheetChange:handleSheetChange,onScroll:handleScroll,formatter:formatter,columnSizes:columnSizes,rowSizes:rowSizes,mergedCells:mergedCells,frozenRows:frozenRows,frozenColumns:frozenColumns,onKeyDown:handleKeyDown,hiddenRows:hiddenRows,hiddenColumns:hiddenColumns,onPaste:handlePaste,onCut:handleCut,onInsertRow:handleInsertRow,onInsertColumn:handleInsertColumn,onDeleteRow:handleDeleteRow,onDeleteColumn:handleDeleteColumn,theme:theme,rowCount:rowCount,columnCount:columnCount,showGridLines:showGridLines,CellEditor:CellEditor,selectionPolicy:selectionPolicy,selectionMode:selectionMode,filterViews:filterViews,onChangeFilter:handleChangeFilter,ContextMenu:ContextMenu,Tooltip:Tooltip,snap:snap})),showTabStrip||showStatusBar?react_1.default.createElement(core_1.Flex,null,react_1.default.createElement(styled_1.BottomPanel,{background:isLight?"#f1f3f4":theme.colors.gray[800],borderTopColor:isLight?"#e8eaed":null==theme?void 0:theme.colors.gray[600],borderTopWidth:1,borderTopStyle:"solid"},showTabStrip&&react_1.default.createElement(Tabs_1.default,{sheets:sheets,selectedSheet:selectedSheet,onNewSheet:onNewSheet,onSelect:onChangeSelectedSheet,onChangeSheetName:onChangeSheetName,onDeleteSheet:onDeleteSheet,onDuplicateSheet:onDuplicateSheet,isTabEditable:isTabEditable,allowNewSheet:allowNewSheet}),showStatusBar&&react_1.default.createElement(StatusBar,{selections:selections,cells:cells}))):null)}));exports.default=Workbook},410:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ARROW_ICON_PATH=exports.LIST_ICON_DIM=void 0;const react_1=__importStar(__webpack_require__(1)),react_konva_1=__webpack_require__(10);exports.LIST_ICON_DIM=16,exports.ARROW_ICON_PATH="M7 10l5 5 5-5z";exports.default=({x:x=0,y:y=0,width:width=0,height:height=0,rowIndex:rowIndex,columnIndex:columnIndex,onClick:onClick})=>{const[isHovered,setIsHovered]=react_1.useState(!1),padding=(height-exports.LIST_ICON_DIM)/2,posX=x+width-exports.LIST_ICON_DIM-2,posY=y+padding+.5,handleMouseEnter=react_1.useCallback(()=>{setIsHovered(!0)},[]),handleMouseLeave=react_1.useCallback(()=>{setIsHovered(!1)},[]);return react_1.default.createElement(react_konva_1.Group,{onClick:e=>{null==onClick||onClick({rowIndex:rowIndex,columnIndex:columnIndex})},onMouseEnter:handleMouseEnter,onMouseLeave:handleMouseLeave},react_1.default.createElement(react_konva_1.Rect,{x:posX,y:posY,width:exports.LIST_ICON_DIM,height:exports.LIST_ICON_DIM,fill:isHovered?"#808080":"transparent",cornerRadius:2}),react_1.default.createElement(react_konva_1.Path,{data:exports.ARROW_ICON_PATH,x:posX-1,y:posY-1,fill:isHovered?"white":"#808080",scaleY:.8,scaleX:.8,listening:!1}))}},411:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const Editor_1=__importDefault(__webpack_require__(412));exports.default=Editor_1.default},412:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(1)),grid_1=__webpack_require__(6),Text_1=__importDefault(__webpack_require__(940)),List_1=__importDefault(__webpack_require__(941)),core_1=__webpack_require__(33),constants_1=__webpack_require__(30);exports.default=props=>{const{rowIndex:rowIndex,columnIndex:columnIndex,onChange:onChange,onSubmit:onSubmit,onCancel:onCancel,position:position,cell:cell,nextFocusableCell:nextFocusableCell,value:value="",activeCell:activeCell,autoFocus:autoFocus=!0,background:background,color:color,fontSize:fontSize=12,fontFamily:fontFamily=constants_1.DEFAULT_FONT_FAMILY,wrap:cellWrap="nowrap",selections:selections,scrollPosition:scrollPosition,horizontalAlign:horizontalAlign,underline:underline,scale:scale=1,editorType:editorType="text",options:options,...rest}=props,wrapping="wrap"===cellWrap?"wrap":"nowrap",{colorMode:colorMode}=core_1.useColorMode(),isLight="light"===colorMode,backgroundColor=void 0!==background?background:isLight?"white":constants_1.DARK_MODE_COLOR_LIGHT,textColor=void 0!==color?color:isLight?constants_1.DARK_MODE_COLOR_LIGHT:"white",hasScrollPositionChanged=react_1.useRef(!1),isMounted=react_1.useRef(!1),textSizer=react_1.useRef(grid_1.AutoSizerCanvas()),{x:x=0,y:y=0,width:width=0,height:height=0}=position,getWidth=react_1.useCallback(text=>{var _a;textSizer.current.setFont({fontSize:fontSize,fontFamily:fontFamily});const textWidth=(null===(_a=textSizer.current.measureText(text))||void 0===_a?void 0:_a.width)||0;return Math.max(textWidth+10,width+1)},[width,fontSize,fontFamily,wrapping]);react_1.useEffect(()=>{setInputWidth(getWidth(value))},[value]);const[inputWidth,setInputWidth]=react_1.useState(()=>getWidth(value));react_1.useEffect(()=>{isMounted.current&&(hasScrollPositionChanged.current=!0)},[scrollPosition]),react_1.useEffect(()=>{isMounted.current=!0},[]);const address=react_1.useMemo(()=>hasScrollPositionChanged.current&&constants_1.cellToAddress(activeCell),[activeCell,hasScrollPositionChanged.current]),inputHeight=height,handleChange=react_1.useCallback(value=>{null==onChange||onChange(value,cell)},[cell]),handleSubmit=react_1.useCallback((value,direction)=>{const nextCell=direction&&nextFocusableCell(cell,direction);null==onSubmit||onSubmit(value,cell,nextCell)},[cell]),handleCancel=react_1.useCallback(()=>{null==onCancel||onCancel()},[cell]);return react_1.default.createElement("div",{style:{top:y,left:x,position:"absolute",width:inputWidth,height:inputHeight+1,padding:2,boxShadow:"0 2px 6px 2px rgba(60,64,67,.15)",border:"2px #1a73e8 solid",background:backgroundColor}},address?react_1.default.createElement("div",{style:{position:"absolute",left:-2,marginBottom:4,fontSize:12,lineHeight:"14px",padding:6,paddingTop:4,paddingBottom:4,boxShadow:"0px 1px 2px rgba(0,0,0,0.5)",bottom:"100%",background:"#4589eb",color:"white"}},address):null,"text"===editorType?react_1.default.createElement(Text_1.default,{value:value,fontFamily:fontFamily,fontSize:fontSize,scale:scale,color:textColor,wrapping:wrapping,horizontalAlign:horizontalAlign,underline:underline,onChange:handleChange,onSubmit:handleSubmit,onCancel:handleCancel}):null,"list"===editorType?react_1.default.createElement(List_1.default,{value:value,fontFamily:fontFamily,fontSize:fontSize,scale:scale,color:textColor,wrapping:wrapping,horizontalAlign:horizontalAlign,onChange:handleChange,onSubmit:handleSubmit,onCancel:handleCancel,options:options}):null)}},413:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||exports.hasOwnProperty(p)||__createBinding(exports,m,p)},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const Tooltip_1=__importDefault(__webpack_require__(414));exports.default=Tooltip_1.default,__exportStar(__webpack_require__(414),exports)},414:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importDefault(__webpack_require__(1)),constants_1=__webpack_require__(30),core_1=__webpack_require__(33),HyperLink=({title:title,url:url})=>react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.Box,{mb:1,fontWeight:"bold"},react_1.default.createElement(core_1.Link,{color:constants_1.HYPERLINK_COLOR,_hover:{color:constants_1.HYPERLINK_COLOR},href:url,target:"_blank"},title)),react_1.default.createElement(core_1.Box,{color:"#666"},url)),Alert=({title:title,content:content,variantColor:variantColor})=>react_1.default.createElement(react_1.default.Fragment,null,title&&react_1.default.createElement(core_1.Box,{pb:2,color:variantColor},react_1.default.createElement("strong",null,title)),content);exports.default=({x:x=0,y:y=0,width:width=0,position:position="right",scrollLeft:scrollLeft=0,scrollTop:scrollTop=0,height:height=0,valid:valid,variant:variant="info",content:content,datatype:datatype,hyperlink:hyperlink,text:text,onMouseEnter:onMouseEnter,onMouseLeave:onMouseLeave})=>{const title="invalid"===variant?"Invalid:":"error"===variant?"Error:":"",variantColor="invalid"===variant?constants_1.INVALID_COLOR:"error"===variant?constants_1.ERROR_COLOR:constants_1.INFO_COLOR,posX="right"===position?x+width-scrollLeft:x-scrollLeft,posY="bottom"===position?y+height-scrollTop:y-scrollTop;return react_1.default.createElement("div",{style:{position:"absolute",left:0,top:0,transform:`translate(${posX}px, ${posY}px)`,maxWidth:200,minWidth:160,background:"white",boxShadow:"0 4px 8px 3px rgba(60,64,67,.15)",padding:12,borderRadius:4,fontSize:13,borderLeft:`4px ${variantColor} solid`,backfaceVisibility:"hidden",userSelect:"none"},onMouseLeave:onMouseLeave,onMouseEnter:onMouseEnter},"hyperlink"===datatype?react_1.default.createElement(HyperLink,{title:text,url:hyperlink,variantColor:variantColor}):react_1.default.createElement(Alert,{title:title,content:content,variantColor:variantColor}))}},415:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.createStateReducer=exports.initialState=exports.ACTION_TYPE=exports.defaultSheets=exports.createCustomValidation=void 0;const immer_1=__importStar(__webpack_require__(953)),constants_1=__webpack_require__(30),grid_1=__webpack_require__(6),types_1=__webpack_require__(90);var ACTION_TYPE;immer_1.enablePatches(),exports.createCustomValidation=()=>({type:"custom"}),exports.defaultSheets=[{id:constants_1.uuid(),name:"Sheet1",frozenColumns:0,frozenRows:0,activeCell:{rowIndex:1,columnIndex:1},mergedCells:[],selections:[],cells:{},scrollState:{scrollTop:0,scrollLeft:0},filterViews:[]}],function(ACTION_TYPE){ACTION_TYPE.SELECT_SHEET="SELECT_SHEET",ACTION_TYPE.APPLY_PATCHES="APPLY_PATCHES",ACTION_TYPE.CHANGE_SHEET_NAME="CHANGE_SHEET_NAME",ACTION_TYPE.NEW_SHEET="NEW_SHEET",ACTION_TYPE.CHANGE_SHEET_CELL="CHANGE_SHEET_CELL",ACTION_TYPE.UPDATE_FILL="UPDATE_FILL",ACTION_TYPE.DELETE_SHEET="DELETE_SHEET",ACTION_TYPE.SHEET_SELECTION_CHANGE="SHEET_SELECTION_CHANGE",ACTION_TYPE.FORMATTING_CHANGE_AUTO="FORMATTING_CHANGE_AUTO",ACTION_TYPE.FORMATTING_CHANGE_PLAIN="FORMATTING_CHANGE_PLAIN",ACTION_TYPE.FORMATTING_CHANGE="FORMATTING_CHANGE",ACTION_TYPE.DELETE_CELLS="DELETE_CELLS",ACTION_TYPE.CLEAR_FORMATTING="CLEAR_FORMATTING",ACTION_TYPE.RESIZE="RESIZE",ACTION_TYPE.MERGE_CELLS="MERGE_CELLS",ACTION_TYPE.FROZEN_ROW_CHANGE="FROZEN_ROW_CHANGE",ACTION_TYPE.FROZEN_COLUMN_CHANGE="FROZEN_COLUMN_CHANGE",ACTION_TYPE.SET_BORDER="SET_BORDER",ACTION_TYPE.UPDATE_SCROLL="UPDATE_SCROLL",ACTION_TYPE.CHANGE_FILTER="CHANGE_FILTER",ACTION_TYPE.DELETE_COLUMN="DELETE_COLUMN",ACTION_TYPE.DELETE_ROW="DELETE_ROW",ACTION_TYPE.INSERT_COLUMN="INSERT_COLUMN",ACTION_TYPE.INSERT_ROW="INSERT_ROW",ACTION_TYPE.REMOVE_CELLS="REMOVE_CELLS",ACTION_TYPE.PASTE="PASTE",ACTION_TYPE.REPLACE_SHEETS="REPLACE_SHEETS",ACTION_TYPE.VALIDATION_SUCCESS="VALIDATION_SUCCESS"}(ACTION_TYPE=exports.ACTION_TYPE||(exports.ACTION_TYPE={})),exports.initialState={selectedSheet:0,sheets:exports.defaultSheets,currentActiveCell:null,currentSelections:null};const defaultStateReducer=state=>state;exports.createStateReducer=({addUndoPatch:addUndoPatch,getCellBounds:getCellBounds,stateReducer:stateReducer=defaultStateReducer})=>(state=exports.initialState,action)=>{const newState=immer_1.default(state,draft=>{var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t,_u,_v,_w,_x,_y,_z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_10,_11;switch(action.type){case ACTION_TYPE.SELECT_SHEET:draft.selectedSheet=action.id;break;case ACTION_TYPE.CHANGE_SHEET_NAME:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id);sheet&&(sheet.name=action.name);break}case ACTION_TYPE.NEW_SHEET:{const{sheet:sheet,index:index}=action;void 0===index?draft.sheets.push(action.sheet):draft.sheets.splice(index+1,0,sheet),draft.selectedSheet=action.sheet.id;break}case ACTION_TYPE.CHANGE_SHEET_CELL:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id);if(sheet){const{activeCell:activeCell,selections:selections}=sheet,{cell:cell,value:value,datatype:datatype}=action;sheet.cells[cell.rowIndex]=null!==(_a=sheet.cells[cell.rowIndex])&&void 0!==_a?_a:{},sheet.cells[cell.rowIndex][cell.columnIndex]=null!==(_b=sheet.cells[cell.rowIndex][cell.columnIndex])&&void 0!==_b?_b:{};const currentCell=sheet.cells[cell.rowIndex][cell.columnIndex];currentCell.text=value,currentCell.datatype=datatype,draft.currentActiveCell=activeCell,draft.currentSelections=selections}break}case ACTION_TYPE.VALIDATION_SUCCESS:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id);if(sheet){const{valid:valid,cell:cell,prompt:prompt}=action;sheet.cells[cell.rowIndex]=null!==(_c=sheet.cells[cell.rowIndex])&&void 0!==_c?_c:{},sheet.cells[cell.rowIndex][cell.columnIndex]=null!==(_d=sheet.cells[cell.rowIndex][cell.columnIndex])&&void 0!==_d?_d:{};const currentCell=sheet.cells[cell.rowIndex][cell.columnIndex];void 0!==valid&&(currentCell.valid=valid),void 0!==prompt&&(currentCell.dataValidation=null!==(_e=currentCell.dataValidation)&&void 0!==_e?_e:exports.createCustomValidation(),currentCell.dataValidation.prompt=prompt)}break}case ACTION_TYPE.UPDATE_FILL:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id);if(sheet){const{selections:selections}=sheet,{activeCell:activeCell,fillSelection:fillSelection}=action,{rowIndex:rowIndex,columnIndex:columnIndex}=activeCell,cellValue=null===(_f=sheet.cells[rowIndex])||void 0===_f?void 0:_f[columnIndex],{bounds:bounds}=fillSelection;for(let i=bounds.top;i<=bounds.bottom;i++){sheet.cells[i]=null!==(_g=sheet.cells[i])&&void 0!==_g?_g:{};for(let j=bounds.left;j<=bounds.right;j++)i===rowIndex&&j===columnIndex||(sheet.cells[i][j]=cellValue)}draft.currentActiveCell=activeCell,draft.currentSelections=selections}break}case ACTION_TYPE.DELETE_SHEET:{const{id:id}=action,index=draft.sheets.findIndex(sheet=>sheet.id===id),newSheets=draft.sheets.filter(sheet=>sheet.id!==id),newSelectedSheet=draft.selectedSheet===draft.sheets[index].id?newSheets[Math.max(0,index-1)].id:draft.selectedSheet;draft.selectedSheet=newSelectedSheet,draft.sheets.splice(index,1);break}case ACTION_TYPE.SHEET_SELECTION_CHANGE:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id);sheet&&(sheet.activeCell=action.activeCell,sheet.selections=action.selections);break}case ACTION_TYPE.FORMATTING_CHANGE_AUTO:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id),{selections:selections}=action;if(sheet)for(let i=0;i<selections.length;i++){const{bounds:bounds}=selections[i];if(bounds)for(let j=bounds.top;j<=bounds.bottom;j++)for(let k=bounds.left;k<=bounds.right;k++)null===(_j=null===(_h=sheet.cells[j])||void 0===_h?void 0:_h[k])||void 0===_j||delete _j.plaintext}break}case ACTION_TYPE.FORMATTING_CHANGE_PLAIN:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id),{selections:selections}=action;if(sheet)for(let i=0;i<selections.length;i++){const{bounds:bounds}=selections[i];if(bounds)for(let j=bounds.top;j<=bounds.bottom;j++){sheet.cells[j]=null!==(_k=sheet.cells[j])&&void 0!==_k?_k:{};for(let k=bounds.left;k<=bounds.right;k++)sheet.cells[j][k]=null!==(_l=sheet.cells[j][k])&&void 0!==_l?_l:{},sheet.cells[j][k].plaintext=!0}}break}case ACTION_TYPE.FORMATTING_CHANGE:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id),{key:key,value:value}=action;if(sheet){const{selections:selections,activeCell:activeCell}=sheet,sel=selections.length?selections:[{bounds:getCellBounds(activeCell)}];for(let i=0;i<sel.length;i++){const{bounds:bounds}=sel[i];if(bounds)for(let j=bounds.top;j<=bounds.bottom;j++){sheet.cells[j]=null!==(_m=sheet.cells[j])&&void 0!==_m?_m:{};for(let k=bounds.left;k<=bounds.right;k++)sheet.cells[j][k]=null!==(_o=sheet.cells[j][k])&&void 0!==_o?_o:{},sheet.cells[j][k][key]=value,key===types_1.FORMATTING_TYPE.CUSTOM_FORMAT&&(null===(_q=null===(_p=sheet.cells[j])||void 0===_p?void 0:_p[k])||void 0===_q||delete _q.plaintext)}}draft.currentActiveCell=activeCell,draft.currentSelections=selections}break}case ACTION_TYPE.DELETE_CELLS:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id);if(sheet){const{activeCell:activeCell,selections:selections}=action;if(selections.length)selections.forEach(sel=>{const{bounds:bounds}=sel;for(let i=bounds.top;i<=bounds.bottom;i++)if(void 0!==sheet.cells[i])for(let j=bounds.left;j<=bounds.right;j++)void 0!==sheet.cells[i][j]&&(sheet.cells[i][j].text="")});else if(activeCell){const{rowIndex:rowIndex,columnIndex:columnIndex}=activeCell;(null===(_s=null===(_r=sheet.cells)||void 0===_r?void 0:_r[rowIndex])||void 0===_s?void 0:_s[columnIndex])&&(sheet.cells[rowIndex][columnIndex].text="")}}break}case ACTION_TYPE.REMOVE_CELLS:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id);if(sheet){const{activeCell:activeCell,selections:selections}=action;if(selections.length)selections.forEach(sel=>{var _a,_b;const{bounds:bounds}=sel;for(let i=bounds.top;i<=bounds.bottom;i++)for(let j=bounds.left;j<=bounds.right;j++)null===(_b=null===(_a=sheet.cells)||void 0===_a?void 0:_a[i])||void 0===_b||delete _b[j]});else if(activeCell){const{rowIndex:rowIndex,columnIndex:columnIndex}=activeCell;null===(_u=null===(_t=sheet.cells)||void 0===_t?void 0:_t[rowIndex])||void 0===_u||delete _u[columnIndex]}}break}case ACTION_TYPE.CLEAR_FORMATTING:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id);if(sheet){const{activeCell:activeCell,selections:selections}=sheet;if(selections.length)selections.forEach(sel=>{const{bounds:bounds}=sel;for(let i=bounds.top;i<=bounds.bottom;i++)if(void 0!==sheet.cells[i])for(let j=bounds.left;j<=bounds.right;j++)void 0!==sheet.cells[i][j]&&(Object.values(types_1.FORMATTING_TYPE).forEach(key=>{var _a,_b;null===(_b=null===(_a=sheet.cells[i])||void 0===_a?void 0:_a[j])||void 0===_b||delete _b[key]}),Object.values(types_1.STROKE_FORMATTING).forEach(key=>{var _a,_b;null===(_b=null===(_a=sheet.cells[i])||void 0===_a?void 0:_a[j])||void 0===_b||delete _b[key]}))});else if(activeCell){const{rowIndex:rowIndex,columnIndex:columnIndex}=activeCell;(null===(_w=null===(_v=sheet.cells)||void 0===_v?void 0:_v[rowIndex])||void 0===_w?void 0:_w[columnIndex])&&(Object.values(types_1.FORMATTING_TYPE).forEach(key=>{var _a,_b;null===(_b=null===(_a=sheet.cells[rowIndex])||void 0===_a?void 0:_a[columnIndex])||void 0===_b||delete _b[key]}),Object.values(types_1.STROKE_FORMATTING).forEach(key=>{var _a,_b;null===(_b=null===(_a=sheet.cells[rowIndex])||void 0===_a?void 0:_a[columnIndex])||void 0===_b||delete _b[key]}))}}break}case ACTION_TYPE.RESIZE:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id);if(sheet){const{axis:axis,index:index,dimension:dimension}=action;axis===types_1.AXIS.X?("columnSizes"in sheet||(sheet.columnSizes={}),sheet.columnSizes&&(sheet.columnSizes[index]=dimension)):("rowSizes"in sheet||(sheet.rowSizes={}),sheet.rowSizes&&(sheet.rowSizes[index]=dimension))}break}case ACTION_TYPE.MERGE_CELLS:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id);if(sheet){const{selections:selections,activeCell:activeCell}=sheet,{bounds:bounds}=selections.length?selections[selections.length-1]:{bounds:getCellBounds(activeCell)};if(!bounds)return;if(bounds.top===bounds.bottom&&bounds.left===bounds.right||0===bounds.top||0===bounds.left)return;sheet.mergedCells=null!==(_x=sheet.mergedCells)&&void 0!==_x?_x:[];const index=sheet.mergedCells.findIndex(area=>area.left===bounds.left&&area.right===bounds.right&&area.top===bounds.top&&area.bottom===bounds.bottom);if(-1!==index)return void sheet.mergedCells.splice(index,1);sheet.mergedCells.push(bounds)}break}case ACTION_TYPE.FROZEN_ROW_CHANGE:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id);sheet&&(sheet.frozenRows=action.count);break}case ACTION_TYPE.FROZEN_COLUMN_CHANGE:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id);sheet&&(sheet.frozenColumns=action.count);break}case ACTION_TYPE.SET_BORDER:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id);if(sheet){const{color:color,variant:variant,borderStyle:borderStyle}=action,{selections:selections,cells:cells,activeCell:activeCell}=sheet,sel=selections.length?selections:grid_1.selectionFromActiveCell(activeCell),boundedCells=constants_1.cellsInSelectionVariant(sel,variant,borderStyle,color,getCellBounds);for(const row in boundedCells)for(const col in boundedCells[row])if(variant===types_1.BORDER_VARIANT.NONE)Object.values(types_1.STROKE_FORMATTING).forEach(key=>{var _a,_b;null===(_b=null===(_a=sheet.cells[row])||void 0===_a?void 0:_a[col])||void 0===_b||delete _b[key]});else{const styles=boundedCells[row][col];Object.keys(styles).forEach(key=>{var _a,_b;sheet.cells[row]=null!==(_a=cells[row])&&void 0!==_a?_a:{},sheet.cells[row][col]=null!==(_b=cells[row][col])&&void 0!==_b?_b:{},sheet.cells[row][col][key]=styles[key]})}}break}case ACTION_TYPE.UPDATE_SCROLL:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id);sheet&&(sheet.scrollState=action.scrollState);break}case ACTION_TYPE.CHANGE_FILTER:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id);if(sheet){const{columnIndex:columnIndex,filterViewIndex:filterViewIndex,filter:filter}=action;void 0===filter?null===(_0=null===(_z=null===(_y=null==sheet?void 0:sheet.filterViews)||void 0===_y?void 0:_y[filterViewIndex])||void 0===_z?void 0:_z.filters)||void 0===_0||delete _0[columnIndex]:(sheet.filterViews=null!==(_1=sheet.filterViews)&&void 0!==_1?_1:[],sheet.filterViews[filterViewIndex].filters?sheet.filterViews[filterViewIndex].filters[columnIndex]=filter:sheet.filterViews[filterViewIndex].filters={[columnIndex]:filter})}break}case ACTION_TYPE.DELETE_COLUMN:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id);if(sheet){const{activeCell:activeCell}=action,{columnIndex:columnIndex}=activeCell,{cells:cells}=sheet,changes={};for(const row in cells){const maxCol=Math.max(...Object.keys(null!==(_2=cells[row])&&void 0!==_2?_2:{}).map(Number));changes[row]=null!==(_3=changes[row])&&void 0!==_3?_3:{};for(let i=columnIndex;i<=maxCol;i++)changes[row][i]=null!==(_4=changes[row][i])&&void 0!==_4?_4:{},changes[row][i]=null===(_5=cells[row])||void 0===_5?void 0:_5[i+1]}for(const row in changes)for(const col in changes[row])cells[row][col]=changes[row][col]}break}case ACTION_TYPE.DELETE_ROW:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id);if(sheet){const{activeCell:activeCell}=action,{rowIndex:rowIndex}=activeCell,{cells:cells}=sheet,maxRow=Math.max(...Object.keys(cells).map(Number)),changes={};for(let i=rowIndex;i<=maxRow;i++)changes[i]=cells[i+1];for(const index in changes)cells[index]=changes[index]}break}case ACTION_TYPE.INSERT_COLUMN:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id);if(sheet){const{activeCell:activeCell}=action,{columnIndex:columnIndex}=activeCell,{cells:cells}=sheet,changes={};for(const row in cells){const maxCol=Math.max(...Object.keys(null!==(_6=cells[row])&&void 0!==_6?_6:{}).map(Number));changes[row]=null!==(_7=changes[row])&&void 0!==_7?_7:{};for(let i=columnIndex;i<=maxCol;i++)changes[row][i]=null!==(_8=changes[row][i])&&void 0!==_8?_8:{},changes[row][i+1]=null===(_9=cells[row])||void 0===_9?void 0:_9[i]}for(const row in changes)for(const col in changes[row])cells[row][col]=changes[row][col]}break}case ACTION_TYPE.INSERT_ROW:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id);if(sheet){const{activeCell:activeCell}=action,{rowIndex:rowIndex}=activeCell,{cells:cells}=sheet,maxRow=Math.max(...Object.keys(cells).map(Number)),changes={};for(let i=rowIndex;i<=maxRow;i++)changes[i+1]=cells[i];for(const index in changes)cells[index]=changes[index];delete cells[rowIndex]}break}case ACTION_TYPE.PASTE:{const sheet=draft.sheets.find(sheet=>sheet.id===action.id);if(sheet){const{selections:selections}=sheet,{rows:rows,activeCell:activeCell}=action,{rowIndex:rowIndex,columnIndex:columnIndex}=activeCell,{cells:cells}=sheet;for(let i=0;i<rows.length;i++){const row=rows[i],r=rowIndex+i;cells[r]=null!==(_10=cells[r])&&void 0!==_10?_10:{};for(let j=0;j<row.length;j++){const text=row[j],c=columnIndex+j;cells[r][c]=null!==(_11=cells[r][c])&&void 0!==_11?_11:{},cells[r][c].text=null===text||grid_1.isNull(text)?"":text}}draft.currentActiveCell=activeCell}break}case ACTION_TYPE.REPLACE_SHEETS:draft.sheets=action.sheets,draft.selectedSheet=action.sheets[0].id;break;case ACTION_TYPE.APPLY_PATCHES:return immer_1.applyPatches(state,action.patches)}},(patches,inversePatches)=>{const{undoable:undoable=!0}=action;!1!==undoable&&requestAnimationFrame(()=>addUndoPatch({patches:patches,inversePatches:inversePatches}))});return stateReducer(newState,action)}},416:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.validate=void 0;const constants_1=__webpack_require__(30);exports.validate=async(value,id,cell,cellConfig)=>{var _a,_b,_c;let valid=!0;switch(null===(_a=null==cellConfig?void 0:cellConfig.dataValidation)||void 0===_a?void 0:_a.type){case"list":{const validList=null===(_b=null==cellConfig?void 0:cellConfig.dataValidation)||void 0===_b?void 0:_b.formulae;return validList?(valid=null==validList?void 0:validList.includes(value),{valid:valid}):(valid=!1,{valid:valid})}case"boolean":{const validList=null===(_c=null==cellConfig?void 0:cellConfig.dataValidation)||void 0===_c?void 0:_c.formulae;return validList?(valid=null==validList?void 0:validList.includes(value),{valid:valid}):(valid=!1,{valid:valid})}case"decimal":{const{operator:operator,formulae:formulae}=cellConfig.dataValidation;if("number"!==constants_1.detectDataType(value))return{valid:!1};let valid=!0;const num=parseFloat(value);switch(operator){case"notBetween":case"between":const[from,to]=formulae,isBetween=num>=from&&num<=to;valid="between"===operator?isBetween:!isBetween;break;case"equal":valid=num===(null==formulae?void 0:formulae[0]);break;case"notEqual":valid=num!==(null==formulae?void 0:formulae[0]);break;case"greaterThan":case"lessThan":valid=num>(null==formulae?void 0:formulae[0]);break;case"greaterThanOrEqual":valid=num>=(null==formulae?void 0:formulae[0]);break;case"lessThanOrEqual":valid=num<=(null==formulae?void 0:formulae[0])}return{valid:valid}}default:return{valid:valid}}},exports.default=exports.validate},42:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||exports.hasOwnProperty(p)||__createBinding(exports,m,p)},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.validate=exports.defaultSheets=exports.DefaultCell=exports.DefaultEditor=void 0;const Spreadsheet_1=__importStar(__webpack_require__(390));Object.defineProperty(exports,"defaultSheets",{enumerable:!0,get:function(){return Spreadsheet_1.defaultSheets}});const Editor_1=__importDefault(__webpack_require__(411));exports.DefaultEditor=Editor_1.default;const Cell_1=__importDefault(__webpack_require__(253));exports.DefaultCell=Cell_1.default;const validation_1=__importDefault(__webpack_require__(416));exports.validate=validation_1.default,__exportStar(__webpack_require__(390),exports),exports.default=Spreadsheet_1.default,__exportStar(__webpack_require__(30),exports),__exportStar(__webpack_require__(90),exports),__exportStar(__webpack_require__(415),exports),__exportStar(__webpack_require__(253),exports)},428:function(module,exports,__webpack_require__){__webpack_require__(429),__webpack_require__(579),__webpack_require__(580),module.exports=__webpack_require__(743)},495:function(module,exports){},580:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(255),__webpack_require__(172)},6:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||exports.hasOwnProperty(p)||__createBinding(exports,m,p)},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.CellOverlayRenderer=exports.useFilter=exports.useTouch=exports.useUndo=exports.usePagination=exports.useCopyPaste=exports.useSizer=exports.useTooltip=exports.useSelection=exports.useEditable=exports.CellOverlay=exports.Cell=exports.CellRenderer=exports.Grid=void 0;const Grid_1=__importDefault(__webpack_require__(370));exports.Grid=Grid_1.default;const Cell_1=__webpack_require__(378);Object.defineProperty(exports,"CellRenderer",{enumerable:!0,get:function(){return Cell_1.CellRenderer}}),Object.defineProperty(exports,"Cell",{enumerable:!0,get:function(){return Cell_1.Cell}});const CellOverlay_1=__webpack_require__(383);Object.defineProperty(exports,"CellOverlay",{enumerable:!0,get:function(){return CellOverlay_1.CellOverlay}}),Object.defineProperty(exports,"CellOverlayRenderer",{enumerable:!0,get:function(){return CellOverlay_1.CellRenderer}});const useEditable_1=__importDefault(__webpack_require__(385));exports.useEditable=useEditable_1.default;const useSelection_1=__importDefault(__webpack_require__(792));exports.useSelection=useSelection_1.default;const useTooltip_1=__importDefault(__webpack_require__(386));exports.useTooltip=useTooltip_1.default;const useSizer_1=__importDefault(__webpack_require__(793));exports.useSizer=useSizer_1.default;const useTouch_1=__importDefault(__webpack_require__(794));exports.useTouch=useTouch_1.default;const useCopyPaste_1=__importDefault(__webpack_require__(797));exports.useCopyPaste=useCopyPaste_1.default;const useUndo_1=__importDefault(__webpack_require__(388));exports.useUndo=useUndo_1.default;const usePagination_1=__importDefault(__webpack_require__(798));exports.usePagination=usePagination_1.default;const useFilter_1=__importDefault(__webpack_require__(389));exports.useFilter=useFilter_1.default,exports.default=Grid_1.default,__exportStar(__webpack_require__(370),exports),__exportStar(__webpack_require__(61),exports),__exportStar(__webpack_require__(389),exports),__exportStar(__webpack_require__(388),exports),__exportStar(__webpack_require__(386),exports),__exportStar(__webpack_require__(385),exports),__exportStar(__webpack_require__(62),exports)},61:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.clampIndex=exports.isEqualCells=exports.isNull=exports.AutoSizerCanvas=exports.canUseDOM=exports.extendAreaToMergedCells=exports.areaIntersects=exports.findNextCellWithinBounds=exports.prepareClipboardData=exports.numberToAlphabet=exports.selectionFromActiveCell=exports.requestTimeout=exports.cancelTimeout=exports.getOffsetForRowAndAlignment=exports.getOffsetForColumnAndAlignment=exports.getOffsetForIndexAndAlignment=exports.rafThrottle=exports.debounce=exports.throttle=exports.cellIdentifier=exports.getEstimatedTotalWidth=exports.getEstimatedTotalHeight=exports.getItemMetadata=exports.getColumnWidth=exports.getRowHeight=exports.getColumnOffset=exports.getRowOffset=exports.itemKey=exports.getBoundedCells=exports.getColumnStopIndexForStartIndex=exports.getColumnStartIndexForOffset=exports.getRowStopIndexForStartIndex=exports.getRowStartIndexForOffset=exports.ItemType=exports.Align=void 0;const types_1=__webpack_require__(62);var Align,ItemType;!function(Align){Align.start="start",Align.end="end",Align.center="center",Align.auto="auto",Align.smart="smart"}(Align=exports.Align||(exports.Align={})),function(ItemType){ItemType.row="row",ItemType.column="column"}(ItemType=exports.ItemType||(exports.ItemType={})),exports.getRowStartIndexForOffset=({rowHeight:rowHeight,columnWidth:columnWidth,rowCount:rowCount,columnCount:columnCount,instanceProps:instanceProps,offset:offset,scale:scale})=>findNearestItem({itemType:ItemType.row,rowHeight:rowHeight,columnWidth:columnWidth,rowCount:rowCount,columnCount:columnCount,instanceProps:instanceProps,offset:offset,scale:scale}),exports.getRowStopIndexForStartIndex=({startIndex:startIndex,rowCount:rowCount,rowHeight:rowHeight,columnWidth:columnWidth,scrollTop:scrollTop,containerHeight:containerHeight,instanceProps:instanceProps,scale:scale})=>{const itemMetadata=exports.getItemMetadata({itemType:ItemType.row,rowHeight:rowHeight,columnWidth:columnWidth,index:startIndex,instanceProps:instanceProps,scale:scale}),maxOffset=scrollTop+containerHeight;let offset=itemMetadata.offset+itemMetadata.size,stopIndex=startIndex;for(;stopIndex<rowCount-1&&offset<maxOffset;)stopIndex++,offset+=exports.getItemMetadata({itemType:ItemType.row,rowHeight:rowHeight,columnWidth:columnWidth,index:stopIndex,instanceProps:instanceProps,scale:scale}).size;return stopIndex},exports.getColumnStartIndexForOffset=({rowHeight:rowHeight,columnWidth:columnWidth,rowCount:rowCount,columnCount:columnCount,instanceProps:instanceProps,offset:offset,scale:scale})=>findNearestItem({itemType:ItemType.column,rowHeight:rowHeight,columnWidth:columnWidth,rowCount:rowCount,columnCount:columnCount,instanceProps:instanceProps,offset:offset,scale:scale}),exports.getColumnStopIndexForStartIndex=({startIndex:startIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps,containerWidth:containerWidth,scrollLeft:scrollLeft,columnCount:columnCount,scale:scale})=>{const itemMetadata=exports.getItemMetadata({itemType:ItemType.column,index:startIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps,scale:scale}),maxOffset=scrollLeft+containerWidth;let offset=itemMetadata.offset+itemMetadata.size,stopIndex=startIndex;for(;stopIndex<columnCount-1&&offset<maxOffset;)stopIndex++,offset+=exports.getItemMetadata({itemType:ItemType.column,rowHeight:rowHeight,columnWidth:columnWidth,index:stopIndex,instanceProps:instanceProps,scale:scale}).size;return stopIndex},exports.getBoundedCells=area=>{const cells=new Set;if(!area)return cells;const{top:top,bottom:bottom,left:left,right:right}=area;for(let i=top;i<=bottom;i++)for(let j=left;j<=right;j++)cells.add(exports.cellIdentifier(i,j));return cells},exports.itemKey=({rowIndex:rowIndex,columnIndex:columnIndex})=>`${rowIndex}:${columnIndex}`,exports.getRowOffset=({index:index,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps,scale:scale})=>exports.getItemMetadata({itemType:ItemType.row,index:index,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps,scale:scale}).offset,exports.getColumnOffset=({index:index,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps,scale:scale})=>exports.getItemMetadata({itemType:ItemType.column,index:index,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps,scale:scale}).offset,exports.getRowHeight=(index,instanceProps)=>instanceProps.rowMetadataMap[index].size,exports.getColumnWidth=(index,instanceProps)=>instanceProps.columnMetadataMap[index].size,exports.getItemMetadata=({itemType:itemType,index:index,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps,scale:scale=2})=>{var _a;let itemMetadataMap,itemSize,lastMeasuredIndex,recalcIndices;"column"===itemType?(itemMetadataMap=instanceProps.columnMetadataMap,itemSize=columnWidth,lastMeasuredIndex=instanceProps.lastMeasuredColumnIndex,recalcIndices=instanceProps.recalcColumnIndices):(itemMetadataMap=instanceProps.rowMetadataMap,itemSize=rowHeight,lastMeasuredIndex=instanceProps.lastMeasuredRowIndex,recalcIndices=instanceProps.recalcRowIndices);const recalcWithinBoundsOnly=recalcIndices.length>0;if(index>lastMeasuredIndex){let offset=0;if(lastMeasuredIndex>=0){const itemMetadata=itemMetadataMap[lastMeasuredIndex];offset=itemMetadata.offset+itemMetadata.size}for(let i=lastMeasuredIndex+1;i<=index;i++){let size=recalcWithinBoundsOnly?recalcIndices.includes(i)?itemSize(i):(null===(_a=itemMetadataMap[i])||void 0===_a?void 0:_a.size)||itemSize(i)*scale:itemSize(i)*scale;itemMetadataMap[i]={offset:offset,size:size},offset+=size}"column"===itemType?instanceProps.lastMeasuredColumnIndex=index:instanceProps.lastMeasuredRowIndex=index}return itemMetadataMap[index]};const findNearestItem=({itemType:itemType,rowHeight:rowHeight,columnWidth:columnWidth,rowCount:rowCount,columnCount:columnCount,instanceProps:instanceProps,offset:offset,scale:scale})=>{let itemMetadataMap,lastMeasuredIndex;"column"===itemType?(itemMetadataMap=instanceProps.columnMetadataMap,lastMeasuredIndex=instanceProps.lastMeasuredColumnIndex):(itemMetadataMap=instanceProps.rowMetadataMap,lastMeasuredIndex=instanceProps.lastMeasuredRowIndex);return(lastMeasuredIndex>0?itemMetadataMap[lastMeasuredIndex].offset:0)>=offset?findNearestItemBinarySearch({itemType:itemType,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps,high:lastMeasuredIndex,low:0,offset:offset,scale:scale}):findNearestItemExponentialSearch({itemType:itemType,rowHeight:rowHeight,rowCount:rowCount,columnCount:columnCount,columnWidth:columnWidth,instanceProps:instanceProps,index:Math.max(0,lastMeasuredIndex),offset:offset,scale:scale})},findNearestItemBinarySearch=({itemType:itemType,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps,high:high,low:low,offset:offset,scale:scale})=>{for(;low<=high;){const middle=low+Math.floor((high-low)/2),currentOffset=exports.getItemMetadata({itemType:itemType,rowHeight:rowHeight,columnWidth:columnWidth,index:middle,instanceProps:instanceProps,scale:scale}).offset;if(currentOffset===offset)return middle;currentOffset<offset?low=middle+1:currentOffset>offset&&(high=middle-1)}return low>0?low-1:0},findNearestItemExponentialSearch=({itemType:itemType,rowHeight:rowHeight,columnWidth:columnWidth,rowCount:rowCount,columnCount:columnCount,instanceProps:instanceProps,index:index,offset:offset,scale:scale})=>{const itemCount="column"===itemType?columnCount:rowCount;let interval=1;for(;index<itemCount&&exports.getItemMetadata({itemType:itemType,rowHeight:rowHeight,columnWidth:columnWidth,index:index,instanceProps:instanceProps,scale:scale}).offset<offset;)index+=interval,interval*=2;return findNearestItemBinarySearch({itemType:itemType,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps,high:Math.min(index,itemCount-1),low:Math.floor(index/2),offset:offset,scale:scale})};exports.getEstimatedTotalHeight=(rowCount,instanceProps)=>{const{estimatedRowHeight:estimatedRowHeight}=instanceProps;let totalSizeOfMeasuredRows=0,{lastMeasuredRowIndex:lastMeasuredRowIndex,rowMetadataMap:rowMetadataMap}=instanceProps;if(lastMeasuredRowIndex>=rowCount&&(lastMeasuredRowIndex=rowCount-1),lastMeasuredRowIndex>=0){const itemMetadata=rowMetadataMap[lastMeasuredRowIndex];totalSizeOfMeasuredRows=itemMetadata.offset+itemMetadata.size}return totalSizeOfMeasuredRows+(rowCount-lastMeasuredRowIndex-1)*estimatedRowHeight},exports.getEstimatedTotalWidth=(columnCount,instanceProps)=>{const{estimatedColumnWidth:estimatedColumnWidth}=instanceProps;let totalSizeOfMeasuredRows=0,{lastMeasuredColumnIndex:lastMeasuredColumnIndex,columnMetadataMap:columnMetadataMap}=instanceProps;if(lastMeasuredColumnIndex>=columnCount&&(lastMeasuredColumnIndex=columnCount-1),lastMeasuredColumnIndex>=0){const itemMetadata=columnMetadataMap[lastMeasuredColumnIndex];totalSizeOfMeasuredRows=itemMetadata.offset+itemMetadata.size}return totalSizeOfMeasuredRows+(columnCount-lastMeasuredColumnIndex-1)*estimatedColumnWidth},exports.cellIdentifier=(rowIndex,columnIndex)=>`${rowIndex},${columnIndex}`,exports.throttle=function throttle(func,limit){var lastEventTimestamp=null;return(...args)=>{const now=Date.now();(!lastEventTimestamp||now-lastEventTimestamp>=limit)&&(lastEventTimestamp=now,func(...args))}},exports.debounce=function debounce(cb,wait=300){let h=0;return(...args)=>{clearTimeout(h),h=window.setTimeout(()=>cb(...args),wait)}},exports.rafThrottle=function rafThrottle(callback){var evt,active=!1,handler=function(){active=!1,callback(evt)};return function handleEvent(e){(evt=e)&&evt.persist&&evt.persist(),active||(active=!0,requestAnimationFrame(handler))}},exports.getOffsetForIndexAndAlignment=({itemType:itemType,containerHeight:containerHeight,containerWidth:containerWidth,rowHeight:rowHeight,columnWidth:columnWidth,columnCount:columnCount,rowCount:rowCount,index:index,align:align=Align.smart,scrollOffset:scrollOffset,instanceProps:instanceProps,scrollbarSize:scrollbarSize,frozenOffset:frozenOffset=0,scale:scale})=>{const size="column"===itemType?containerWidth:containerHeight,itemMetadata=exports.getItemMetadata({itemType:itemType,rowHeight:rowHeight,columnWidth:columnWidth,index:index,instanceProps:instanceProps,scale:scale}),estimatedTotalSize="column"===itemType?exports.getEstimatedTotalWidth(columnCount,instanceProps):exports.getEstimatedTotalHeight(rowCount,instanceProps),maxOffset=Math.max(0,Math.min(estimatedTotalSize-size,itemMetadata.offset-frozenOffset)),minOffset=Math.max(0,itemMetadata.offset-size+scrollbarSize+itemMetadata.size);switch(align===Align.smart&&(align=scrollOffset>=minOffset-size&&scrollOffset<=maxOffset+size?Align.auto:Align.center),align){case Align.start:return maxOffset;case Align.end:return minOffset;case Align.center:return Math.round(minOffset+(maxOffset-minOffset)/2);case Align.auto:default:return scrollOffset>=minOffset&&scrollOffset<=maxOffset?scrollOffset:minOffset>maxOffset||scrollOffset<minOffset?minOffset:maxOffset}},exports.getOffsetForColumnAndAlignment=props=>exports.getOffsetForIndexAndAlignment({itemType:ItemType.column,...props}),exports.getOffsetForRowAndAlignment=props=>exports.getOffsetForIndexAndAlignment({itemType:ItemType.row,...props});const now="object"==typeof performance&&"function"==typeof performance.now?()=>performance.now():()=>Date.now();exports.cancelTimeout=function cancelTimeout(timeoutID){cancelAnimationFrame(timeoutID.id)},exports.requestTimeout=function requestTimeout(callback,delay){const start=now(),timeoutID={id:requestAnimationFrame((function tick(){now()-start>=delay?callback.call(null):timeoutID.id=requestAnimationFrame(tick)}))};return timeoutID},exports.selectionFromActiveCell=activeCell=>activeCell?[{bounds:{top:activeCell.rowIndex,left:activeCell.columnIndex,bottom:activeCell.rowIndex,right:activeCell.columnIndex}}]:[],exports.numberToAlphabet=i=>((i>=26?exports.numberToAlphabet((i/26>>0)-1):"")+"abcdefghijklmnopqrstuvwxyz"[i%26>>0]).toUpperCase(),exports.prepareClipboardData=rows=>{const html=["<table>"],csv=[];return rows.forEach(row=>{html.push("<tr>");const csvRow=[];row.forEach(cell=>{html.push(`<td>${cell}</td>`),csvRow.push(`"${cell.replace(/"/g,'""')}"`)}),csv.push(csvRow.join(",")),html.push("</tr>")}),html.push("</table>"),[html.join(""),csv.join("\n")]},exports.findNextCellWithinBounds=(activeCellBounds,selectionBounds,direction=types_1.Direction.Right)=>{let rowIndex,columnIndex,nextActiveCell=null;return direction===types_1.Direction.Right&&(rowIndex=activeCellBounds.top,columnIndex=activeCellBounds.left+1,columnIndex>selectionBounds.right&&(rowIndex+=1,columnIndex=selectionBounds.left,rowIndex>selectionBounds.bottom&&(rowIndex=selectionBounds.top)),nextActiveCell={rowIndex:rowIndex,columnIndex:columnIndex}),direction===types_1.Direction.Left&&(rowIndex=activeCellBounds.bottom,columnIndex=activeCellBounds.left-1,columnIndex<selectionBounds.left&&(rowIndex-=1,columnIndex=selectionBounds.right,rowIndex<selectionBounds.top&&(rowIndex=selectionBounds.bottom)),nextActiveCell={rowIndex:rowIndex,columnIndex:columnIndex}),direction===types_1.Direction.Down&&(rowIndex=activeCellBounds.bottom+1,columnIndex=activeCellBounds.left,rowIndex>selectionBounds.bottom&&(columnIndex=activeCellBounds.left+1,rowIndex=selectionBounds.top,columnIndex>selectionBounds.right&&(columnIndex=selectionBounds.left)),nextActiveCell={rowIndex:rowIndex,columnIndex:columnIndex}),direction===types_1.Direction.Up&&(rowIndex=activeCellBounds.top-1,columnIndex=activeCellBounds.left,rowIndex<selectionBounds.top&&(columnIndex=activeCellBounds.left-1,rowIndex=selectionBounds.bottom,columnIndex<selectionBounds.left&&(columnIndex=selectionBounds.right)),nextActiveCell={rowIndex:rowIndex,columnIndex:columnIndex}),nextActiveCell},exports.areaIntersects=(area1,area2)=>!(area1.left>area2.right||area2.left>area1.right)&&!(area1.top>area2.bottom||area2.top>area1.bottom),exports.extendAreaToMergedCells=(_area,mergedCells)=>{const area={..._area};for(const bounds of mergedCells)exports.areaIntersects(area,bounds)&&(area.top=Math.min(area.top,bounds.top),area.bottom=Math.max(area.bottom,bounds.bottom),area.right=Math.max(area.right,bounds.right),area.left=Math.min(area.left,bounds.left));return area},exports.canUseDOM=!("undefined"==typeof window||!window.document||!window.document.createElement),exports.AutoSizerCanvas=(defaults={})=>{const{fontFamily:fontFamily="Arial",fontSize:fontSize=12,fontWeight:fontWeight="normal",fontStyle:fontStyle=""}=defaults;var o={fontFamily:fontFamily,fontSize:fontSize,fontWeight:fontWeight,fontStyle:fontStyle};const canvas=exports.canUseDOM&&document.createElement("canvas"),context=canvas?canvas.getContext("2d"):null,setFont=(options={})=>{var _a;for(const key in options)o[key]=null!==(_a=options[key])&&void 0!==_a?_a:o[key];context&&(context.font=`${o.fontStyle} ${o.fontWeight} ${o.fontSize}px ${o.fontFamily}`)};return setFont(o),{context:context,measureText:text=>null==context?void 0:context.measureText(text),setFont:setFont,reset:()=>setFont(defaults)}},exports.isNull=value=>null==value||""===value,exports.isEqualCells=(a,b)=>!exports.isNull(a)&&!exports.isNull(b)&&null!==a&&null!==b&&(a.rowIndex===b.rowIndex&&a.columnIndex===b.columnIndex),exports.clampIndex=(index,isHidden,direction)=>{switch(direction){case types_1.Direction.Right:case types_1.Direction.Down:let hidden=null==isHidden?void 0:isHidden(index);for(;!0===hidden;)hidden=null==isHidden?void 0:isHidden(++index);break;case types_1.Direction.Left:case types_1.Direction.Up:{let hidden=null==isHidden?void 0:isHidden(index);for(;!0===hidden;)hidden=null==isHidden?void 0:isHidden(--index);break}}return index}},62:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MouseButtonCodes=exports.MimeType=exports.Direction=exports.KeyCodes=void 0,function(KeyCodes){KeyCodes[KeyCodes.Right=39]="Right",KeyCodes[KeyCodes.Left=37]="Left",KeyCodes[KeyCodes.Up=38]="Up",KeyCodes[KeyCodes.Down=40]="Down",KeyCodes[KeyCodes.Escape=27]="Escape",KeyCodes[KeyCodes.Tab=9]="Tab",KeyCodes[KeyCodes.Meta=91]="Meta",KeyCodes[KeyCodes.Delete=9]="Delete",KeyCodes[KeyCodes.BackSpace=8]="BackSpace",KeyCodes[KeyCodes.Enter=13]="Enter",KeyCodes[KeyCodes.A=65]="A",KeyCodes[KeyCodes.SPACE=32]="SPACE",KeyCodes[KeyCodes.ALT=18]="ALT",KeyCodes[KeyCodes.C=67]="C",KeyCodes[KeyCodes.Home=36]="Home",KeyCodes[KeyCodes.End=35]="End",KeyCodes[KeyCodes.PageDown=34]="PageDown",KeyCodes[KeyCodes.PageUp=33]="PageUp",KeyCodes[KeyCodes.Z=90]="Z",KeyCodes[KeyCodes.CapsLock=20]="CapsLock",KeyCodes[KeyCodes.KEY_B=66]="KEY_B",KeyCodes[KeyCodes.KEY_I=73]="KEY_I",KeyCodes[KeyCodes.KEY_U=85]="KEY_U",KeyCodes[KeyCodes.KEY_X=88]="KEY_X",KeyCodes[KeyCodes.KEY_L=76]="KEY_L",KeyCodes[KeyCodes.KEY_E=69]="KEY_E",KeyCodes[KeyCodes.KEY_R=82]="KEY_R",KeyCodes[KeyCodes.BACK_SLASH=220]="BACK_SLASH",KeyCodes[KeyCodes.KEY_Y=89]="KEY_Y"}(exports.KeyCodes||(exports.KeyCodes={})),function(Direction){Direction.Up="UP",Direction.Down="DOWN",Direction.Left="LEFT",Direction.Right="RIGHT"}(exports.Direction||(exports.Direction={})),function(MimeType){MimeType.html="text/html",MimeType.csv="text/csv",MimeType.plain="text/plain",MimeType.json="application/json"}(exports.MimeType||(exports.MimeType={})),function(MouseButtonCodes){MouseButtonCodes[MouseButtonCodes.left=1]="left",MouseButtonCodes[MouseButtonCodes.middle=2]="middle",MouseButtonCodes[MouseButtonCodes.right=3]="right"}(exports.MouseButtonCodes||(exports.MouseButtonCodes={}))},743:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _storybook_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(255);module._StorybookPreserveDecorators=!0,Object(_storybook_react__WEBPACK_IMPORTED_MODULE_0__.configure)([__webpack_require__(744)],module)}.call(this,__webpack_require__(369)(module))},744:function(module,exports,__webpack_require__){var map={"./Grid.stories.tsx":745,"./copypaste.stories.tsx":799,"./overlay.stories.tsx":800,"./pagination.stories.tsx":801,"./spreadsheet.stories.tsx":802,"./styling.stories.tsx":959,"./theme.stories.tsx":960,"./ticking.stories.tsx":961,"./touch.stories.tsx":962,"./treetable.stories.tsx":963,"./undo.stories.tsx":964};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=744},745:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"BaseGrid",(function(){return BaseGrid})),__webpack_require__.d(__webpack_exports__,"BaseGridSnap",(function(){return BaseGridSnap})),__webpack_require__.d(__webpack_exports__,"FullWidthGrid",(function(){return FullWidthGrid})),__webpack_require__.d(__webpack_exports__,"AutoSizer",(function(){return AutoSizer})),__webpack_require__.d(__webpack_exports__,"MergedCells",(function(){return MergedCells})),__webpack_require__.d(__webpack_exports__,"BaseGridWithSelection",(function(){return BaseGridWithSelection})),__webpack_require__.d(__webpack_exports__,"VariableSizeGrid",(function(){return VariableSizeGrid})),__webpack_require__.d(__webpack_exports__,"LargeGrid",(function(){return LargeGrid})),__webpack_require__.d(__webpack_exports__,"DataGrid",(function(){return DataGrid})),__webpack_require__.d(__webpack_exports__,"DataGridResize",(function(){return DataGridResize})),__webpack_require__.d(__webpack_exports__,"GridWithFrozenRow",(function(){return GridWithFrozenRow})),__webpack_require__.d(__webpack_exports__,"GridWithFrozenColumns",(function(){return GridWithFrozenColumns})),__webpack_require__.d(__webpack_exports__,"GridWithFrozenEdges",(function(){return GridWithFrozenEdges})),__webpack_require__.d(__webpack_exports__,"EditableGrid",(function(){return EditableGrid})),__webpack_require__.d(__webpack_exports__,"WithTooltip",(function(){return WithTooltip})),__webpack_require__.d(__webpack_exports__,"GridWithContextMenu",(function(){return GridWithContextMenu}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__),react_use__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(970),react_konva__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(10);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}__webpack_exports__.default={title:"Grid",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a};var BaseGrid=function BaseGrid(){var App=function App(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,{width:900,height:600,columnCount:200,rowCount:200,columnWidth:function columnWidth(index){return 100},itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.Cell,_extends({},props,{value:"".concat(props.rowIndex,":").concat(props.columnIndex)}))},rowHeight:function rowHeight(index){return 20}})};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)},BaseGridSnap=function BaseGridSnap(){var Cell=function Cell(_ref){var rowIndex=_ref.rowIndex,columnIndex=_ref.columnIndex,x=_ref.x,y=_ref.y,width=_ref.width,height=_ref.height,text="".concat(rowIndex,"x").concat(columnIndex);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Rect,{x:x,y:y,height:height,width:width,fill:"white",stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"center"}))},App=function App(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,{width:900,height:600,columnCount:200,rowCount:200,columnWidth:function columnWidth(index){return 100},snap:!0,itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Cell,props)},rowHeight:function rowHeight(index){return 20}})};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)};BaseGridSnap.story={name:"Autosnap"};var FullWidthGrid=function FullWidthGrid(){var itemRenderer=function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.Cell,_extends({value:"".concat(props.rowIndex,":").concat(props.columnIndex)},props))},App=function App(){var _useMeasure2=_slicedToArray(Object(react_use__WEBPACK_IMPORTED_MODULE_2__.a)(),2),containerRef=_useMeasure2[0],_useMeasure2$=_useMeasure2[1],width=_useMeasure2$.width,height=_useMeasure2$.height;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{style:{flex:1,width:"100%",height:600},ref:containerRef},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,{width:width,height:height,columnCount:200,rowCount:200,columnWidth:function columnWidth(index){return 100},itemRenderer:itemRenderer,rowHeight:function rowHeight(index){return 20}}))};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)},AutoSizer=function AutoSizer(){var Cell=function Cell(_ref2){var rowIndex=_ref2.rowIndex,columnIndex=_ref2.columnIndex,x=_ref2.x,y=_ref2.y,width=_ref2.width,height=_ref2.height,text=_ref2.value||"".concat(rowIndex,"x").concat(columnIndex);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Rect,{x:x,y:y,height:height,width:width,fill:"white",stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"left",offsetX:-5}))},App=function App(){var _useState3,_useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)((_defineProperty(_useState3={},[1,2],"Hello, good morning"),_defineProperty(_useState3,[30,4],"lorem asd asd as das dasd asd as da sdasdasda"),_defineProperty(_useState3,[2,15],"lorem asd asd as das dasd asd as da sdasdasda"),_useState3)),2),data=_useState2[0],gridRef=(_useState2[1],Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null)),getCellValue=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(_ref3){var rowIndex=_ref3.rowIndex,columnIndex=_ref3.columnIndex;return data[[rowIndex,columnIndex]]}),[data]),autoSizerProps=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.useSizer)({gridRef:gridRef,getValue:getCellValue});return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,_extends({ref:gridRef,width:900,height:600,columnCount:200,rowCount:200,columnWidth:function columnWidth(index){return 100},itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Cell,_extends({value:data[[props.rowIndex,props.columnIndex]]},props))},rowHeight:function rowHeight(index){return 20}},autoSizerProps))};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)},MergedCells=function MergedCells(){var Cell=function Cell(_ref4){var rowIndex=_ref4.rowIndex,columnIndex=_ref4.columnIndex,x=_ref4.x,y=_ref4.y,width=_ref4.width,height=_ref4.height,text="".concat(rowIndex,"x").concat(columnIndex);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Rect,{x:x,y:y,height:height,width:width,fill:"white",stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"center"}))},App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),_useSelection=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.useSelection)({gridRef:gridRef,rowCount:200,columnCount:200}),selection=_useSelection.selection,selectionProps=_objectWithoutProperties(_useSelection,["selection"]);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,_extends({width:900,height:600,columnCount:200,rowCount:200,ref:gridRef,mergedCells:[{top:5,left:5,right:6,bottom:5},{top:1,left:2,right:4,bottom:5},{top:5,left:0,right:1,bottom:5}],columnWidth:function columnWidth(index){return 100},itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Cell,props)},rowHeight:function rowHeight(index){return 20},selection:selection},selectionProps))};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)},BaseGridWithSelection=function BaseGridWithSelection(){var initialSelections=[{bounds:{top:2,right:3,left:2,bottom:20},style:{borderStyle:"dashed"}}],Cell=function Cell(_ref5){var rowIndex=_ref5.rowIndex,columnIndex=_ref5.columnIndex,x=_ref5.x,y=_ref5.y,width=_ref5.width,height=_ref5.height,text="".concat(rowIndex,"x").concat(columnIndex);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Rect,{x:x,y:y,height:height,width:width,fill:"white",stroke:"grey",strokeWidth:.5,listening:!1}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"center"}))},App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),_useSelection2=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.useSelection)({initialSelections:initialSelections,gridRef:gridRef,rowCount:200,columnCount:200}),selections=_useSelection2.selections,activeCell=_useSelection2.activeCell,selectionProps=_objectWithoutProperties(_useSelection2,["selections","activeCell"]);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,_extends({width:900,height:600,selections:selections,activeCell:activeCell,columnCount:200,rowCount:200,ref:gridRef},selectionProps,{columnWidth:function columnWidth(index){return 100},rowHeight:function rowHeight(index){return 20},itemRenderer:Cell}))};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)},VariableSizeGrid=function VariableSizeGrid(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,{width:900,height:600,columnCount:200,rowCount:200,columnWidth:function columnWidth(index){return index%3==0?200:100},rowHeight:function rowHeight(index){return index%2==0?40:20},itemRenderer:function Cell(_ref6){var rowIndex=_ref6.rowIndex,columnIndex=_ref6.columnIndex,x=_ref6.x,y=_ref6.y,width=_ref6.width,height=_ref6.height,text="".concat(rowIndex,"x").concat(columnIndex);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Rect,{x:x,y:y,height:height,width:width,fill:"white",stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"center"}))}})},LargeGrid=function LargeGrid(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,{width:900,height:600,columnCount:1e6,rowCount:1e6,columnWidth:function columnWidth(index){return index%3==0?200:100},rowHeight:function rowHeight(index){return index%2==0?40:20},itemRenderer:function Cell(_ref7){var rowIndex=_ref7.rowIndex,columnIndex=_ref7.columnIndex,x=_ref7.x,y=_ref7.y,width=_ref7.width,height=_ref7.height,text="".concat(rowIndex,"x").concat(columnIndex),fill=columnIndex%2==0?rowIndex%2==0?"#f8f8f0":"white":rowIndex%2?"#f8f8f0":"white";return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Rect,{x:x,y:y,height:height,width:width,fill:fill,stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"center"}))}})};LargeGrid.story={name:"1,000,000 rows and cols"};var DataGrid=function DataGrid(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),Cell=function Cell(_ref8){var rowIndex=_ref8.rowIndex,columnIndex=_ref8.columnIndex,x=_ref8.x,y=_ref8.y,width=_ref8.width,height=_ref8.height,header=_ref8.header,text=header?columnIndex<1?"S/No":"Header ".concat(columnIndex):"".concat(rowIndex,"x").concat(columnIndex),fill=header?"#eee":"white";return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Rect,{x:x,y:y,height:height,width:width,fill:fill,stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Text,{x:x,y:y,height:height,width:width,text:text,fontStyle:header?"bold":"normal",verticalAlign:"middle",align:"center"}))};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,{columnCount:1e5,height:40,rowCount:1,frozenColumns:1,ref:gridRef,width:900,columnWidth:function columnWidth(index){return 0===index?80:index%3==0?200:100},rowHeight:function rowHeight(index){return index%2==0?40:20},showScrollbar:!1,itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Cell,_extends({},props,{header:!0}))}}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,{columnCount:1e5,rowCount:1e5,frozenColumns:1,height:600,width:900,columnWidth:function columnWidth(index){return 0===index?80:index%3==0?200:100},rowHeight:function rowHeight(index){return index%2==0?40:20},onScroll:function onScroll(_ref9){var scrollLeft=_ref9.scrollLeft;gridRef.current.scrollTo({scrollLeft:scrollLeft})},itemRenderer:Cell}))},DataGridResize=function DataGridResize(){var DraggableRect=function DraggableRect(props){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Rect,_extends({fill:"blue",draggable:!0,hitStrokeWidth:20,onMouseEnter:function onMouseEnter(){return document.body.style.cursor="ew-resize"},onMouseLeave:function onMouseLeave(){return document.body.style.cursor="default"},dragBoundFunc:function dragBoundFunc(pos){return _objectSpread(_objectSpread({},pos),{},{y:0})}},props))},HeaderComponent=function HeaderComponent(_ref10){_ref10.rowIndex;var columnIndex=_ref10.columnIndex,x=_ref10.x,y=_ref10.y,width=_ref10.width,height=_ref10.height,frozenColumns=_ref10.frozenColumns,onResize=_ref10.onResize,text=columnIndex<frozenColumns?"S/No":"Header ".concat(columnIndex);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Group,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Rect,{x:x,y:y,height:height,width:width,fill:"#eee",stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Text,{x:x,y:y,height:height,width:width,text:text,fontStyle:"bold",verticalAlign:"middle",align:"center"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(DraggableRect,{x:x+width-5,y:y,width:5,height:height,onDragMove:function onDragMove(e){var newWidth=e.target.x()-x+5;onResize(columnIndex,newWidth)}}))},Cell=function Cell(_ref11){var rowIndex=_ref11.rowIndex,columnIndex=_ref11.columnIndex,x=_ref11.x,y=_ref11.y,width=_ref11.width,height=_ref11.height,key=_ref11.key,text="".concat(rowIndex,"x").concat(columnIndex);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,{key:key},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Rect,{x:x,y:y,height:height,width:width,fill:"white",stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Text,{x:x,y:y,height:height,width:width,text:text,fontStyle:"normal",verticalAlign:"middle",align:"center"}))},App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),mainGridRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),_useState5=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)({}),2),columnWidthMap=_useState5[0],setColumnWidthMap=_useState5[1],handleResize=function handleResize(columnIndex,newWidth){setColumnWidthMap((function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},columnIndex,newWidth))})),gridRef.current.resizeColumns([columnIndex]),mainGridRef.current.resizeColumns([columnIndex])};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,{columnCount:1e5,height:40,rowCount:1,frozenColumns:1,ref:gridRef,width:900,columnWidth:function columnWidth(index){return index in columnWidthMap?columnWidthMap[index]:0===index?80:index%3==0?200:100},rowHeight:function rowHeight(index){return index%2==0?40:20},showScrollbar:!1,itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(HeaderComponent,_extends({onResize:handleResize,frozenColumns:1},props))}}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,{columnCount:1e5,rowCount:1e5,frozenColumns:1,height:600,width:900,ref:mainGridRef,columnWidth:function columnWidth(index){return index in columnWidthMap?columnWidthMap[index]:0===index?80:index%3==0?200:100},rowHeight:function rowHeight(index){return index%2==0?40:20},onScroll:function onScroll(_ref12){var scrollLeft=_ref12.scrollLeft;gridRef.current.scrollTo({scrollLeft:scrollLeft})},itemRenderer:Cell}))};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)};DataGridResize.story={name:"Grid with resizable headers"};var GridWithFrozenRow=function GridWithFrozenRow(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,{width:900,height:600,columnCount:200,rowCount:200,frozenRows:1,columnWidth:function columnWidth(index){return 100},rowHeight:function rowHeight(index){return 20},itemRenderer:function Cell(_ref13){var rowIndex=_ref13.rowIndex,columnIndex=_ref13.columnIndex,x=_ref13.x,y=_ref13.y,width=_ref13.width,height=_ref13.height,text="".concat(rowIndex,"x").concat(columnIndex),isFrozen=rowIndex<1;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Rect,{x:x,y:y,height:height,width:width,fill:isFrozen?"lightblue":"white",stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"center"}))}})};GridWithFrozenRow.story={name:"Frozen rows"};var GridWithFrozenColumns=function GridWithFrozenColumns(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,{width:900,height:600,columnCount:200,rowCount:200,frozenColumns:1,columnWidth:function columnWidth(index){return 100},rowHeight:function rowHeight(index){return 20},itemRenderer:function Cell(_ref14){var rowIndex=_ref14.rowIndex,columnIndex=_ref14.columnIndex,x=_ref14.x,y=_ref14.y,width=_ref14.width,height=_ref14.height,text="".concat(rowIndex,"x").concat(columnIndex),isFrozen=columnIndex<1;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Rect,{x:x,y:y,height:height,width:width,fill:isFrozen?"lightblue":"white",stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"center"}))}})};GridWithFrozenColumns.story={name:"Frozen columns"};var GridWithFrozenEdges=function GridWithFrozenEdges(){var Cell=function Cell(_ref15){var rowIndex=_ref15.rowIndex,columnIndex=_ref15.columnIndex,x=_ref15.x,y=_ref15.y,width=_ref15.width,height=_ref15.height,text="".concat(rowIndex,"x").concat(columnIndex),isFrozen=rowIndex<2||columnIndex<2;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Rect,{x:x,y:y,height:height,width:width,fill:isFrozen?"lightblue":"white",stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"center"}))},App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),_useSelection3=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.useSelection)({gridRef:gridRef,rowCount:200,columnCount:200}),selection=_useSelection3.selection,selectionProps=_objectWithoutProperties(_useSelection3,["selection"]);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,_extends({ref:gridRef,selection:selection,width:900,height:600,columnCount:1e5,rowCount:1e5,frozenColumns:2,frozenRows:2,columnWidth:function columnWidth(index){return 100},rowHeight:function rowHeight(index){return 20},itemRenderer:Cell},selectionProps))};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)};GridWithFrozenEdges.story={name:"Frozen columns and rows"};var EditableGrid=function EditableGrid(){var SelectEditor=function SelectEditor(props){var _React$createElement,position=props.position,onSubmit=props.onSubmit,value=props.value,cell=props.cell,nextFocusableCell=props.nextFocusableCell,onBlur=props.onBlur;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{style:{position:"absolute",left:position.x,top:position.y,width:position.width,height:position.height}},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("select",(_defineProperty(_React$createElement={style:{width:"100%"},autoFocus:!0,value:value,onBlur:onBlur},"value",value),_defineProperty(_React$createElement,"onChange",(function onChange(e){onSubmit(e.target.value,cell,nextFocusableCell(cell,_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.Direction.Down))})),_React$createElement),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("option",null,"Yay Select"),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("option",null,"This can be any React Component")))},App=function App(){var _useState8,_useState7=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)((_defineProperty(_useState8={},[1,2],"Hello lorem ipsum lorem"),_defineProperty(_useState8,[1,1],"Select editor"),_defineProperty(_useState8,[2,3],"Cannot be edited"),_defineProperty(_useState8,[30,4],"lorem asd asd as das dasd asd as da sdasdasda"),_defineProperty(_useState8,[2,15],"lorem asd asd as das dasd asd as da sdasdasda"),_defineProperty(_useState8,[100,80],"asdhasd asd asd asd as dasdas"),_useState8)),2),data=_useState7[0],setData=_useState7[1],gridRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),getCellValue=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(_ref16){var rowIndex=_ref16.rowIndex,columnIndex=_ref16.columnIndex;return data[[rowIndex,columnIndex]]}),[data]),_useSelection4=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.useSelection)({gridRef:gridRef,rowCount:200,columnCount:200,onFill:function onFill(activeCell,fillSelection){if(fillSelection){for(var bounds=fillSelection.bounds,changes={},value=getCellValue(activeCell),i=bounds.top;i<=bounds.bottom;i++)for(var j=bounds.left;j<=bounds.right;j++)changes[[i,j]]=value;setData((function(prev){return _objectSpread(_objectSpread({},prev),changes)}))}}}),activeCell=_useSelection4.activeCell,selections=_useSelection4.selections,setActiveCell=_useSelection4.setActiveCell,selectionProps=_objectWithoutProperties(_useSelection4,["activeCell","selections","setActiveCell"]),_useAutoSizer=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.useSizer)({gridRef:gridRef,getValue:getCellValue,resizeStrategy:"lazy",rowCount:200,autoResize:!1}),autoSizerProps=(_useAutoSizer.getTextMetrics,_objectWithoutProperties(_useAutoSizer,["getTextMetrics"])),_useEditable=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.useEditable)({gridRef:gridRef,getValue:getCellValue,selections:selections,getEditor:function getEditor(_ref17){var rowIndex=_ref17.rowIndex,columnIndex=_ref17.columnIndex;if(1==rowIndex&&1===columnIndex)return SelectEditor},activeCell:activeCell,onDelete:function onDelete(activeCell,selections){if(selections.length){var newValues=selections.reduce((function(acc,_ref18){for(var sel=_ref18.bounds,i=sel.top;i<=sel.bottom;i++)for(var j=sel.left;j<=sel.right;j++)acc[[i,j]]="";return acc}),{});setData((function(prev){return _objectSpread(_objectSpread({},prev),newValues)}));var selectionBounds=selections[0].bounds;gridRef.current.resetAfterIndices({columnIndex:selectionBounds.left,rowIndex:selectionBounds.top},!0)}else activeCell&&(setData((function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},[activeCell.rowIndex,activeCell.columnIndex],""))})),gridRef.current.resetAfterIndices(activeCell))},onBeforeEdit:function onBeforeEdit(_ref19){var rowIndex=_ref19.rowIndex,columnIndex=_ref19.columnIndex;return 2!==rowIndex||3!==columnIndex},onSubmit:function onSubmit(value,_ref20,nextActiveCell){var rowIndex=_ref20.rowIndex,columnIndex=_ref20.columnIndex;setData((function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},[rowIndex,columnIndex],value))})),gridRef.current.resizeColumns([columnIndex]),nextActiveCell&&setActiveCell(nextActiveCell)}}),editorComponent=_useEditable.editorComponent,isEditInProgress=_useEditable.isEditInProgress,editableProps=_objectWithoutProperties(_useEditable,["editorComponent","isEditInProgress"]);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{style:{position:"relative"}},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,_extends({width:900,height:600,columnCount:1e5,rowCount:1e5,ref:gridRef,activeCell:activeCell,selections:selections,columnWidth:function columnWidth(index){return 100},showFillHandle:!isEditInProgress,itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.Cell,_extends({value:data[[props.rowIndex,props.columnIndex]],align:"left"},props))},rowHeight:function rowHeight(index){return 20}},selectionProps,editableProps,autoSizerProps,{onKeyDown:function onKeyDown(){selectionProps.onKeyDown.apply(selectionProps,arguments),editableProps.onKeyDown.apply(editableProps,arguments)},onMouseDown:function onMouseDown(){selectionProps.onMouseDown.apply(selectionProps,arguments),editableProps.onMouseDown.apply(editableProps,arguments)}})),editorComponent)};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)},WithTooltip=function WithTooltip(){var Cell=function Cell(_ref21){var rowIndex=_ref21.rowIndex,columnIndex=_ref21.columnIndex,x=_ref21.x,y=_ref21.y,width=_ref21.width,height=_ref21.height,text="".concat(rowIndex,"x").concat(columnIndex);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Rect,{x:x,y:y,height:height,width:width,fill:"white",stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_3__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"center"}))},App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),_useTooltip=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.useTooltip)({gridRef:gridRef,getValue:function getValue(_ref22){var rowIndex=_ref22.rowIndex,columnIndex=_ref22.columnIndex;return"You are at: ".concat(rowIndex,", ").concat(columnIndex)}}),tooltipComponent=_useTooltip.tooltipComponent,tooltipProps=_objectWithoutProperties(_useTooltip,["tooltipComponent"]);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{style:{position:"relative"}},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,_extends({ref:gridRef,width:900,height:600,columnCount:200,rowCount:200,columnWidth:function columnWidth(index){return 100},itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Cell,props)},rowHeight:function rowHeight(index){return 20}},tooltipProps)),tooltipComponent)};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)},GridWithContextMenu=function GridWithContextMenu(){var ContextMenu=function ContextMenu(_ref23){var left=_ref23.left,top=_ref23.top,rowIndex=_ref23.rowIndex,columnIndex=_ref23.columnIndex;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{style:{left:left,top:top,position:"absolute",padding:8,background:"white",boxShadow:"0 1px 2px 3px rgba(0,0,0,0.2)"}},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",null,"You selected ",rowIndex,": ",columnIndex),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("a",{href:"#",style:{display:"block",padding:8}},"Hide column"))},App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),_useState10=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),2),contextMenuPostion=_useState10[0],setContextMenuPosition=_useState10[1];return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{style:{position:"relative"}},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,{ref:gridRef,onContextMenu:function onContextMenu(e){var _gridRef$current$getC=gridRef.current.getCellCoordsFromOffset(e.clientX,e.clientY),rowIndex=_gridRef$current$getC.rowIndex,columnIndex=_gridRef$current$getC.columnIndex;setContextMenuPosition({left:e.clientX+10,top:e.clientY+10,rowIndex:rowIndex,columnIndex:columnIndex}),e.preventDefault()},onMouseDown:function onMouseDown(){return setContextMenuPosition(null)},width:900,height:600,columnCount:200,rowCount:200,columnWidth:function columnWidth(index){return 100},itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.Cell,_extends({},props,{value:"".concat(props.rowIndex,":").concat(props.columnIndex)}))},rowHeight:function rowHeight(index){return 20}}),contextMenuPostion&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(ContextMenu,contextMenuPostion))};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)}},789:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const utils_1=__webpack_require__(384);exports.default=props=>utils_1.createHTMLBox({strokeWidth:1,strokeBoxWidth:0,...props})},790:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importDefault(__webpack_require__(1));exports.default=({x:x=0,y:y=0,stroke:stroke,strokeWidth:strokeWidth=1,size:size=8,borderColor:borderColor,...props})=>0===x||0===y?null:react_1.default.createElement("div",Object.assign({style:{position:"absolute",left:x-size/2,top:y-size/2,width:size,height:size,border:`${strokeWidth}px ${borderColor} solid`,background:stroke,cursor:"crosshair",pointerEvents:"all"}},props))},791:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importDefault(__webpack_require__(1)),react_konva_1=__webpack_require__(10);exports.default=props=>{const{points:points,stroke:stroke,strokeWidth:strokeWidth,offsetY:offsetY,offsetX:offsetX}=props;return react_1.default.createElement(react_konva_1.Line,{points:points,stroke:stroke,strokeWidth:strokeWidth,offsetY:offsetY,offsetX:offsetX,shadowForStrokeEnabled:!1,strokeScaleEnabled:!1,hitStrokeWidth:0,listening:!1,perfectDrawEnabled:!1})}},792:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__webpack_require__(1),helpers_1=__webpack_require__(61),types_1=__webpack_require__(62),EMPTY_SELECTION=[],defaultIsHidden=i=>!1,defaultSelectionSpan=()=>!0;exports.default=({gridRef:gridRef,initialActiveCell:initialActiveCell=null,initialSelections:initialSelections=EMPTY_SELECTION,columnCount:columnCount=0,rowCount:rowCount=0,selectionPolicy:selectionPolicy="multiple",persistantSelectionMode:persistantSelectionMode=!1,allowDeselectSelection:allowDeselectSelection=!0,onFill:onFill,isHiddenRow:isHiddenRow=defaultIsHidden,isHiddenColumn:isHiddenColumn=defaultIsHidden,alwaysScrollToActiveCell:alwaysScrollToActiveCell=!0,selectionTopBound:selectionTopBound=0,selectionBottomBound:selectionBottomBound=rowCount-1,selectionLeftBound:selectionLeftBound=0,selectionRightBound:selectionRightBound=columnCount-1,mouseDownInterceptor:mouseDownInterceptor,mouseMoveInterceptor:mouseMoveInterceptor,mergedCells:mergedCells=[],canSelectionSpanMergedCells:canSelectionSpanMergedCells=defaultSelectionSpan})=>{const[activeCell,setActiveCell]=react_1.useState(initialActiveCell),[selections,setSelections]=react_1.useState(initialSelections),[fillSelection,setFillSelection]=react_1.useState(null),selectionStart=react_1.useRef(null),selectionEnd=react_1.useRef(null),isSelecting=react_1.useRef(),isFilling=react_1.useRef(),firstActiveCell=react_1.useRef(null),activeCellRef=react_1.useRef(activeCell),activeSelectionsRef=react_1.useRef(selections),mergedCellsRef=react_1.useRef(mergedCells);react_1.useEffect(()=>{activeCellRef.current=activeCell},[activeCell]),react_1.useEffect(()=>{activeSelectionsRef.current=selections},[selections]),react_1.useEffect(()=>{mergedCellsRef.current=mergedCells},[mergedCells]);const isCellOutOfBounds=react_1.useCallback(cell=>cell.rowIndex<selectionTopBound||cell.columnIndex<selectionLeftBound,[selectionTopBound,selectionLeftBound]),newSelection=(start,end=start)=>{if(isCellOutOfBounds(start))return;selectionStart.current=start,selectionEnd.current=end;const bounds=selectionFromStartEnd(start,end);if(!bounds)return;const coords={rowIndex:bounds.top,columnIndex:bounds.left};firstActiveCell.current=coords,setActiveCell(coords),clearSelections()},selectionFromStartEnd=(start,end)=>{if(!(null==gridRef?void 0:gridRef.current))return null;const spanMerges=null==canSelectionSpanMergedCells?void 0:canSelectionSpanMergedCells(start,end),boundsStart=gridRef.current.getCellBounds(start,spanMerges),boundsEnd=gridRef.current.getCellBounds(end,spanMerges),bounds={top:Math.min(boundsStart.top,boundsEnd.top),bottom:Math.max(boundsStart.bottom,boundsEnd.bottom),left:Math.min(boundsStart.left,boundsEnd.left),right:Math.max(boundsStart.right,boundsEnd.right)};return spanMerges?helpers_1.extendAreaToMergedCells(bounds,mergedCellsRef.current):bounds},modifySelection=(coords,setInProgress)=>{if("single"===selectionPolicy)return;if(!selectionStart.current)return;if(isCellOutOfBounds(coords))return;selectionEnd.current=coords;const bounds=selectionFromStartEnd(selectionStart.current,coords);bounds&&setSelections(prevSelection=>{const len=prevSelection.length;return len?prevSelection.map((sel,i)=>len-1===i?{...sel,bounds:bounds,inProgress:!!setInProgress}:sel):[{bounds:bounds,inProgress:!!setInProgress}]})},appendSelection=(start,end=start)=>{if("multiple"!==selectionPolicy)return;if(!start)return;if(isCellOutOfBounds(start))return;selectionStart.current=start,selectionEnd.current=end;const bounds=selectionFromStartEnd(start,end);bounds&&(setActiveCell({rowIndex:bounds.top,columnIndex:bounds.left}),setSelections(prev=>[...prev,{bounds:bounds}]))},removeSelectionByIndex=react_1.useCallback(index=>{const newSelection=selections.filter((_,idx)=>idx!==index);return setSelections(newSelection),newSelection},[selections]),clearSelections=()=>{setSelections(EMPTY_SELECTION)},cellIndexInSelection=(cell,selections)=>{const id=helpers_1.cellIdentifier(Math.max(selectionTopBound,cell.rowIndex),Math.max(selectionLeftBound,cell.columnIndex));return selections.findIndex(sel=>helpers_1.getBoundedCells(sel.bounds).has(id))},handleMouseDown=react_1.useCallback(e=>{var _a;if(!gridRef||!gridRef.current)return;const coords=gridRef.current.getCellCoordsFromOffset(e.nativeEvent.clientX,e.nativeEvent.clientY);if(!coords)return;const isContextMenuClick=e.nativeEvent.which===types_1.MouseButtonCodes.right;if(isContextMenuClick){if(-1!==cellIndexInSelection(coords,selections))return}const isShiftKey=e.nativeEvent.shiftKey,isMetaKey=e.nativeEvent.ctrlKey||e.nativeEvent.metaKey,allowMultiple=persistantSelectionMode||isMetaKey,allowDeselect=allowDeselectSelection,hasSelections=selections.length>0,isDeselecting=isMetaKey&&allowDeselect;if(isContextMenuClick||"single"===selectionPolicy||(document.addEventListener("mouseup",handleMouseUp),document.addEventListener("mousemove",handleMouseMove)),isSelecting.current=!0,!1===(null==mouseDownInterceptor?void 0:mouseDownInterceptor(e,coords,selectionStart,selectionEnd)))return;if(isShiftKey)return void modifySelection(coords);const isSameAsActiveCell=helpers_1.isEqualCells(coords,activeCell);if(activeCell&&allowMultiple){if(isSameAsActiveCell&&(!isDeselecting||!hasSelections))return;if(isMetaKey&&!hasSelections&&appendSelection(activeCell),isMetaKey&&allowDeselect){const cellIndex=cellIndexInSelection(coords,selections);if(-1!==cellIndex){const newSelection=removeSelectionByIndex(cellIndex),nextActiveCell=(selections=>{if(!selections.length)return null;const{bounds:bounds}=selections[selections.length-1];return{rowIndex:bounds.top,columnIndex:bounds.left}})(newSelection);return null!==nextActiveCell&&setActiveCell(nextActiveCell),void(1===newSelection.length&&((cell,selections)=>null!==cell&&selections.some(sel=>sel.bounds.left===cell.columnIndex&&sel.bounds.top===cell.rowIndex&&sel.bounds.right===cell.columnIndex&&sel.bounds.bottom===cell.rowIndex))(nextActiveCell,newSelection)&&clearSelections())}}appendSelection(coords)}else alwaysScrollToActiveCell&&(null===(_a=gridRef.current)||void 0===_a||_a.scrollToItem(coords)),isSameAsActiveCell||newSelection(coords)},[activeCell,selections,selectionPolicy,allowDeselectSelection,alwaysScrollToActiveCell,rowCount,columnCount]),handleMouseMove=react_1.useCallback(e=>{var _a;if(!isSelecting.current||!(null==gridRef?void 0:gridRef.current))return;const coords=gridRef.current.getCellCoordsFromOffset(e.clientX,e.clientY);if(coords&&!1!==(null==mouseMoveInterceptor?void 0:mouseMoveInterceptor(e,coords,selectionStart,selectionEnd))){if(helpers_1.isEqualCells(firstActiveCell.current,coords))return clearSelections();modifySelection(coords,!0),null===(_a=gridRef.current)||void 0===_a||_a.scrollToItem(coords)}},[rowCount,columnCount]),handleMouseUp=react_1.useCallback(()=>{isSelecting.current=!1,document.removeEventListener("mousemove",handleMouseMove),document.removeEventListener("mouseup",handleMouseUp),setSelections(prevSelection=>{const len=prevSelection.length;return len?prevSelection.map((sel,i)=>len-1===i?{...sel,inProgress:!1}:sel):EMPTY_SELECTION})},[]),keyNavigate=react_1.useCallback((direction,modify,metaKeyPressed)=>{if(!(selectionStart.current&&selectionEnd.current&&(null==gridRef?void 0:gridRef.current)&&activeCell))return;var{rowIndex:rowIndex,columnIndex:columnIndex}=modify?selectionEnd.current:activeCell;const isMergedCell=null==gridRef?void 0:gridRef.current.isMergedCell({rowIndex:rowIndex,columnIndex:columnIndex}),currentBounds=gridRef.current.getCellBounds({rowIndex:rowIndex,columnIndex:columnIndex});switch(direction){case types_1.Direction.Up:isMergedCell&&(rowIndex=currentBounds.top),rowIndex=helpers_1.clampIndex(Math.max(rowIndex-1,selectionTopBound),isHiddenRow,direction),metaKeyPressed&&(rowIndex=selectionTopBound);break;case types_1.Direction.Down:isMergedCell&&(rowIndex=currentBounds.bottom),rowIndex=helpers_1.clampIndex(Math.min(rowIndex+1,selectionBottomBound),isHiddenRow,direction),metaKeyPressed&&(rowIndex=selectionBottomBound);break;case types_1.Direction.Left:isMergedCell&&(columnIndex=currentBounds.left),columnIndex=helpers_1.clampIndex(Math.max(columnIndex-1,selectionLeftBound),isHiddenColumn,direction),metaKeyPressed&&(columnIndex=selectionLeftBound);break;case types_1.Direction.Right:isMergedCell&&(columnIndex=currentBounds.right),columnIndex=helpers_1.clampIndex(Math.min(columnIndex+1,selectionRightBound),isHiddenColumn,direction),metaKeyPressed&&(columnIndex=selectionRightBound)}const newBounds=gridRef.current.getCellBounds({rowIndex:rowIndex,columnIndex:columnIndex}),coords={rowIndex:newBounds.top,columnIndex:newBounds.left},scrollToCell=modify?selectionEnd.current.rowIndex===coords.rowIndex?{columnIndex:coords.columnIndex}:{rowIndex:coords.rowIndex}:{rowIndex:rowIndex,columnIndex:columnIndex},isUserNavigatingToActiveCell=helpers_1.isEqualCells(firstActiveCell.current,coords);modify&&!isUserNavigatingToActiveCell?modifySelection(coords):newSelection(coords),gridRef.current.scrollToItem(scrollToCell)},[activeCell,isHiddenRow,isHiddenColumn,selectionLeftBound,selectionTopBound,selectionPolicy]),selectAll=()=>{selectionStart.current={rowIndex:selectionTopBound,columnIndex:selectionLeftBound},modifySelection({rowIndex:selectionBottomBound,columnIndex:selectionRightBound})},selectColumn=react_1.useCallback(()=>{selectionEnd.current&&selectionStart.current&&(selectionStart.current={rowIndex:selectionTopBound,columnIndex:selectionStart.current.columnIndex},modifySelection({rowIndex:rowCount-1,columnIndex:selectionEnd.current.columnIndex}))},[selectionTopBound]),selectRow=react_1.useCallback(()=>{selectionEnd.current&&selectionStart.current&&(selectionStart.current={rowIndex:selectionStart.current.rowIndex,columnIndex:selectionLeftBound},modifySelection({rowIndex:selectionEnd.current.rowIndex,columnIndex:selectionRightBound}))},[selectionLeftBound]),handleKeyDown=react_1.useCallback(e=>{if(!(null==gridRef?void 0:gridRef.current))return;const isShiftKey=e.nativeEvent.shiftKey,isMetaKey=e.nativeEvent.ctrlKey||e.nativeEvent.metaKey;switch(e.nativeEvent.which){case types_1.KeyCodes.Right:keyNavigate(types_1.Direction.Right,isShiftKey,isMetaKey),e.preventDefault();break;case types_1.KeyCodes.Left:keyNavigate(types_1.Direction.Left,isShiftKey,isMetaKey),e.preventDefault();break;case types_1.KeyCodes.Up:keyNavigate(types_1.Direction.Up,isShiftKey,isMetaKey),e.preventDefault();break;case types_1.KeyCodes.Down:keyNavigate(types_1.Direction.Down,isShiftKey,isMetaKey),e.preventDefault();break;case types_1.KeyCodes.A:isMetaKey&&selectAll();break;case types_1.KeyCodes.Home:isMetaKey?(()=>{if(!selectionStart.current||!(null==gridRef?void 0:gridRef.current))return;const cell={rowIndex:selectionTopBound,columnIndex:selectionStart.current.columnIndex};newSelection(cell),null==gridRef||gridRef.current.scrollToItem(cell)})():(()=>{if(!selectionStart.current||!(null==gridRef?void 0:gridRef.current))return;const cell={rowIndex:selectionStart.current.rowIndex,columnIndex:selectionLeftBound};newSelection(cell),null==gridRef||gridRef.current.scrollToItem(cell)})();break;case types_1.KeyCodes.End:isMetaKey?(()=>{if(!selectionStart.current||!(null==gridRef?void 0:gridRef.current))return;const cell={rowIndex:rowCount-1,columnIndex:selectionStart.current.columnIndex};newSelection(cell),null==gridRef||gridRef.current.scrollToItem(cell)})():(()=>{if(!selectionStart.current||!(null==gridRef?void 0:gridRef.current))return;const cell={rowIndex:selectionStart.current.rowIndex,columnIndex:selectionRightBound};newSelection(cell),null==gridRef||gridRef.current.scrollToItem(cell)})();break;case types_1.KeyCodes.BackSpace:isMetaKey&&activeCell&&(null==gridRef?void 0:gridRef.current)&&(null==gridRef||gridRef.current.scrollToItem(activeCell,helpers_1.Align.smart));break;case types_1.KeyCodes.SPACE:isMetaKey&&isShiftKey?selectAll():isMetaKey?selectColumn():isShiftKey&&selectRow();break;case types_1.KeyCodes.Tab:if(selections.length&&activeCell&&gridRef){const{bounds:bounds}=selections[selections.length-1],activeCellBounds=gridRef.current.getCellBounds(activeCell),direction=isShiftKey?types_1.Direction.Left:types_1.Direction.Right,nextCell=helpers_1.findNextCellWithinBounds(activeCellBounds,bounds,direction);nextCell&&(setActiveCell(nextCell),gridRef.current&&gridRef.current.scrollToItem(nextCell))}else keyNavigate(isShiftKey?types_1.Direction.Left:types_1.Direction.Right);e.preventDefault()}},[rowCount,columnCount,activeCell,selections,selectionPolicy]),handleSetActiveCell=react_1.useCallback((coords,shouldScroll=!0)=>{selectionStart.current=coords,firstActiveCell.current=coords,selectionEnd.current=coords,setActiveCell(coords),shouldScroll&&coords&&(null==gridRef?void 0:gridRef.current)&&gridRef.current.scrollToItem(coords)},[]),handleFillHandleMouseDown=react_1.useCallback(e=>{e.stopPropagation(),isFilling.current=!0,document.addEventListener("mousemove",handleFillHandleMouseMove),document.addEventListener("mouseup",handleFillHandleMouseUp)},[selections]),handleFillHandleMouseMove=react_1.useCallback(e=>{if(!isFilling.current||!(null==gridRef?void 0:gridRef.current)||!activeCellRef.current)return;const coords=gridRef.current.getCellCoordsFromOffset(e.clientX,e.clientY);if(!coords)return;const selections=activeSelectionsRef.current;let bounds=selectionFromStartEnd(activeCellRef.current,coords);const hasSelections=selections.length>0,activeCellBounds=hasSelections?selections[selections.length-1].bounds:gridRef.current.getCellBounds(activeCellRef.current);if(!bounds)return;const direction=bounds.right>activeCellBounds.right?types_1.Direction.Right:bounds.top<activeCellBounds.top?types_1.Direction.Up:bounds.left<activeCellBounds.left?types_1.Direction.Left:types_1.Direction.Down;direction===types_1.Direction.Right&&(bounds={...activeCellBounds,right:bounds.right}),direction===types_1.Direction.Up&&(bounds={...activeCellBounds,top:bounds.top}),direction===types_1.Direction.Left&&(bounds={...activeCellBounds,left:bounds.left}),direction===types_1.Direction.Down&&(bounds={...activeCellBounds,bottom:bounds.bottom}),hasSelections&&((bounds,selection)=>bounds.top>=selection.top&&bounds.bottom<=selection.bottom&&bounds.left>=selection.left&&bounds.right<=selection.right)(bounds,selections[0].bounds)?setFillSelection(null):(setFillSelection({bounds:bounds}),gridRef.current.scrollToItem(coords))},[]),handleFillHandleMouseUp=react_1.useCallback(e=>{var _a;if(isFilling.current=!1,document.removeEventListener("mousemove",handleFillHandleMouseMove),document.removeEventListener("mouseup",handleFillHandleMouseUp),!gridRef||!activeCellRef.current)return;let fillSelection=null;setFillSelection(prev=>(fillSelection=prev,null));const selections=activeSelectionsRef.current,activeCell=activeCellRef.current;if(!activeCell||!fillSelection)return;const newBounds=null===(_a=fillSelection)||void 0===_a?void 0:_a.bounds;newBounds&&(onFill&&onFill(activeCell,fillSelection,selections),setSelections(prevSelection=>{const len=prevSelection.length;return len?prevSelection.map((sel,i)=>len-1===i?{...sel,bounds:newBounds}:sel):[{bounds:newBounds}]}))},[]),handleClearLastSelection=react_1.useCallback(()=>{setSelections(prev=>prev.slice(0,-1))},[]),fillHandleProps=react_1.useMemo(()=>({onMouseDown:handleFillHandleMouseDown}),[handleFillHandleMouseDown]);return{activeCell:activeCell,selections:selections,onMouseDown:handleMouseDown,onKeyDown:handleKeyDown,newSelection:newSelection,setSelections:setSelections,setActiveCell:handleSetActiveCell,setActiveCellState:setActiveCell,fillHandleProps:fillHandleProps,fillSelection:fillSelection,clearLastSelection:handleClearLastSelection,modifySelection:modifySelection,selectAll:selectAll,appendSelection:appendSelection,clearSelections:clearSelections}}},793:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ResizeStrategy=void 0;const react_1=__webpack_require__(1),helpers_1=__webpack_require__(61),tiny_invariant_1=__importDefault(__webpack_require__(249));var ResizeStrategy;!function(ResizeStrategy){ResizeStrategy.lazy="lazy",ResizeStrategy.full="full"}(ResizeStrategy=exports.ResizeStrategy||(exports.ResizeStrategy={}));const defaultGetText=text=>text;exports.default=({gridRef:gridRef,getValue:getValue,initialVisibleRows:initialVisibleRows=20,cellSpacing:cellSpacing=10,minColumnWidth:minColumnWidth=60,timeout:timeout=300,resizeStrategy:resizeStrategy=ResizeStrategy.lazy,rowCount:rowCount,resizeOnScroll:resizeOnScroll=!0,fontFamily:fontFamily="Arial",fontSize:fontSize=12,fontWeight:fontWeight="normal",fontStyle:fontStyle="italic",autoResize:autoResize=!0,columnSizes:columnSizes={},frozenRows:frozenRows=0,scale:scale=1,isHiddenRow:isHiddenRow,isHiddenColumn:isHiddenColumn,getText:getText=defaultGetText})=>{tiny_invariant_1.default(!(resizeStrategy===ResizeStrategy.full&&void 0===rowCount),"Row count should be specified if resize stragtegy is full");const autoSizer=react_1.useRef(helpers_1.AutoSizerCanvas({fontFamily:fontFamily,fontSize:fontSize,fontWeight:fontWeight,fontStyle:fontStyle})),[viewport,setViewport]=react_1.useState({rowStartIndex:0,rowStopIndex:0,columnStartIndex:0,columnStopIndex:0,visibleRowStartIndex:0,visibleRowStopIndex:0,visibleColumnStartIndex:0,visibleColumnStopIndex:0}),isMounted=react_1.useRef(!1),getValueRef=react_1.useRef(getValue),viewPortRef=react_1.useRef(viewport),hiddenRowRef=react_1.useRef(isHiddenRow),debounceResizer=react_1.useRef(helpers_1.debounce(({rowIndex:rowIndex,columnIndex:columnIndex})=>gridRef.current&&gridRef.current.resetAfterIndices({rowIndex:rowIndex,columnIndex:columnIndex}),timeout));react_1.useEffect(()=>{getValueRef.current=getValue,viewPortRef.current=viewport,hiddenRowRef.current=isHiddenRow}),react_1.useEffect(()=>{isMounted.current=!0},[]),react_1.useEffect(()=>{autoSizer.current.setFont({fontFamily:fontFamily,fontSize:fontSize,fontWeight:fontWeight,fontStyle:fontStyle})},[fontFamily,fontSize,fontWeight,fontStyle]);const getTextMetrics=react_1.useCallback(text=>autoSizer.current.measureText(text),[]),getCellWidth=react_1.useCallback((rowIndex,columnIndex)=>{var _a,_b;const cellValue=null!==(_a=getValueRef.current({rowIndex:rowIndex,columnIndex:columnIndex}))&&void 0!==_a?_a:null;let width=null!==(_b=null==cellValue?void 0:cellValue.spacing)&&void 0!==_b?_b:0;if(null!==cellValue){const isCellConfig="object"==typeof cellValue,text=getText(cellValue);if(void 0!==text&&!helpers_1.isNull(text)){if(autoSizer.current.reset(),isCellConfig){const isBold=cellValue.bold;autoSizer.current.setFont({fontWeight:isBold?"bold":"normal",fontSize:(cellValue.fontSize||fontSize)*scale,fontFamily:cellValue.fontFamily})}const metrics=autoSizer.current.measureText(text);metrics&&(width+=Math.ceil(metrics.width)+cellSpacing)}}return width},[scale]),getColumnWidth=react_1.useCallback(columnIndex=>{var _a,_b;const{rowStartIndex:rowStartIndex,rowStopIndex:rowStopIndex}=viewPortRef.current,visibleRows=resizeStrategy===ResizeStrategy.full?rowCount:rowStopIndex||initialVisibleRows;let start=resizeStrategy===ResizeStrategy.full?0:rowStartIndex,maxWidth=minColumnWidth;for(let i=0;i<frozenRows;i++){if(null===(_a=hiddenRowRef.current)||void 0===_a?void 0:_a.call(hiddenRowRef,i))continue;const width=getCellWidth(i,columnIndex);width>maxWidth&&(maxWidth=width)}for(;start<visibleRows;){if(null===(_b=hiddenRowRef.current)||void 0===_b?void 0:_b.call(hiddenRowRef,start)){start++;continue}const width=getCellWidth(start,columnIndex);width>maxWidth&&(maxWidth=width),start++}return maxWidth},[viewport,initialVisibleRows,frozenRows,scale]);return{...autoResize?{columnWidth:getColumnWidth}:void 0,getColumnWidth:getColumnWidth,onViewChange:react_1.useCallback(cells=>{if(setViewport(cells),resizeStrategy!==ResizeStrategy.full&&resizeOnScroll&&(cells.rowStartIndex!==viewport.rowStartIndex||cells.columnStartIndex!==viewport.columnStartIndex)&&gridRef.current){if(!isMounted.current)return;debounceResizer.current({rowIndex:cells.rowStartIndex,columnIndex:cells.columnStartIndex})}},[resizeOnScroll,viewport,resizeStrategy]),getTextMetrics:getTextMetrics}}},794:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__webpack_require__(1),scroller_1=__webpack_require__(795),helpers_1=__webpack_require__(61);exports.default=({gridRef:gridRef})=>{const scrollerRef=react_1.useRef(null),isTouchDevice=react_1.useRef(helpers_1.canUseDOM&&"ontouchstart"in window);react_1.useEffect(()=>{var _a,_b,_c,_d,_e,_f,_g;if(isTouchDevice.current){const options={scrollingX:!0,scrollingY:!0,decelerationRate:.95,penetrationAcceleration:.08};null===(_b=null===(_a=gridRef.current)||void 0===_a?void 0:_a.container)||void 0===_b||_b.addEventListener("touchstart",handleTouchStart),null===(_d=null===(_c=gridRef.current)||void 0===_c?void 0:_c.container)||void 0===_d||_d.addEventListener("touchend",handleTouchEnd),null===(_f=null===(_e=gridRef.current)||void 0===_e?void 0:_e.container)||void 0===_f||_f.addEventListener("touchmove",handleTouchMove),scrollerRef.current=new scroller_1.Scroller(handleTouchScroll,options);const dims=null===(_g=gridRef.current)||void 0===_g?void 0:_g.getDimensions();updateScrollDimensions(dims)}},[]);const scrollTo=react_1.useCallback(({scrollLeft:scrollLeft,scrollTop:scrollTop})=>{scrollerRef.current&&scrollerRef.current.scrollTo(scrollLeft,scrollTop)},[]),scrollToTop=react_1.useCallback(()=>{scrollerRef.current&&scrollerRef.current.scrollTo(0,0)},[]),updateScrollDimensions=react_1.useCallback(({containerWidth:containerWidth,containerHeight:containerHeight,estimatedTotalWidth:estimatedTotalWidth,estimatedTotalHeight:estimatedTotalHeight})=>{scrollerRef.current.setDimensions(containerWidth,containerHeight,estimatedTotalWidth,estimatedTotalHeight)},[]),handleTouchScroll=react_1.useCallback((scrollLeft,scrollTop)=>{var _a;null===(_a=gridRef.current)||void 0===_a||_a.scrollTo({scrollTop:scrollTop,scrollLeft:scrollLeft})},[]),handleTouchStart=react_1.useCallback(e=>{scrollerRef.current.doTouchStart(e.touches,e.timeStamp)},[]),handleTouchMove=react_1.useCallback(e=>{e.preventDefault(),scrollerRef.current.doTouchMove(e.touches,e.timeStamp)},[]),handleTouchEnd=react_1.useCallback(e=>{scrollerRef.current.doTouchEnd(e.timeStamp)},[]);return{isTouchDevice:isTouchDevice.current,scrollTo:scrollTo,scrollToTop:scrollToTop}}},797:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__webpack_require__(1),helpers_1=__webpack_require__(61),types_1=__webpack_require__(62);exports.default=({selections:selections=[],activeCell:activeCell=null,getValue:getValue,gridRef:gridRef,onPaste:onPaste,onCut:onCut})=>{const selectionRef=react_1.useRef({selections:selections,activeCell:activeCell,getValue:getValue}),cutSelections=react_1.useRef(null);react_1.useEffect(()=>{selectionRef.current={selections:selections,activeCell:activeCell,getValue:getValue}});const currentSelections=()=>{const sel=selectionRef.current.selections.length?selectionRef.current.selections:helpers_1.selectionFromActiveCell(selectionRef.current.activeCell);return sel[sel.length-1]};react_1.useEffect(()=>{gridRef.current&&(document.addEventListener("copy",e=>{var _a;(null===(_a=gridRef.current)||void 0===_a?void 0:_a.container)===document.activeElement&&handleCopy(e)}),document.addEventListener("paste",e=>{var _a;(null===(_a=gridRef.current)||void 0===_a?void 0:_a.container)===document.activeElement&&handlePaste(e)}),document.addEventListener("cut",e=>{var _a;(null===(_a=gridRef.current)||void 0===_a?void 0:_a.container)===document.activeElement&&(cutSelections.current=currentSelections(),handleCopy(e))}))},[]);const handleCut=react_1.useCallback(()=>{cutSelections.current=currentSelections(),handleProgramaticCopy()},[]),handleCopy=react_1.useCallback(e=>{var _a,_b,_c,_d,_e;const{bounds:bounds}=currentSelections(),{top:top,left:left,right:right,bottom:bottom}=bounds,rows=[];for(let i=top;i<=bottom;i++){const row=[];for(let j=left;j<=right;j++){const value=null!==(_a=selectionRef.current.getValue({rowIndex:i,columnIndex:j}))&&void 0!==_a?_a:"";row.push(value)}rows.push(row)}const[html,csv]=helpers_1.prepareClipboardData(rows);null===(_b=e.clipboardData)||void 0===_b||_b.setData(types_1.MimeType.html,html),null===(_c=e.clipboardData)||void 0===_c||_c.setData(types_1.MimeType.plain,csv),null===(_d=e.clipboardData)||void 0===_d||_d.setData(types_1.MimeType.csv,csv),null===(_e=e.clipboardData)||void 0===_e||_e.setData(types_1.MimeType.json,JSON.stringify(rows)),e.preventDefault()},[currentSelections]),handlePaste=e=>{var _a,_b;if(!(null===(_a=e.clipboardData)||void 0===_a?void 0:_a.items))return;const mimeTypes=[types_1.MimeType.html,types_1.MimeType.csv,types_1.MimeType.plain];let type,value;for(type of mimeTypes)if(value=null===(_b=e.clipboardData)||void 0===_b?void 0:_b.getData(type),value)break;if(!type||!value)return void console.warn("No clipboard data to paste");const rows=[];if(/^text\/html/.test(type)){const doc=(new DOMParser).parseFromString(value,type),supportedNodes="table, p, h1, h2, h3, h4, h5, h6",nodes=doc.querySelectorAll(supportedNodes);for(let i=0;i<nodes.length;i++){const node=nodes[i];if("TABLE"===node.nodeName){const tableRows=doc.querySelectorAll("tr");for(let i=0;i<tableRows.length;i++){const row=[],cells=tableRows[i].querySelectorAll("td");for(let j=0;j<cells.length;j++){const cell=cells[j];row.push(cell.textContent)}rows.push(row)}}else rows.push([node.textContent])}}else{const values=value.split("\n");for(const val of values){const row=[];for(const cell of val.split(","))row.push(cell.replace(/^\"|\"$/gi,""));rows.push(row)}}onPaste&&onPaste(rows,selectionRef.current.activeCell),cutSelections.current&&(onCut&&onCut(cutSelections.current),cutSelections.current=null)},handleProgramaticCopy=react_1.useCallback(()=>{gridRef.current&&(gridRef.current.focus(),console.log("called"),document.execCommand("copy"))},[]),handleProgramaticPaste=react_1.useCallback(async()=>{if(!gridRef.current)return;gridRef.current.focus();const text=await navigator.clipboard.readText(),clipboardData=new DataTransfer;clipboardData.setData(types_1.MimeType.plain,text);const event=new ClipboardEvent("paste",{clipboardData:clipboardData});handlePaste(event)},[]);return{copy:handleProgramaticCopy,paste:handleProgramaticPaste,cut:handleCut}}},798:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(1)),PaginationComponent=({currentPage:currentPage,goToFirst:goToFirst,goToLast:goToLast,goToPage:goToPage,totalPages:totalPages,nextPage:nextPage,prevPage:prevPage})=>{const pages=[];for(let i=1;i<=totalPages;i++){const isActive=currentPage===i;pages.push(react_1.default.createElement("button",{onClick:()=>goToPage(i)},isActive?react_1.default.createElement("strong",null,i):i))}return react_1.default.createElement("div",null,react_1.default.createElement("button",{onClick:goToFirst,disabled:1===currentPage},"First page"),react_1.default.createElement("button",{onClick:prevPage,disabled:1===currentPage},"Prev page"),pages,react_1.default.createElement("button",{onClick:nextPage,disabled:currentPage===totalPages},"Next page"),react_1.default.createElement("button",{onClick:goToLast,disabled:currentPage===totalPages},"Last page"))};exports.default=props=>{const{initialCurrentPage:initialCurrentPage=1,pageSize:pageSize=10,total:total=0,onChange:onChange,component:component=PaginationComponent}=props,[currentPage,setCurrentPage]=react_1.useState(initialCurrentPage),totalPages=Math.ceil(total/pageSize);react_1.useEffect(()=>{onChange&&onChange(currentPage)},[currentPage]);const pageProps={currentPage:currentPage,totalPages:totalPages,nextPage:()=>setCurrentPage(prev=>Math.min(prev+1,totalPages)),prevPage:()=>setCurrentPage(prev=>Math.max(prev-1,1)),goToFirst:()=>setCurrentPage(1),goToLast:()=>setCurrentPage(totalPages),goToPage:page=>setCurrentPage(page),pageSize:pageSize};return{paginationComponent:react_1.default.createElement(component,pageProps),...pageProps}}},799:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Default",(function(){return Default}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_exports__.default={title:"Copy Paste",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a};var Default=function Default(){var App=function App(){var _useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(_defineProperty({},[1,2],"Hello world")),2),data=_useState2[0],setData=_useState2[1],gridRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),getValue=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(_ref){var rowIndex=_ref.rowIndex,columnIndex=_ref.columnIndex;return data[[rowIndex,columnIndex]]}),[data]),_useSelection=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.useSelection)({gridRef:gridRef,columnCount:100,rowCount:100}),activeCell=_useSelection.activeCell,selections=_useSelection.selections,setSelections=_useSelection.setSelections,selectionProps=_objectWithoutProperties(_useSelection,["activeCell","selections","setSelections"]),_useCopyPaste=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.useCopyPaste)({gridRef:gridRef,selections:selections,activeCell:activeCell,getValue:getValue,onPaste:function onPaste(rows,activeCell){var _step,rowIndex=activeCell.rowIndex,columnIndex=activeCell.columnIndex,endRowIndex=Math.max(rowIndex,rowIndex+rows.length-1),endColumnIndex=Math.max(columnIndex,columnIndex+(rows.length&&rows[0].length-1)),changes={},_iterator=_createForOfIteratorHelper(rows.entries());try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step2,_step$value=_slicedToArray(_step.value,2),i=_step$value[0],_iterator2=_createForOfIteratorHelper(_step$value[1].entries());try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _step2$value=_slicedToArray(_step2.value,2),j=_step2$value[0],cell=_step2$value[1];changes[[rowIndex+i,columnIndex+j]]=cell}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}catch(err){_iterator.e(err)}finally{_iterator.f()}setData((function(prev){return _objectSpread(_objectSpread({},prev),changes)})),rowIndex===endRowIndex&&columnIndex===endColumnIndex||setSelections([{bounds:{top:rowIndex,left:columnIndex,bottom:endRowIndex,right:endColumnIndex}}])},onCut:function onCut(selection){for(var bounds=selection.bounds,changes={},i=bounds.top;i<=bounds.bottom;i++)for(var j=bounds.left;j<=bounds.right;j++)changes[[i,j]]=void 0;setData((function(prev){return _objectSpread(_objectSpread({},prev),changes)}))}}),copy=_useCopyPaste.copy,paste=_useCopyPaste.paste;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("button",{onClick:function onClick(){return copy()}},"Copy"),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("button",{onClick:function onClick(){return paste()}},"Paste"),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,_extends({activeCell:activeCell,selections:selections,ref:gridRef,rowCount:100,columnCount:100,columnWidth:function columnWidth(){return 100},itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.Cell,_extends({},props,{value:data[[props.rowIndex,props.columnIndex]]}))}},selectionProps)))};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)};Default.story={name:"Copy cells"}},800:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"CanvasOverlay",(function(){return CanvasOverlay})),__webpack_require__.d(__webpack_exports__,"ChartJs",(function(){return ChartJs}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),react_konva__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(10),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(6),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_2__);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_exports__.default={title:"Overlays",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_2___default.a};var Resizable=function Resizable(_ref){var scrollTop=_ref.scrollTop,scrollLeft=_ref.scrollLeft,isSelected=_ref.isSelected,onSelect=_ref.onSelect,trRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),shapeRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)();Object(react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){isSelected&&(trRef.current.attachTo(shapeRef.current),trRef.current.getLayer().batchDraw())}),[isSelected]);var _useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)({x:100,y:100,width:100,height:100}),2),dimensions=_useState2[0],setDimensions=_useState2[1],x=dimensions.x-scrollLeft,y=dimensions.y-scrollTop;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_1__.Rect,{onMouseDown:onSelect,ref:shapeRef,draggable:!0,onDragEnd:function onDragEnd(e){setDimensions((function(prev){return _objectSpread(_objectSpread({},prev),{},{x:e.target.x()+scrollLeft,y:e.target.y()+scrollTop})}))},onTransformEnd:function onTransformEnd(e){var node=shapeRef.current,scaleX=node.scaleX(),scaleY=node.scaleY();node.scaleX(1),node.scaleY(1),setDimensions({x:node.x(),y:node.y(),width:Math.max(5,node.width()*scaleX),height:Math.max(node.height()*scaleY)})},fill:"lightblue",stroke:"#aaa",strokeWidth:1,x:x,y:y,width:dimensions.width,height:dimensions.height}),isSelected&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_1__.Transformer,{ref:trRef,rotateEnabled:!1,boundBoxFunc:function boundBoxFunc(oldBox,newBox){return newBox.width<5||newBox.height<5?oldBox:newBox}}))},CanvasOverlay=function CanvasOverlay(){var App=function App(){var _useState4=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),isSelected=_useState4[0],setIsSelected=_useState4[1];return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_2___default.a,{rowCount:100,columnCount:100,stageProps:{onMouseDown:function handleMouseDown(e){!0!==e.target.attrs.draggable&&setIsSelected(!1)}}},(function(_ref2){var scrollTop=_ref2.scrollTop,scrollLeft=_ref2.scrollLeft;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_1__.Layer,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Resizable,{scrollTop:scrollTop,scrollLeft:scrollLeft,isSelected:isSelected,onSelect:function onSelect(){setIsSelected(!0)}}))}))};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)},ChartJSLayer=function ChartJSLayer(){var canvasRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),_useReducer2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_0__.useReducer)((function(s){return s+1}),0),2),forceRender=(_useReducer2[0],_useReducer2[1]);return Object(react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){canvasRef.current=document.createElement("canvas"),canvasRef.current.width=600,canvasRef.current.height=400,document.body.appendChild(canvasRef.current);var ctx=canvasRef.current.getContext("2d");new Chart(ctx,{type:"bar",data:{labels:["January","February","March","April","May","June","July"],datasets:[{label:"My First dataset",backgroundColor:"rgb(255, 99, 132)",borderColor:"rgb(255, 99, 132)",data:[0,10,5,2,20,30,45]}]},options:{animation:!1}});document.body.removeChild(canvasRef.current),forceRender()}),[]),canvasRef.current?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_1__.Image,{image:canvasRef.current,draggable:!0,fill:"white",stroke:"#aaa",x:100,y:100,width:600,height:400}):null},ChartJs=function ChartJs(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_2___default.a,{rowCount:100,columnCount:100},(function(_ref3){_ref3.scrollTop,_ref3.scrollLeft;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_1__.Layer,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(ChartJSLayer,null))}))}},801:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Pagination",(function(){return Pagination}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}__webpack_exports__.default={title:"Pagination",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a};var Pagination=function Pagination(){var App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),_useSelection=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.useSelection)({gridRef:gridRef}),selections=_useSelection.selections,selectionProps=_objectWithoutProperties(_useSelection,["selections"]),_usePagination=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.usePagination)({pageSize:8,total:100,onChange:function onChange(page){}}),currentPage=_usePagination.currentPage,paginationComponent=_usePagination.paginationComponent;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,_extends({ref:gridRef,rowCount:8,columnCount:100,selections:selections,rowHeight:function rowHeight(){return 60},itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.Cell,_extends({},props,{padding:0,value:"Page: ".concat(currentPage," Row: ").concat(props.rowIndex+8*(currentPage-1))}))}},selectionProps)),paginationComponent)};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)};Pagination.story={name:"Pagination"}},802:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Default",(function(){return Default})),__webpack_require__.d(__webpack_exports__,"Import",(function(){return Import})),__webpack_require__.d(__webpack_exports__,"ExportToExcel",(function(){return ExportToExcel})),__webpack_require__.d(__webpack_exports__,"FilterViews",(function(){return FilterViews})),__webpack_require__.d(__webpack_exports__,"DataValidation",(function(){return DataValidation})),__webpack_require__.d(__webpack_exports__,"UsingStateReducer",(function(){return UsingStateReducer})),__webpack_require__.d(__webpack_exports__,"CustomDataType",(function(){return CustomDataType}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(42),_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_1__),_rowsncolumns_export__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(133);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_exports__.default={title:"Spreadsheet",component:_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_1___default.a};var Default=function Default(){var App=function App(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{style:{margin:10,display:"flex",flexDirection:"column",minHeight:800}},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_1___default.a,{onChange:function onChange(){}}))};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)},Import=function Import(){var App=function App(){var _useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_1__.defaultSheets),2),sheets=_useState2[0],setSheets=_useState2[1],handleChangeFile=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(e){(function(){var _ref2=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(file){var newSheets;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,Object(_rowsncolumns_export__WEBPACK_IMPORTED_MODULE_2__.parse)({file:file});case 2:newSheets=_context.sent,setSheets(newSheets.sheets);case 4:case"end":return _context.stop()}}),_callee)})));return function getSheets(_x){return _ref2.apply(this,arguments)}})()(e.target.files[0])}),[]);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{style:{margin:10,display:"flex",flexDirection:"column",minHeight:800}},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("form",{id:"testForm"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("input",{type:"file",name:"test",id:"testFile",onChange:handleChangeFile})),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("button",{onClick:function onClick(){return Object(_rowsncolumns_export__WEBPACK_IMPORTED_MODULE_2__.download)({sheets:sheets,filename:"Hello"})}},"Download Excel"),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("button",{onClick:function onClick(){return Object(_rowsncolumns_export__WEBPACK_IMPORTED_MODULE_2__.download)({sheets:sheets,filename:"Hello",type:"csv"})}},"Download CSV")),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_1___default.a,{sheets:sheets}))};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)};Import.story={name:"Import excel file"};var ExportToExcel=function ExportToExcel(){var App=function App(){var _useState4=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_1__.defaultSheets),2),sheets=_useState4[0],setSheets=_useState4[1],handleExport=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(_ref3){var sheets=_ref3.sheets;Object(_rowsncolumns_export__WEBPACK_IMPORTED_MODULE_2__.download)({sheets:sheets,filename:"Report"})}),[]);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("br",null),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("button",{onClick:function onClick(){return handleExport({sheets:sheets})}},"Export to excel"),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{style:{margin:10,display:"flex",flexDirection:"column",minHeight:600}},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_1___default.a,{sheets:sheets,onChange:setSheets})))};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)};ExportToExcel.story={name:"Export excel file"};var FilterViews=function FilterViews(){var App=function App(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_1___default.a,{sheets:[{name:"Sheet 1",id:0,frozenRows:1,frozenColumns:1,hiddenRows:[],activeCell:null,selections:[],cells:{1:{1:{text:"First Name"},2:{text:"Last Name"},3:{text:"Gender"}},2:{1:{text:"Dulce"},2:{text:"Abril"},3:{text:"Female"}},3:{1:{text:"Mara"},2:{text:"Hashimoto"},3:{text:"Male"}},4:{1:{text:"EMara"},2:{text:"Hashimoto"},3:{text:"Male"}},5:{5:{text:"First name"},6:{text:"Last name"},7:{text:"Gender"}},6:{5:{text:"EMara"},6:{text:"Hashimoto"},7:{text:"Male"}}},filterViews:[{bounds:{top:1,bottom:5,left:1,right:3}},{bounds:{top:5,bottom:8,left:5,right:7}}]}]})};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)},initialValidationSheet=[{name:"Sheet 1",id:0,activeCell:null,selections:[],cells:{2:{2:{text:"",valid:!1,dataValidation:{prompt:"Enter a country",type:"list",formulae:["Singapore","Japan","China"]}}},3:{2:{text:"",valid:!1,dataValidation:{prompt:"Something went wrong",allowBlank:!0,formulae:[10,100],operator:"between",type:"decimal"}}},4:{2:{text:"TRUE",datatype:"boolean",dataValidation:{allowBlank:!0,type:"boolean",prompt:"Invalid entry",formulae:["TRUE","FALSE"]}}},5:{2:{datatype:"hyperlink",text:"Hello world",color:"#1155CC",underline:!0,hyperlink:"http://google.com"}},6:{2:{datatype:"formula",text:"=SUM(A1,A2)",result:"4",error:"#VALUE!"}},7:{2:{text:"tooltip",tooltip:"hello world"},3:{text:"12",dataValidation:{type:"decimal",operator:"between",formulae:[0,10],prompt:"Please enter a valid number between 0 and 10"}}}}}],DataValidation=function DataValidation(){var App=function App(){var _useState6=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(initialValidationSheet),2),sheets=_useState6[0],setSheets=_useState6[1];return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{style:{margin:10,display:"flex",flexDirection:"column",minHeight:800}},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_1___default.a,{sheets:sheets,onChange:setSheets})))};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)},UsingStateReducer=function UsingStateReducer(){var App=function App(){var _useState8=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(),2),sheets=_useState8[0],stateReducer=(_useState8[1],Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(state,action){return console.log(state,action),state}),[]));return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{style:{margin:10,display:"flex",flexDirection:"column",minHeight:800}},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_1___default.a,{sheets:sheets,stateReducer:stateReducer})))};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)},CustomDataType=function CustomDataType(){var App=function App(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_1___default.a,{sheets:[{name:"Sheet 1",id:1,activeCell:null,selections:[],cells:{1:{2:{datatype:"boolean",type:"hello"}}}}]})};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)}},803:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const Toolbar_1=__importDefault(__webpack_require__(804));exports.default=Toolbar_1.default},804:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(1)),md_1=__webpack_require__(170),bs_1=__webpack_require__(805),io_1=__webpack_require__(806),core_1=__webpack_require__(33),styled_1=__webpack_require__(89),constants_1=__webpack_require__(30),types_1=__webpack_require__(90),translations_1=__webpack_require__(398),react_color_1=__webpack_require__(836),core_2=__webpack_require__(2),Select_1=__importDefault(__webpack_require__(926)),ColorPicker=({color:color,onChange:onChange,resetLabel:resetLabel="Reset"})=>react_1.default.createElement(core_1.Box,{pb:2},react_1.default.createElement(core_2.Global,{styles:core_2.css`
          .circle-picker div[title="#efefef"],
          .circle-picker div[title="#f3f3f3"],
          .circle-picker div[title="#ffffff"] {
            border: 1px solid #dadce0;
            border-radius: 50%;
          }
        `}),react_1.default.createElement(styled_1.Button,{variant:"ghost",isFullWidth:!0,justifyContent:"left",size:"sm",mb:2,onClick:()=>onChange(void 0),background:"none"},react_1.default.createElement(core_1.Box,{mr:2},react_1.default.createElement(md_1.MdFormatColorReset,null)),resetLabel),react_1.default.createElement(react_color_1.CirclePicker,{color:color,onChangeComplete:e=>onChange(e.hex),circleSpacing:5,circleSize:20,width:"260px",colors:["#000000","#434343","#666666","#999999","#b7b7b7","#cccccc","#d9d9d9","#efefef","#f3f3f3","#ffffff","#980000","#ff0000","#ff9900","#ffff00","#00ff00","#00ffff","#4a86e8","#0000ff","#9900ff","#ff00ff","#e6b8af","#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#c9daf8","#cfe2f3","#d9d2e9","#ead1dc","#dd7e6b","#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#a4c2f4","#9fc5e8","#b4a7d6","#d5a6bd","#cc4125","#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6d9eeb","#6fa8dc","#8e7cc3","#c27ba0","#a61c00","#cc0000","#e69138","#f1c232","#6aa84f","#45818e","#3c78d8","#3d85c6","#674ea7","#a64d79","#85200c","#990000","#b45f06","#bf9000","#38761d","#134f5c","#1155cc","#0b5394","#351c75","#741b47","#5b0f00","#660000","#783f04","#7f6000","#274e13","#0c343d","#1c4587","#073763","#20124d","#4c1130"]})),BorderSelection=({iconColor:iconColor,activeIconColor:activeIconColor,onBorderChange:onBorderChange,isLight:isLight})=>{const[borderColor,setBorderColor]=react_1.useState("#000000"),[borderVariant,setBorderVariant]=react_1.useState(),[borderStyle,setBorderStyle]=react_1.useState(types_1.BORDER_STYLE.THIN),theme=core_1.useTheme(),handleChangeVariant=value=>{setBorderVariant(value),null==onBorderChange||onBorderChange(borderColor,borderStyle,value)},handleChangeBorderStyle=value=>{setBorderStyle(value)},bgColor=isLight?theme.colors.gray[100]:theme.colors.gray[600],contentBorderColor=isLight?theme.colors.gray[300]:theme.colors.gray[600];return react_1.default.createElement(core_1.Popover,{usePortal:!0,placement:"auto-start",onClose:()=>{setBorderVariant(void 0)}},react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.borders,label:translations_1.translations.borders,placement:"bottom-start"},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.borders,variant:"ghost",color:iconColor,icon:md_1.MdBorderAll,fontSize:20,size:"sm"})))),react_1.default.createElement(styled_1.PopoverContent,{width:230,borderColor:contentBorderColor,borderStyle:"solid"},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.Box,{display:"flex"},react_1.default.createElement(core_1.Box,{flex:1,display:"flex",p:2,flexWrap:"wrap",width:180},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_all,background:borderVariant===types_1.BORDER_VARIANT.ALL?bgColor:"none",variant:borderVariant===types_1.BORDER_VARIANT.ALL?"solid":"ghost",color:borderVariant===types_1.BORDER_VARIANT.ALL?activeIconColor:iconColor,onClick:()=>handleChangeVariant(types_1.BORDER_VARIANT.ALL),icon:md_1.MdBorderAll,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_inner,background:borderVariant===types_1.BORDER_VARIANT.INNER?bgColor:"none",variant:borderVariant===types_1.BORDER_VARIANT.INNER?"solid":"ghost",color:borderVariant===types_1.BORDER_VARIANT.INNER?activeIconColor:iconColor,onClick:()=>handleChangeVariant(types_1.BORDER_VARIANT.INNER),icon:md_1.MdBorderInner,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_horizontal,background:borderVariant===types_1.BORDER_VARIANT.HORIZONTAL?bgColor:"none",variant:borderVariant===types_1.BORDER_VARIANT.HORIZONTAL?"solid":"ghost",color:borderVariant===types_1.BORDER_VARIANT.HORIZONTAL?activeIconColor:iconColor,onClick:()=>handleChangeVariant(types_1.BORDER_VARIANT.HORIZONTAL),icon:md_1.MdBorderHorizontal,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_vertical,background:borderVariant===types_1.BORDER_VARIANT.VERTICAL?bgColor:"none",variant:borderVariant===types_1.BORDER_VARIANT.VERTICAL?"solid":"ghost",color:borderVariant===types_1.BORDER_VARIANT.VERTICAL?activeIconColor:iconColor,onClick:()=>handleChangeVariant(types_1.BORDER_VARIANT.VERTICAL),icon:md_1.MdBorderVertical,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_outer,background:borderVariant===types_1.BORDER_VARIANT.OUTER?bgColor:"none",variant:borderVariant===types_1.BORDER_VARIANT.OUTER?"solid":"ghost",color:borderVariant===types_1.BORDER_VARIANT.OUTER?activeIconColor:iconColor,onClick:()=>handleChangeVariant(types_1.BORDER_VARIANT.OUTER),icon:md_1.MdBorderOuter,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_left,background:borderVariant===types_1.BORDER_VARIANT.LEFT?bgColor:"none",variant:borderVariant===types_1.BORDER_VARIANT.LEFT?"solid":"ghost",color:borderVariant===types_1.BORDER_VARIANT.LEFT?activeIconColor:iconColor,onClick:()=>handleChangeVariant(types_1.BORDER_VARIANT.LEFT),icon:md_1.MdBorderLeft,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_right,background:borderVariant===types_1.BORDER_VARIANT.RIGHT?bgColor:"none",variant:borderVariant===types_1.BORDER_VARIANT.RIGHT?"solid":"ghost",color:borderVariant===types_1.BORDER_VARIANT.RIGHT?activeIconColor:iconColor,onClick:()=>handleChangeVariant(types_1.BORDER_VARIANT.RIGHT),icon:md_1.MdBorderRight,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_top,background:borderVariant===types_1.BORDER_VARIANT.TOP?bgColor:"none",variant:borderVariant===types_1.BORDER_VARIANT.TOP?"solid":"ghost",color:borderVariant===types_1.BORDER_VARIANT.TOP?activeIconColor:iconColor,onClick:()=>handleChangeVariant(types_1.BORDER_VARIANT.TOP),icon:md_1.MdBorderTop,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_bottom,background:borderVariant===types_1.BORDER_VARIANT.BOTTOM?bgColor:"none",variant:borderVariant===types_1.BORDER_VARIANT.BOTTOM?"solid":"ghost",color:borderVariant===types_1.BORDER_VARIANT.BOTTOM?activeIconColor:iconColor,onClick:()=>handleChangeVariant(types_1.BORDER_VARIANT.BOTTOM),icon:md_1.MdBorderBottom,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_none,background:borderVariant===types_1.BORDER_VARIANT.NONE?bgColor:"none",variant:borderVariant===types_1.BORDER_VARIANT.NONE?"solid":"ghost",color:borderVariant===types_1.BORDER_VARIANT.NONE?activeIconColor:iconColor,onClick:()=>handleChangeVariant(types_1.BORDER_VARIANT.NONE),icon:md_1.MdBorderClear,fontSize:20,size:"sm"})),react_1.default.createElement(core_1.Box,{p:2,borderLeft:bgColor,borderLeftWidth:1,borderLeftStyle:"solid",flexDirection:"column",display:"flex"},react_1.default.createElement(core_1.Popover,{placement:"top-start"},({onClose:onClose})=>react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.border_color,label:translations_1.translations.border_color},react_1.default.createElement(styled_1.Button,{size:"sm",color:iconColor,variant:"ghost",pl:0,pr:0,flexDirection:"column","aria-label":translations_1.translations.border_color,background:"none"},react_1.default.createElement(md_1.MdEdit,null),react_1.default.createElement(styled_1.Rect,{color:borderColor}))))),react_1.default.createElement(styled_1.PopoverContent,{zIndex:1,width:280,borderColor:contentBorderColor,borderStyle:"solid"},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.PopoverBody,null,react_1.default.createElement(ColorPicker,{color:borderColor,onChange:value=>{(value=>{setBorderColor(value)})(value),null==onClose||onClose()},resetLabel:"No borders"}))))),react_1.default.createElement(core_1.Popover,{placement:"top-start"},({onClose:onClose})=>react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.border_style,label:translations_1.translations.border_style},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_style,variant:"ghost",color:iconColor,icon:md_1.MdLineStyle,fontSize:20,size:"sm"})))),react_1.default.createElement(styled_1.PopoverContent,{width:100,borderColor:contentBorderColor,borderStyle:"solid"},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.PopoverBody,null,react_1.default.createElement(styled_1.Button,{background:borderStyle===types_1.BORDER_STYLE.THIN?bgColor:"none",variant:borderStyle===types_1.BORDER_STYLE.THIN?"solid":"ghost",color:borderStyle===types_1.BORDER_STYLE.THIN?activeIconColor:iconColor,size:"sm",onClick:()=>{handleChangeBorderStyle(types_1.BORDER_STYLE.THIN),null==onClose||onClose()}},react_1.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"1",style:{userSelect:"none"}},react_1.default.createElement("line",{x1:"0",y1:"0.5",x2:"50",y2:"0.5",strokeWidth:"1",stroke:"black",style:{userSelect:"none"}}))),react_1.default.createElement(styled_1.Button,{background:borderStyle===types_1.BORDER_STYLE.MEDIUM?bgColor:"none",variant:borderStyle===types_1.BORDER_STYLE.MEDIUM?"solid":"ghost",color:borderStyle===types_1.BORDER_STYLE.MEDIUM?activeIconColor:iconColor,size:"sm",onClick:()=>{handleChangeBorderStyle(types_1.BORDER_STYLE.MEDIUM),null==onClose||onClose()}},react_1.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"2",style:{userSelect:"none"}},react_1.default.createElement("line",{x1:"0",y1:"1.0",x2:"50",y2:"1.0",strokeWidth:"2",stroke:"black",style:{userSelect:"none"}}))),react_1.default.createElement(styled_1.Button,{background:borderStyle===types_1.BORDER_STYLE.THICK?bgColor:"none",variant:borderStyle===types_1.BORDER_STYLE.THICK?"solid":"ghost",color:borderStyle===types_1.BORDER_STYLE.THICK?activeIconColor:iconColor,size:"sm",onClick:()=>{handleChangeBorderStyle(types_1.BORDER_STYLE.THICK),null==onClose||onClose()}},react_1.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"3",style:{userSelect:"none"}},react_1.default.createElement("line",{x1:"0",y1:"1.5",x2:"50",y2:"1.5",strokeWidth:"3",stroke:"black",style:{userSelect:"none"}}))),react_1.default.createElement(styled_1.Button,{background:borderStyle===types_1.BORDER_STYLE.DASHED?bgColor:"none",variant:borderStyle===types_1.BORDER_STYLE.DASHED?"solid":"ghost",color:borderStyle===types_1.BORDER_STYLE.DASHED?activeIconColor:iconColor,size:"sm",onClick:()=>{handleChangeBorderStyle(types_1.BORDER_STYLE.DASHED),null==onClose||onClose()}},react_1.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"1",style:{userSelect:"none"}},react_1.default.createElement("line",{x1:"0",y1:"0.5",x2:"50",y2:"0.5",strokeWidth:"1",stroke:"black",strokeDasharray:"2",style:{userSelect:"none"}}))),react_1.default.createElement(styled_1.Button,{background:borderStyle===types_1.BORDER_STYLE.DOTTED?bgColor:"none",variant:borderStyle===types_1.BORDER_STYLE.DOTTED?"solid":"ghost",color:borderStyle===types_1.BORDER_STYLE.DOTTED?activeIconColor:iconColor,size:"sm",onClick:()=>{handleChangeBorderStyle(types_1.BORDER_STYLE.DOTTED),null==onClose||onClose()}},react_1.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"1",style:{userSelect:"none"}},react_1.default.createElement("line",{x1:"0",y1:"0.5",x2:"50",y2:"0.5",strokeWidth:"1",stroke:"black",strokeDasharray:"1",style:{userSelect:"none"}})))))))))))};exports.default=props=>{const{bold:bold,italic:italic,fill:fill,underline:underline,strike:strike,color:color,verticalAlign:verticalAlign,horizontalAlign:horizontalAlign,onFormattingChange:onFormattingChange,onClearFormatting:onClearFormatting,percent:percent,currency:currency,onMergeCells:onMergeCells,onFrozenColumnChange:onFrozenColumnChange,onFrozenRowChange:onFrozenRowChange,frozenRows:frozenRows=0,frozenColumns:frozenColumns=0,onBorderChange:onBorderChange,canUndo:canUndo,canRedo:canRedo,onRedo:onRedo,onUndo:onUndo,enableDarkMode:enableDarkMode,fontSize:fontSize=constants_1.DEFAULT_FONT_SIZE,fontFamily:fontFamily=constants_1.DEFAULT_FONT_FAMILY,format:format,onFormattingChangeAuto:onFormattingChangeAuto,onFormattingChangePlain:onFormattingChangePlain,plaintext:plaintext,scale:scale=1,onScaleChange:onScaleChange,fontList:fontList=[],wrap:wrap="clip"}=props,{colorMode:colorMode,toggleColorMode:toggleColorMode}=core_1.useColorMode(),theme=core_1.useTheme(),isLight="light"===colorMode,activeIconColor=theme.colors.teal[500],iconColor=isLight?theme.colors.gray[600]:theme.colors.gray[50],borderColor=isLight?theme.colors.gray[300]:theme.colors.gray[600],backgroundColor=isLight?"white":constants_1.DARK_MODE_COLOR,foregroundColor=isLight?constants_1.DARK_MODE_COLOR:"white";return react_1.default.createElement(styled_1.StyledToolbar,{pr:2,pl:2,pt:1,pb:1,borderColor:borderColor,backgroundColor:backgroundColor,color:foregroundColor},react_1.default.createElement(core_1.Flex,{flex:1,alignItems:"center",flexWrap:"wrap",minWidth:1},react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.undo,label:translations_1.translations.undo,placement:"bottom-start"},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.undo,variant:"ghost",color:iconColor,icon:md_1.MdUndo,size:"sm",height:"28px",isDisabled:!canUndo,onClick:onUndo})),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.redo,label:translations_1.translations.redo,placement:"bottom-start"},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.redo,variant:"ghost",color:iconColor,icon:md_1.MdRedo,size:"sm",height:"28px",isDisabled:!canRedo,onClick:onRedo})),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.clear_formatting,label:translations_1.translations.clear_formatting},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.clear_formatting,variant:"ghost",color:iconColor,icon:md_1.MdFormatClear,size:"sm",height:"28px",onClick:()=>null==onClearFormatting?void 0:onClearFormatting()})),react_1.default.createElement(styled_1.Separator,{borderColor:borderColor}),react_1.default.createElement(core_1.Menu,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.zoom,label:translations_1.translations.zoom},react_1.default.createElement(core_1.MenuButton,{color:foregroundColor,as:styled_1.Button,size:"sm",flexShrink:0,paddingLeft:1,paddingRight:1,background:"none",fontSize:12,height:"28px"},100*scale+"%",react_1.default.createElement(core_1.Icon,{name:"chevron-down",ml:1,fontSize:16}))),react_1.default.createElement(core_1.MenuList,{placement:"top-start",minWidth:100,borderColor:borderColor,borderStyle:"solid",fontSize:14},constants_1.SCALE_VALUES.map(({label:label,value:value})=>react_1.default.createElement(styled_1.MenuItem,{key:value,onClick:()=>{null==onScaleChange||onScaleChange(value)}},react_1.default.createElement(core_1.Box,{width:"24px"},value===scale&&react_1.default.createElement(core_1.Icon,{name:"check",mr:1})),label)))),react_1.default.createElement(styled_1.Separator,{borderColor:borderColor}),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.format_as_currency,label:translations_1.translations.format_as_currency},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.format_as_currency,variant:format===constants_1.FORMAT_CURRENCY?"solid":"ghost",color:format===constants_1.FORMAT_CURRENCY?activeIconColor:iconColor,icon:md_1.MdAttachMoney,size:"sm",height:"28px",onClick:()=>null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.CUSTOM_FORMAT,constants_1.FORMAT_CURRENCY)})),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.format_as_percent,label:translations_1.translations.format_as_percent},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.format_as_percent,variant:format===constants_1.FORMAT_PERCENT?"solid":"ghost",color:format===constants_1.FORMAT_PERCENT?activeIconColor:iconColor,fontSize:10,icon:styled_1.PercentIcon,size:"sm",height:"28px",onClick:()=>null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.CUSTOM_FORMAT,constants_1.FORMAT_PERCENT)})),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.decrease_decimal,label:translations_1.translations.decrease_decimal},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.decrease_decimal,fontSize:20,color:iconColor,icon:styled_1.DecreaseDecimalIcon,size:"sm",height:"28px",onClick:()=>null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.CUSTOM_FORMAT,constants_1.changeDecimals(format,-1))})),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.increase_decimal,label:translations_1.translations.increase_decimal},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.increase_decimal,fontSize:20,color:iconColor,icon:styled_1.IncreaseDecimalIcon,size:"sm",height:"28px",onClick:()=>null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.CUSTOM_FORMAT,constants_1.changeDecimals(format))})),react_1.default.createElement(core_1.Menu,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.more_formats,label:translations_1.translations.more_formats},react_1.default.createElement(core_1.MenuButton,{color:foregroundColor,as:styled_1.Button,size:"sm",flexShrink:0,paddingLeft:1,paddingRight:1,background:"none",height:"28px"},react_1.default.createElement(core_1.Box,{fontSize:12},"123"),react_1.default.createElement(core_1.Icon,{name:"chevron-down",fontSize:16}))),react_1.default.createElement(core_1.MenuList,{placement:"top-start",minWidth:250,borderColor:borderColor,borderStyle:"solid",fontSize:14},react_1.default.createElement(styled_1.MenuItem,{onClick:()=>{null==onFormattingChangeAuto||onFormattingChangeAuto(),null==onFormattingChange||onFormattingChange(types_1.FORMATTING_TYPE.CUSTOM_FORMAT,void 0)}},react_1.default.createElement(core_1.Box,{width:"24px"},void 0===format&&!plaintext&&react_1.default.createElement(core_1.Icon,{name:"check",mr:1})),"Automatic"),react_1.default.createElement(styled_1.MenuItem,{onClick:()=>{null==onFormattingChangePlain||onFormattingChangePlain()}},react_1.default.createElement(core_1.Box,{width:"24px"},plaintext&&react_1.default.createElement(core_1.Icon,{name:"check",mr:1})),"Plain"),react_1.default.createElement(core_1.MenuDivider,{borderColor:borderColor}),constants_1.AVAILABLE_FORMATS.map((item,idx)=>react_1.default.createElement(styled_1.MenuItem,{display:"flex",onClick:()=>{null==onFormattingChange||onFormattingChange(types_1.FORMATTING_TYPE.CUSTOM_FORMAT,item.value)},key:idx},react_1.default.createElement(core_1.Box,{width:"24px"},format===item.value&&!plaintext&&react_1.default.createElement(core_1.Icon,{name:"check",mr:1})),react_1.default.createElement(core_1.Box,{flex:1},item.label),react_1.default.createElement(core_1.Box,{textAlign:"right",color:"gray.500"},item.sample))),react_1.default.createElement(core_1.MenuDivider,{borderColor:borderColor}),constants_1.AVAILABLE_CURRENCY_FORMATS.map((item,idx)=>react_1.default.createElement(styled_1.MenuItem,{display:"flex",onClick:()=>{null==onFormattingChange||onFormattingChange(types_1.FORMATTING_TYPE.CUSTOM_FORMAT,item.value)},key:idx},react_1.default.createElement(core_1.Box,{width:"24px"},format===item.value&&!plaintext&&react_1.default.createElement(core_1.Icon,{name:"check",mr:1})),react_1.default.createElement(core_1.Box,{flex:1},item.label),react_1.default.createElement(core_1.Box,{textAlign:"right",color:"gray.500"},item.sample))))),react_1.default.createElement(styled_1.Separator,{borderColor:borderColor}),react_1.default.createElement(core_1.Menu,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.font,label:translations_1.translations.font},react_1.default.createElement(core_1.MenuButton,{paddingLeft:1,paddingRight:1,as:styled_1.Button,background:"none",fontSize:12,fontWeight:"normal",size:"sm",width:100,textAlign:"left",display:"flex",whiteSpace:"nowrap",minWidth:0,flexShrink:0,height:"28px",color:foregroundColor},react_1.default.createElement(core_1.Box,{whiteSpace:"nowrap",overflow:"hidden",flex:1,textOverflow:"ellipsis"},fontFamily),react_1.default.createElement(core_1.Icon,{name:"chevron-down",fontSize:16}))),react_1.default.createElement(core_1.MenuList,{placement:"top-start",borderColor:borderColor,borderStyle:"solid",fontSize:14},fontList.map((font,idx)=>react_1.default.createElement(styled_1.MenuItem,{onClick:()=>{null==onFormattingChange||onFormattingChange(types_1.FORMATTING_TYPE.FONT_FAMILY,font)},key:idx},react_1.default.createElement(core_1.Box,{width:"24px"},font===fontFamily&&react_1.default.createElement(core_1.Icon,{name:"check",mr:1})),font)))),react_1.default.createElement(styled_1.Separator,{borderColor:borderColor}),react_1.default.createElement(Select_1.default,{options:constants_1.FONT_SIZES.map(size=>({label:size,value:size})),onChange:item=>{null==onFormattingChange||onFormattingChange(types_1.FORMATTING_TYPE.FONT_SIZE,null==item?void 0:item.value)},value:{value:fontSize,label:fontSize},format:value=>parseInt(value)}),react_1.default.createElement(styled_1.Separator,{borderColor:borderColor}),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.bold,label:translations_1.translations.bold},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.bold,variant:bold?"solid":"ghost",color:bold?activeIconColor:iconColor,icon:md_1.MdFormatBold,fontSize:20,size:"sm",height:"28px",onClick:()=>null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.BOLD,!bold)})),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.italic,label:translations_1.translations.italic},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.italic,variant:italic?"solid":"ghost",color:italic?activeIconColor:iconColor,icon:md_1.MdFormatItalic,fontSize:20,size:"sm",height:"28px",onClick:()=>null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.ITALIC,!italic)})),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.underline,label:translations_1.translations.underline},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.underline,variant:underline?"solid":"ghost",color:underline?activeIconColor:iconColor,icon:md_1.MdFormatUnderlined,fontSize:20,size:"sm",height:"28px",onClick:()=>null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.UNDERLINE,!underline)})),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.strikethrough,label:translations_1.translations.strikethrough},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.strikethrough,variant:strike?"solid":"ghost",color:strike?activeIconColor:iconColor,icon:md_1.MdStrikethroughS,fontSize:20,size:"sm",height:"28px",onClick:()=>null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.STRIKE,!strike)})),react_1.default.createElement(core_1.Popover,{usePortal:!0,placement:"top-start"},({onClose:onClose})=>react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.text_color,label:translations_1.translations.text_color},react_1.default.createElement(styled_1.Button,{size:"sm",color:iconColor,variant:"ghost",p:0,w:8,flexDirection:"column","aria-label":translations_1.translations.text_color,background:"none",height:"28px"},react_1.default.createElement(md_1.MdTextFields,null),react_1.default.createElement(styled_1.Rect,{color:color}))))),react_1.default.createElement(styled_1.PopoverContent,{width:280,borderColor:borderColor,borderStyle:"solid"},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.PopoverBody,null,react_1.default.createElement(ColorPicker,{color:color,onChange:value=>{null==onFormattingChange||onFormattingChange(types_1.FORMATTING_TYPE.COLOR,value),null==onClose||onClose()}}))))),react_1.default.createElement(styled_1.Separator,{borderColor:borderColor}),react_1.default.createElement(core_1.Popover,{usePortal:!0,placement:"top-start"},({onClose:onClose})=>react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.fill_color,label:translations_1.translations.fill_color},react_1.default.createElement(styled_1.Button,{size:"sm",color:iconColor,variant:"ghost",p:0,w:8,flexDirection:"column","aria-label":translations_1.translations.fill_color,background:"none",height:"28px"},react_1.default.createElement(io_1.IoMdColorFill,null),react_1.default.createElement(styled_1.Rect,{color:fill}))))),react_1.default.createElement(styled_1.PopoverContent,{width:280,borderColor:borderColor,borderStyle:"solid"},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.PopoverBody,null,react_1.default.createElement(ColorPicker,{color:fill,onChange:value=>{null==onFormattingChange||onFormattingChange(types_1.FORMATTING_TYPE.FILL,value),null==onClose||onClose()}}))))),react_1.default.createElement(BorderSelection,{onBorderChange:onBorderChange,iconColor:iconColor,activeIconColor:activeIconColor,isLight:isLight}),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.merge_cells,label:translations_1.translations.merge_cells},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.merge_cells,variant:"ghost",color:iconColor,icon:styled_1.MergeCellsIcon,fontSize:20,size:"sm",height:"28px",onClick:()=>null==onMergeCells?void 0:onMergeCells()})),react_1.default.createElement(core_1.Popover,{usePortal:!0,placement:"top-start"},()=>react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.freeze,label:translations_1.translations.freeze},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.freeze,variant:"ghost",color:iconColor,icon:bs_1.BsColumns,fontSize:20,size:"sm",height:"28px"})))),react_1.default.createElement(styled_1.PopoverContent,{width:220,borderColor:borderColor,borderStyle:"solid"},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.PopoverBody,{color:foregroundColor},react_1.default.createElement(core_1.FormControl,{mb:1},react_1.default.createElement(core_1.FormLabel,{fontSize:14},translations_1.translations.freeze_rows),react_1.default.createElement(core_1.Select,{size:"sm",value:frozenRows,onChange:e=>null==onFrozenRowChange?void 0:onFrozenRowChange(Number(e.target.value)),borderColor:isLight?theme.colors.gray[300]:"rgba(255,255,255,0.04)"},Array.from({length:11}).map((_,idx)=>react_1.default.createElement("option",{value:idx,key:idx},idx)))),react_1.default.createElement(core_1.FormControl,{mb:1},react_1.default.createElement(core_1.FormLabel,{fontSize:14},translations_1.translations.freeze_columns),react_1.default.createElement(core_1.Select,{size:"sm",value:frozenColumns,onChange:e=>null==onFrozenColumnChange?void 0:onFrozenColumnChange(Number(e.target.value)),borderColor:isLight?theme.colors.gray[300]:"rgba(255,255,255,0.04)"},Array.from({length:11}).map((_,idx)=>react_1.default.createElement("option",{value:idx,key:idx},idx)))))))),react_1.default.createElement(styled_1.Separator,{borderColor:borderColor}),react_1.default.createElement(core_1.Popover,{usePortal:!0,placement:"top-start"},()=>react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.horizontal_align,label:translations_1.translations.horizontal_align},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.horizontal_align,variant:"ghost",color:iconColor,icon:md_1.MdFormatAlignLeft,fontSize:20,size:"sm",height:"28px"})))),react_1.default.createElement(styled_1.PopoverContent,{width:"auto",borderColor:borderColor,borderStyle:"solid"},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.Box,{display:"flex"},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.horizontal_align,variant:"left"===horizontalAlign?"solid":"ghost",color:"left"===horizontalAlign?activeIconColor:iconColor,onClick:()=>null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.HORIZONTAL_ALIGN,"left"),icon:md_1.MdFormatAlignLeft,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.horizontal_align,variant:"center"===horizontalAlign?"solid":"ghost",color:"center"===horizontalAlign?activeIconColor:iconColor,onClick:()=>null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.HORIZONTAL_ALIGN,"center"),icon:md_1.MdFormatAlignCenter,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.horizontal_align,variant:"right"===horizontalAlign?"solid":"ghost",color:"right"===horizontalAlign?activeIconColor:iconColor,onClick:()=>null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.HORIZONTAL_ALIGN,"right"),icon:md_1.MdFormatAlignRight,fontSize:20,size:"sm"}))))),react_1.default.createElement(core_1.Popover,{usePortal:!0,placement:"top-start"},()=>react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.vertical_align,label:translations_1.translations.vertical_align},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.vertical_align,variant:"ghost",color:iconColor,icon:md_1.MdVerticalAlignBottom,fontSize:20,size:"sm",height:"28px"})))),react_1.default.createElement(styled_1.PopoverContent,{width:"auto",borderColor:borderColor,borderStyle:"solid"},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.Box,{display:"flex"},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.horizontal_align,variant:"top"===verticalAlign?"solid":"ghost",color:"top"===verticalAlign?activeIconColor:iconColor,icon:md_1.MdVerticalAlignTop,fontSize:20,size:"sm",onClick:()=>null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.VERTICAL_ALIGN,"top")}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.horizontal_align,variant:"middle"===verticalAlign?"solid":"ghost",color:"middle"===verticalAlign?activeIconColor:iconColor,icon:md_1.MdVerticalAlignCenter,fontSize:20,size:"sm",onClick:()=>null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.VERTICAL_ALIGN,"middle")}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.horizontal_align,variant:"bottom"===verticalAlign?"solid":"ghost",color:"bottom"===verticalAlign?activeIconColor:iconColor,icon:md_1.MdVerticalAlignBottom,fontSize:20,size:"sm",onClick:()=>null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.VERTICAL_ALIGN,"bottom")}))))),react_1.default.createElement(core_1.Popover,{usePortal:!0,placement:"top-start"},({onClose:onClose})=>react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.text_wrapping,label:translations_1.translations.text_wrapping},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.text_wrapping,variant:"ghost",color:iconColor,icon:"clip"===wrap?styled_1.WrapClipIcon:styled_1.WrapIcon,fontSize:20,size:"sm",height:"28px"})))),react_1.default.createElement(styled_1.PopoverContent,{width:"auto",borderColor:borderColor,borderStyle:"solid"},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.Box,{display:"flex"},react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.text_clip,label:translations_1.translations.text_clip},react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.text_clip,variant:"clip"===wrap?"solid":"ghost",color:"clip"===wrap?activeIconColor:iconColor,icon:styled_1.WrapClipIcon,fontSize:20,size:"sm",onClick:()=>{null==onFormattingChange||onFormattingChange(types_1.FORMATTING_TYPE.WRAP,"clip"),null==onClose||onClose()}}))),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.text_wrap,label:translations_1.translations.text_wrap},react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.text_wrap,variant:"wrap"===wrap?"solid":"ghost",color:"wrap"===wrap?activeIconColor:iconColor,icon:styled_1.WrapIcon,fontSize:20,size:"sm",onClick:()=>{null==onFormattingChange||onFormattingChange(types_1.FORMATTING_TYPE.WRAP,"wrap"),null==onClose||onClose()}})))))))),react_1.default.createElement(core_1.Flex,{alignItems:"flex-end"},enableDarkMode&&react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":isLight?translations_1.translations.switch_dark_mode:translations_1.translations.switch_light_mode,label:isLight?translations_1.translations.switch_dark_mode:translations_1.translations.switch_light_mode},react_1.default.createElement(styled_1.IconButton,{"aria-label":isLight?translations_1.translations.switch_dark_mode:translations_1.translations.switch_light_mode,variant:"ghost",color:iconColor,icon:isLight?io_1.IoMdMoon:md_1.MdWbSunny,fontSize:20,size:"sm",onClick:toggleColorMode}))))}},89:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.MenuItem=exports.Tooltip=exports.Button=exports.PopoverContent=exports.IconButton=exports.MergeCellsIcon=exports.WrapIcon=exports.WrapClipIcon=exports.DecreaseDecimalIcon=exports.IncreaseDecimalIcon=exports.PercentIcon=exports.GridWrapper=exports.BottomPanel=exports.Rect=exports.Separator=exports.StyledToolbar=void 0;const react_1=__importStar(__webpack_require__(1)),styled_1=__importDefault(__webpack_require__(53)),core_1=__webpack_require__(33),core_2=__webpack_require__(33),constants_1=__webpack_require__(30),core_3=__webpack_require__(2),styled=styled_1.default;exports.default=styled;exports.StyledToolbar=styled(props=>react_1.default.createElement(core_2.Box,Object.assign({},props)))`
  min-height: 40px;
  border-color: ${props=>props.borderColor};
  border-style: solid;
  background: ${props=>props.backgroundColor};
  border-width: 1px 0;
  display: flex;
  align-items: center;
  min-width: 0;
  border-bottom-width: 0;
`;exports.Separator=styled(props=>react_1.default.createElement("div",{className:props.className},props.children))`
  border-color: ${props=>props.borderColor};
  border-width: 0 1px 0 0;
  height: 24px;
  border-style: solid;
  margin: 0 ${props=>props.theme.space[1]};
`,exports.Rect=styled(core_2.Box)`
  height: 2px;
  background: ${props=>props.color};
  width: 20px;
  margin-top: 0;
  position: relative;
  top: 2px;
`,exports.BottomPanel=styled(core_2.Box)`
  display: flex;
  flex: 1;
  min-width: 0;
  height: 40px;
`,exports.GridWrapper=styled.div`
  position: relative;
  flex: 1;
  display: flex;
  flex-direction: column;
`,exports.PercentIcon=()=>react_1.default.createElement(react_1.default.Fragment,null,"%"),exports.IncreaseDecimalIcon=()=>react_1.default.createElement("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 -6 24 24","aria-hidden":"true",focusable:"false",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg"},react_1.default.createElement("path",{d:"M0,7 L1.99632026,7 L1.99632026,9 L0,9 L0,7 Z M10,12 L15,12 L15,14 L10,14 L10,12 Z M16.9694527,11.9570946 L18,13.0188246 L16.9734025,14.0389803 L15,16 L15,10 L16.9694527,11.9570946 Z M2.99264052,2.99686968 C2.99264052,1.34174426 4.33709312,-1.59872116e-14 5.98804084,-1.59872116e-14 C7.64235476,-1.59872116e-14 8.98344117,1.34739093 8.98344117,2.99686968 L8.98344117,6.00313032 C8.98344117,7.65825574 7.63898856,9 5.98804084,9 C4.33372692,9 2.99264052,7.65260907 2.99264052,6.00313032 L2.99264052,2.99686968 Z M4.5,2.99857602 L4.5,6.00142398 C4.5,6.83497024 5.17157288,7.5 6,7.5 C6.83420277,7.5 7.5,6.82906466 7.5,6.00142398 L7.5,2.99857602 C7.5,2.16502976 6.82842712,1.5 6,1.5 C5.16579723,1.5 4.5,2.17093534 4.5,2.99857602 Z M9.99264052,2.99686968 C9.99264052,1.34174426 11.3370931,-1.59872116e-14 12.9880408,-1.59872116e-14 C14.6423548,-1.59872116e-14 15.9834412,1.34739093 15.9834412,2.99686968 L15.9834412,6.00313032 C15.9834412,7.65825574 14.6389886,9 12.9880408,9 C11.3337269,9 9.99264052,7.65260907 9.99264052,6.00313032 L9.99264052,2.99686968 Z M11.5,2.99857602 L11.5,6.00142398 C11.5,6.83497024 12.1715729,7.5 13,7.5 C13.8342028,7.5 14.5,6.82906466 14.5,6.00142398 L14.5,2.99857602 C14.5,2.16502976 13.8284271,1.5 13,1.5 C12.1657972,1.5 11.5,2.17093534 11.5,2.99857602 Z"})),exports.DecreaseDecimalIcon=()=>react_1.default.createElement("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 -6 24 24","aria-hidden":"true",focusable:"false",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg"},react_1.default.createElement("path",{d:"M11.0119846,13 L16,13 L16,15 L11.0119846,15 L11.0119846,16.9944804 L9.03685276,15.0409865 L7.98433567,14 L9.03289155,12.9629313 L11.0119846,11.0055196 L11.0119846,13 Z M1,8 L2.99632026,8 L2.99632026,10 L1,10 L1,8 Z M3.99264052,3.99686968 C3.99264052,2.34174426 5.33709312,1 6.98804084,1 C8.64235476,1 9.98344117,2.34739093 9.98344117,3.99686968 L9.98344117,7.00313032 C9.98344117,8.65825574 8.63898856,10 6.98804084,10 C5.33372692,10 3.99264052,8.65260907 3.99264052,7.00313032 L3.99264052,3.99686968 Z M5.5,3.99857602 L5.5,7.00142398 C5.5,7.83497024 6.17157288,8.5 7,8.5 C7.83420277,8.5 8.5,7.82906466 8.5,7.00142398 L8.5,3.99857602 C8.5,3.16502976 7.82842712,2.5 7,2.5 C6.16579723,2.5 5.5,3.17093534 5.5,3.99857602 Z"})),exports.WrapClipIcon=()=>react_1.default.createElement("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 -6 24 24","aria-hidden":"true",focusable:"false",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg"},react_1.default.createElement("path",{d:"M0,0 L2,0 L2,14 L0,14 L0,0 Z M12,0 L14,0 L14,14 L12,14 L12,0 Z M4,6 L12,6 L12,8 L4,8 L4,6 Z"})),exports.WrapIcon=()=>react_1.default.createElement("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 -6 24 24","aria-hidden":"true",focusable:"false",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg"},react_1.default.createElement("path",{d:"M14,0 L0,0 L0,2 L14,2 L14,0 Z M0,12 L4,12 L4,10 L0,10 L0,12 Z M11.5,5 L0,5 L0,7 L11.75,7 C12.58,7 13.25,7.67 13.25,8.5 C13.25,9.33 12.58,10 11.75,10 L9,10 L9,8 L6,11 L9,14 L9,12 L11.5,12 C13.43,12 15,10.43 15,8.5 C15,6.57 13.43,5 11.5,5 Z"})),exports.MergeCellsIcon=()=>react_1.default.createElement("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"-1 -1 20 20","aria-hidden":"true",focusable:"false",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg"},react_1.default.createElement("path",{d:"M3,6 L1,6 L1,2 L8,2 L8,4 L3,4 L3,6 Z M10,4 L10,2 L17,2 L17,6 L15,6 L15,4 L10,4 Z M10,14 L15,14 L15,12 L17,12 L17,16 L10,16 L10,14 Z M1,12 L3,12 L3,14 L8,14 L8,16 L1,16 L1,12 Z M1,8 L5,8 L5,6 L8,9 L5,12 L5,10 L1,10 L1,8 Z M10,9 L13,6 L13,8 L17,8 L17,10 L13,10 L13,12 L10,9 Z"})),exports.IconButton=react_1.forwardRef((props,ref)=>react_1.default.createElement(core_1.IconButton,Object.assign({ref:ref,css:core_3.css`
        font-family: ${constants_1.SYSTEM_FONT};
        line-height: 1.2;
        // background-color: transparent;
        cursor: pointer;
        line-height: inherit;
        overflow: visible;
        text-transform: none;
        border-style: none;
      `,background:"none"},props))),exports.PopoverContent=react_1.forwardRef((props,ref)=>{const{colorMode:colorMode}=core_1.useColorMode();return react_1.default.createElement(core_1.PopoverContent,Object.assign({ref:ref,css:core_3.css`
        font-family: ${constants_1.SYSTEM_FONT};
        color: ${"light"===colorMode?"#333":"white"};
      `},props))}),exports.Button=react_1.forwardRef((props,ref)=>react_1.default.createElement(core_1.Button,Object.assign({ref:ref,css:core_3.css`
        font-family: ${constants_1.SYSTEM_FONT};
        line-height: 1.2;
        font-weight: normal;
        cursor: pointer;
        text-transform: none;
        border-style: none;
        text-overflow: ellipsis;
      `},props))),exports.Tooltip=styled(core_1.Tooltip)`
  font-family: ${constants_1.SYSTEM_FONT};
  line-height: 1.2;
  font-size: 0.8rem;
  padding-top: 4px;
  padding-bottom: 4px;
`,exports.MenuItem=react_1.forwardRef((props,ref)=>react_1.default.createElement(core_1.MenuItem,Object.assign({css:core_3.css`
        font-family: ${constants_1.SYSTEM_FONT};
        line-height: 1.2;
        background: transparent;
        cursor: pointer;
        line-height: inherit;
        overflow: visible;
        text-transform: none;
        border-style: none;
      `,ref:ref},props)))},90:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorType=exports.ErrorValue=exports.SELECTION_MODE=exports.BORDER_STYLE=exports.RESOURCE_TYPE=exports.OPERATION_TYPE=exports.BORDER_VARIANT=exports.AXIS=exports.STROKE_FORMATTING=exports.TEXT_DECORATION=exports.FONT_STYLE=exports.FONT_WEIGHT=exports.FORMATTING_TYPE=void 0,function(FORMATTING_TYPE){FORMATTING_TYPE.BOLD="bold",FORMATTING_TYPE.ITALIC="italic",FORMATTING_TYPE.HORIZONTAL_ALIGN="horizontalAlign",FORMATTING_TYPE.VERTICAL_ALIGN="verticalAlign",FORMATTING_TYPE.STRIKE="strike",FORMATTING_TYPE.UNDERLINE="underline",FORMATTING_TYPE.FILL="fill",FORMATTING_TYPE.COLOR="color",FORMATTING_TYPE.PERCENT="percent",FORMATTING_TYPE.DECIMALS="decimals",FORMATTING_TYPE.CURRENCY="currency",FORMATTING_TYPE.CURRENCY_SYMBOL="currencySymbol",FORMATTING_TYPE.FONT_SIZE="fontSize",FORMATTING_TYPE.FONT_FAMILY="fontFamily",FORMATTING_TYPE.CUSTOM_FORMAT="format",FORMATTING_TYPE.WRAP="wrap",FORMATTING_TYPE.ROTATION="rotation"}(exports.FORMATTING_TYPE||(exports.FORMATTING_TYPE={})),function(FONT_WEIGHT){FONT_WEIGHT.BOLD="bold",FONT_WEIGHT.NORMAL="normal"}(exports.FONT_WEIGHT||(exports.FONT_WEIGHT={})),function(FONT_STYLE){FONT_STYLE.ITALIC="italic",FONT_STYLE.NORMAL="normal"}(exports.FONT_STYLE||(exports.FONT_STYLE={})),function(TEXT_DECORATION){TEXT_DECORATION.STRIKE="line-through",TEXT_DECORATION.NONE="",TEXT_DECORATION.UNDERLINE="underline"}(exports.TEXT_DECORATION||(exports.TEXT_DECORATION={})),function(STROKE_FORMATTING){STROKE_FORMATTING.STROKE="stroke",STROKE_FORMATTING.STROKE_TOP_COLOR="strokeTopColor",STROKE_FORMATTING.STROKE_RIGHT_COLOR="strokeRightColor",STROKE_FORMATTING.STROKE_BOTTOM_COLOR="strokeBottomColor",STROKE_FORMATTING.STROKE_LEFT_COLOR="strokeLeftColor",STROKE_FORMATTING.STROKE_WIDTH="strokeWidth",STROKE_FORMATTING.STROKE_TOP_WIDTH="strokeTopWidth",STROKE_FORMATTING.STROKE_RIGHT_WIDTH="strokeRightWidth",STROKE_FORMATTING.STROKE_BOTTOM_WIDTH="strokeBottomWidth",STROKE_FORMATTING.STROKE_LEFT_WIDTH="strokeLeftWidth",STROKE_FORMATTING.STROKE_DASH="strokeDash",STROKE_FORMATTING.STROKE_TOP_DASH="strokeTopDash",STROKE_FORMATTING.STROKE_RIGHT_DASH="strokeRightDash",STROKE_FORMATTING.STROKE_BOTTOM_DASH="strokeBottomDash",STROKE_FORMATTING.STROKE_LEFT_DASH="strokeLeftDash"}(exports.STROKE_FORMATTING||(exports.STROKE_FORMATTING={})),function(AXIS){AXIS.X="x",AXIS.Y="y"}(exports.AXIS||(exports.AXIS={})),function(BORDER_VARIANT){BORDER_VARIANT.ALL="all",BORDER_VARIANT.INNER="inner",BORDER_VARIANT.HORIZONTAL="horizontal",BORDER_VARIANT.VERTICAL="vertical",BORDER_VARIANT.OUTER="outer",BORDER_VARIANT.LEFT="left",BORDER_VARIANT.RIGHT="right",BORDER_VARIANT.BOTTOM="bottom",BORDER_VARIANT.TOP="top",BORDER_VARIANT.NONE="none"}(exports.BORDER_VARIANT||(exports.BORDER_VARIANT={})),function(OPERATION_TYPE){OPERATION_TYPE.CELL_ATTRIBUTE="cell_attribute",OPERATION_TYPE.CHANGE_SHEET_NAME="change_sheet_name",OPERATION_TYPE.SHEET_ADD="sheet_add",OPERATION_TYPE.SHEET_REMOVE="sheet_remove"}(exports.OPERATION_TYPE||(exports.OPERATION_TYPE={})),function(RESOURCE_TYPE){RESOURCE_TYPE.SHEET="sheet",RESOURCE_TYPE.CELL="cell",RESOURCE_TYPE.SELECTION="selection"}(exports.RESOURCE_TYPE||(exports.RESOURCE_TYPE={})),function(BORDER_STYLE){BORDER_STYLE.THIN="thin",BORDER_STYLE.MEDIUM="medium",BORDER_STYLE.THICK="thick",BORDER_STYLE.DASHED="dashed",BORDER_STYLE.DOTTED="dotted",BORDER_STYLE.DOUBLE="double"}(exports.BORDER_STYLE||(exports.BORDER_STYLE={})),function(SELECTION_MODE){SELECTION_MODE.CELL="cell",SELECTION_MODE.ROW="row",SELECTION_MODE.COLUMN="column",SELECTION_MODE.BOTH="both"}(exports.SELECTION_MODE||(exports.SELECTION_MODE={})),function(ErrorValue){ErrorValue.NotApplicable="#N/A",ErrorValue.Ref="#REF!",ErrorValue.Name="#NAME?",ErrorValue.DivZero="#DIV/0!",ErrorValue.Null="#NULL!",ErrorValue.Value="#VALUE!",ErrorValue.Num="#NUM!"}(exports.ErrorValue||(exports.ErrorValue={})),function(EditorType){EditorType.TEXT="text",EditorType.DATE="date",EditorType.LIST="list",EditorType.BOOLEAN="boolean"}(exports.EditorType||(exports.EditorType={}))},926:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||exports.hasOwnProperty(p)||__createBinding(exports,m,p)},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const Select_1=__importDefault(__webpack_require__(408));exports.default=Select_1.default,__exportStar(__webpack_require__(408),exports)},927:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const Formulabar_1=__importDefault(__webpack_require__(928));exports.default=Formulabar_1.default},928:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(1)),core_1=__webpack_require__(33),constants_1=__webpack_require__(30),Formulabar=react_1.memo(react_1.forwardRef((props,forwardedRef)=>{const{value:value,onChange:onChange,onKeyDown:onKeyDown,onFocus:onFocus,onBlur:onBlur}=props,{colorMode:colorMode}=core_1.useColorMode(),theme=core_1.useTheme(),isLightMode="light"===colorMode,backgroundColor=isLightMode?"white":constants_1.DARK_MODE_COLOR,color=isLightMode?constants_1.DARK_MODE_COLOR:"white",borderColor=isLightMode?theme.colors.gray[300]:theme.colors.gray[600];return react_1.default.createElement(core_1.InputGroup,{size:"sm",borderTopWidth:1,borderTopStyle:"solid",borderTopColor:borderColor,height:"24px"},react_1.default.createElement(core_1.InputLeftAddon,{width:constants_1.FORMULABAR_LEFT_CORNER_WIDTH,justifyContent:"center",bg:backgroundColor,color:color,fontSize:12,fontStyle:"italic",borderTopWidth:0,borderBottomWidth:0,size:"sm",borderRadius:0,children:"fx",height:"auto",userSelect:"none",borderLeftColor:borderColor}),react_1.default.createElement(core_1.Input,{borderTopWidth:0,borderBottomWidth:0,size:"sm",borderRadius:0,pl:2,backgroundColor:backgroundColor,borderColor:borderColor,color:color,focusBorderColor:borderColor,onChange:onChange,onBlur:onBlur,value:value,onKeyDown:onKeyDown,onFocus:onFocus,height:"100%",lineHeight:1,fontSize:12,ref:forwardedRef,_focus:{boxShadow:"none"}}))}));exports.default=Formulabar},929:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||exports.hasOwnProperty(p)||__createBinding(exports,m,p)},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const Workbook_1=__importDefault(__webpack_require__(409));__exportStar(__webpack_require__(409),exports),exports.default=Workbook_1.default},931:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const Grid_1=__importDefault(__webpack_require__(932));exports.default=Grid_1.default},932:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(1)),grid_1=__importStar(__webpack_require__(6)),grid_2=__webpack_require__(6),core_1=__webpack_require__(33),constants_1=__webpack_require__(30),HeaderCell_1=__importDefault(__webpack_require__(933)),Cell_1=__importDefault(__webpack_require__(253)),styled_1=__webpack_require__(89),types_1=__webpack_require__(90),Editor_1=__importDefault(__webpack_require__(411)),FilterComponent_1=__importDefault(__webpack_require__(942)),FilterIcon_1=__webpack_require__(254),ListArrow_1=__webpack_require__(410),Tooltip_1=__importDefault(__webpack_require__(413)),EMPTY_ARRAY=[],EMPTY_OBJECT={},SheetGrid=react_1.memo(react_1.forwardRef((props,forwardedRef)=>{var _a;const{theme:theme,minColumnWidth:minColumnWidth=constants_1.DEFAULT_COLUMN_WIDTH,minRowHeight:minRowHeight=constants_1.DEFAULT_ROW_HEIGHT,rowCount:initialRowCount=1e3,columnCount:initialColumnCount=1e3,width:width,height:height,CellRenderer:CellRenderer=Cell_1.default,HeaderCellRenderer:HeaderCellRenderer=HeaderCell_1.default,cells:cells,onChange:onChange,onFill:onFill,onSheetChange:onSheetChange,activeCell:initialActiveCell,selections:initialSelections=EMPTY_ARRAY,selectedSheet:selectedSheet,onScroll:onScroll,scrollState:scrollState,onActiveCellChange:onActiveCellChange,onActiveCellValueChange:onActiveCellValueChange,onDelete:onDelete,formatter:formatter,onResize:onResize,columnSizes:columnSizes=EMPTY_OBJECT,rowSizes:rowSizes=EMPTY_OBJECT,mergedCells:mergedCells,frozenRows:userFrozenRows=0,frozenColumns:userFrozenColumns=0,onKeyDown:onKeyDown,hiddenColumns:userHiddenColumns=EMPTY_ARRAY,hiddenRows:userHiddenRows=EMPTY_ARRAY,filterViews:filterViews=EMPTY_ARRAY,onPaste:onPaste,onCut:onCut,onInsertRow:onInsertRow,onInsertColumn:onInsertColumn,onDeleteColumn:onDeleteColumn,onDeleteRow:onDeleteRow,showGridLines:showGridLines,CellEditor:CellEditor=Editor_1.default,selectionPolicy:selectionPolicy,onSelectionChange:onSelectionChange,selectionMode:selectionMode,isLightMode:isLightMode,onChangeFilter:onChangeFilter,scale:scale,selectionTopBound:selectionTopBound=1,selectionLeftBound:selectionLeftBound=1,ContextMenu:ContextMenu,Tooltip:Tooltip=Tooltip_1.default,snap:snap}=props,gridRef=react_1.useRef(null),onSheetChangeRef=react_1.useRef(grid_2.debounce(onSheetChange,100)),rowCount=initialRowCount+1,columnCount=initialColumnCount+1,internalRefs=react_1.useRef({rowCount:rowCount,columnCount:columnCount}),frozenRows=Math.max(1,userFrozenRows+1),frozenColumns=Math.max(1,userFrozenColumns+1),debounceScroll=react_1.useRef(grid_2.debounce(onScroll,500)),[contextMenuProps,setContextMenuProps]=react_1.useState(null),borderStyles=react_1.useMemo(()=>filterViews.map(filter=>({bounds:filter.bounds,style:{strokeWidth:1,stroke:"green"}})),[filterViews]);react_1.useEffect(()=>{internalRefs.current={rowCount:rowCount,columnCount:columnCount}},[rowCount,columnCount]);const isCellRowHeader=react_1.useCallback(rowIndex=>0===rowIndex,[]),isCellColumnHeader=react_1.useCallback(columnIndex=>0===columnIndex,[]),filterHeaderCells=react_1.useMemo(()=>filterViews.reduce((acc,filter,index)=>{const{bounds:bounds}=filter;for(let i=bounds.left;i<=bounds.right;i++)acc[grid_2.cellIdentifier(bounds.top,i)]=index;return acc},{}),[filterViews]),columnsWithFilter=react_1.useMemo(()=>filterViews.reduce((acc,filter)=>{const{bounds:bounds}=filter;for(let i=bounds.left;i<=bounds.right;i++)acc.push(i);return acc},[]),[filterViews]),rowFilterRange=react_1.useMemo(()=>filterViews.reduce((acc,{bounds:bounds},index)=>(acc[index]=[bounds.top,bounds.bottom],acc),{}),[filterViews]),columnHasFilter=react_1.useCallback(columnIndex=>columnsWithFilter.includes(columnIndex),[columnsWithFilter]),rowHasFilter=react_1.useCallback(rowIndex=>{for(const i in rowFilterRange){const[min,max]=rowFilterRange[i];if(rowIndex>=min&&rowIndex<=max)return!0}return!1},[rowFilterRange]);react_1.useImperativeHandle(forwardedRef,()=>{var _a,_b,_c,_d,_e,_f,_g;return{getNextFocusableCell:getNextFocusableCell,setActiveCell:setActiveCell,setSelections:setSelections,focus:()=>{var _a;return null===(_a=gridRef.current)||void 0===_a?void 0:_a.focus()},resetAfterIndices:null===(_a=gridRef.current)||void 0===_a?void 0:_a.resetAfterIndices,makeEditable:makeEditable,setEditorValue:setValue,hideEditor:hideEditor,submitEditor:submitEditor,cancelEditor:cancelEditor,resizeColumns:null===(_b=gridRef.current)||void 0===_b?void 0:_b.resizeColumns,resizeRows:null===(_c=gridRef.current)||void 0===_c?void 0:_c.resizeRows,getCellBounds:null===(_d=gridRef.current)||void 0===_d?void 0:_d.getCellBounds,getScrollPosition:null===(_e=gridRef.current)||void 0===_e?void 0:_e.getScrollPosition,getCellCoordsFromOffset:null===(_f=gridRef.current)||void 0===_f?void 0:_f.getCellCoordsFromOffset,getCellOffsetFromCoords:null===(_g=gridRef.current)||void 0===_g?void 0:_g.getCellOffsetFromCoords}});const getValue=react_1.useCallback(cell=>{var _a,_b;if(!cell)return;const{rowIndex:rowIndex,columnIndex:columnIndex}=cell,isRowHeader=isCellRowHeader(rowIndex),isColumnHeader=isCellColumnHeader(columnIndex),cellId=grid_2.cellIdentifier(rowIndex,columnIndex),isFilterHeader=void 0!==filterHeaderCells[cellId];if(isRowHeader)return{text:constants_1.number2Alpha(columnIndex-1),fontSize:10};if(isColumnHeader)return{text:rowIndex,fontSize:10};const cellConfig=isFilterHeader?{...null===(_a=cells[rowIndex])||void 0===_a?void 0:_a[columnIndex],bold:!0}:null===(_b=cells[rowIndex])||void 0===_b?void 0:_b[columnIndex];return rowIndex in cells?cellConfig:void 0},[cells,filterHeaderCells]),getValueRef=react_1.useRef(getValue);react_1.useEffect(()=>{getValueRef.current=getValue},[getValue]);const getValueText=react_1.useCallback(cell=>{var _a;return null===(_a=getValue(cell))||void 0===_a?void 0:_a.text},[cells]),hiddenFilterRows=react_1.useMemo(()=>{var _a;const rows={};for(let i=0;i<filterViews.length;i++){const filterView=filterViews[i],{bounds:bounds,filters:filters}=filterView;for(const columnIndex in filters){const{values:values}=filters[columnIndex];for(let k=bounds.top+1;k<=bounds.bottom;k++){const cell={rowIndex:k,columnIndex:parseInt(columnIndex)},cellConfig=getValue(cell),value=null!==(_a=null==cellConfig?void 0:cellConfig.text)&&void 0!==_a?_a:"";values.includes(value)||(rows[k]=!0)}}}return rows},[filterViews]),hiddenRows=react_1.useMemo(()=>userHiddenRows.reduce((acc,item)=>(acc[item]=!0,acc),hiddenFilterRows),[hiddenFilterRows,userHiddenRows]),hiddenColumns=react_1.useMemo(()=>userHiddenColumns.reduce((acc,item)=>(acc[item]=!0,acc),{}),[userHiddenColumns]),isHiddenRow=react_1.useCallback(rowIndex=>hiddenRows[rowIndex],[hiddenRows,selectionMode]),isHiddenColumn=react_1.useCallback(columnIndex=>hiddenColumns[columnIndex],[hiddenColumns]),{isTouchDevice:isTouchDevice,scrollTo:scrollToTouch,scrollToTop:scrollToTopTouch}=grid_1.useTouch({gridRef:gridRef}),{getColumnWidth:getColumnWidth,onViewChange:onViewChange}=grid_1.useSizer({gridRef:gridRef,frozenRows:frozenRows,scale:scale,minColumnWidth:10,isHiddenRow:isHiddenRow,isHiddenColumn:isHiddenColumn,getValue:cell=>{var _a;const cellConfig=getValue(cell),formattedValue=formatter?formatter(null==cellConfig?void 0:cellConfig.text,null==cellConfig?void 0:cellConfig.datatype,cellConfig):null==cellConfig?void 0:cellConfig.text,spacing="list"===(null===(_a=null==cellConfig?void 0:cellConfig.dataValidation)||void 0===_a?void 0:_a.type)?ListArrow_1.LIST_ICON_DIM+5:0;return{...cellConfig,text:formattedValue,spacing:spacing}},getText:cellConfig=>{const text="formula"===(null==cellConfig?void 0:cellConfig.datatype)?null==cellConfig?void 0:cellConfig.result:null==cellConfig?void 0:cellConfig.text;return void 0!==text?constants_1.castToString(text):text},columnSizes:columnSizes,autoResize:!1,resizeOnScroll:!1}),handleMouseDownSelection=react_1.useCallback((e,coords,startRef,endRef)=>{if(!gridRef.current)return;const{rowCount:rowCount,columnCount:columnCount}=internalRefs.current,isShiftKey=e.nativeEvent.shiftKey,isMetaKey=e.nativeEvent.ctrlKey||e.nativeEvent.metaKey,isRowHeader=isCellRowHeader(coords.rowIndex),isColumnHeader=isCellColumnHeader(coords.columnIndex);if(isRowHeader&&isColumnHeader)return selectAll(),!1;if(isRowHeader||isColumnHeader){const actualFrozenRows=frozenRows-1,actualFrozenColumns=frozenColumns-1,start=isColumnHeader?{...coords,columnIndex:selectionLeftBound}:{...coords,rowIndex:selectionTopBound},end=isColumnHeader?{...coords,columnIndex:columnCount-1}:{...coords,rowIndex:rowCount-1},{visibleRowStartIndex:visibleRowStartIndex,visibleColumnStartIndex:visibleColumnStartIndex}=gridRef.current.getViewPort(),activeCell=isColumnHeader?{...coords,columnIndex:actualFrozenColumns>=selectionLeftBound?selectionLeftBound:visibleColumnStartIndex}:{...coords,rowIndex:actualFrozenRows>=selectionTopBound?selectionTopBound:visibleRowStartIndex};return isShiftKey?modifySelection(end):isMetaKey?(appendSelection(start,end),setActiveCellState(activeCell),gridRef.current.scrollToItem(activeCell)):(clearSelections(),startRef.current=start,endRef.current=start,modifySelection(end),setActiveCellState(activeCell),gridRef.current.scrollToItem(activeCell)),!1}},[frozenRows,frozenColumns,mergedCells]),handleMouseMoveSelection=react_1.useCallback((_,coords,startRef,endRef)=>{var _a,_b,_c,_d,_e;const{rowCount:rowCount,columnCount:columnCount}=internalRefs.current,isRowHeader=(null===(_a=startRef.current)||void 0===_a?void 0:_a.rowIndex)===selectionTopBound&&(null===(_b=endRef.current)||void 0===_b?void 0:_b.rowIndex)===rowCount-1,isColumnHeader=(null===(_c=startRef.current)||void 0===_c?void 0:_c.columnIndex)===selectionLeftBound&&(null===(_d=endRef.current)||void 0===_d?void 0:_d.columnIndex)===columnCount-1;if(isRowHeader&&isColumnHeader)return!1;if(isRowHeader||isColumnHeader){const end=isRowHeader?{...coords,rowIndex:rowCount-1}:{...coords,columnIndex:columnCount-1};return modifySelection(end),null===(_e=gridRef.current)||void 0===_e||_e.scrollToItem({rowIndex:isRowHeader?void 0:coords.rowIndex,columnIndex:isColumnHeader?void 0:coords.columnIndex}),!1}},[]),{selections:selections,activeCell:activeCell,setActiveCell:setActiveCell,setActiveCellState:setActiveCellState,setSelections:setSelections,modifySelection:modifySelection,newSelection:newSelection,clearLastSelection:clearLastSelection,appendSelection:appendSelection,selectAll:selectAll,clearSelections:clearSelections,...selectionProps}=grid_1.useSelection({selectionPolicy:selectionPolicy,selectionTopBound:selectionTopBound,selectionLeftBound:selectionLeftBound,initialActiveCell:initialActiveCell,initialSelections:initialSelections,gridRef:gridRef,rowCount:rowCount,columnCount:columnCount,onFill:onFill,isHiddenRow:isHiddenRow,isHiddenColumn:isHiddenColumn,mergedCells:mergedCells,mouseDownInterceptor:handleMouseDownSelection,mouseMoveInterceptor:handleMouseMoveSelection,canSelectionSpanMergedCells:(start,end)=>{const{rowCount:rowCount,columnCount:columnCount}=internalRefs.current;return(start.rowIndex!==selectionTopBound||end.rowIndex!==rowCount-1)&&(start.columnIndex!==selectionLeftBound||end.columnIndex!==columnCount-1)}}),{copy:copy,paste:paste,cut:cut}=grid_1.useCopyPaste({gridRef:gridRef,selections:selections,activeCell:activeCell,getValue:getValueText,onPaste:onPaste,onCut:onCut}),handleChangeFilter=react_1.useCallback((filterIndex,columnIndex,filter)=>{null==onChangeFilter||onChangeFilter(filterIndex,columnIndex,filter),hideFilter()},[]),headerSelections=react_1.useMemo(()=>{const sel={rows:{},cols:{}};for(let i=0;i<selections.length;i++){const{bounds:bounds}=selections[i],isFullColSelected=bounds.top===selectionTopBound&&bounds.bottom===rowCount-1,isFullRowSelected=bounds.left===selectionLeftBound&&bounds.right===columnCount-1;if(isFullColSelected)for(let j=bounds.left;j<=bounds.right;j++)sel.cols[j]=!0;if(isFullRowSelected)for(let j=bounds.top;j<=bounds.bottom;j++)sel.rows[j]=!0}return sel},[selections,rowCount,selectionTopBound,selectionLeftBound,columnCount]),isHeaderSelected=react_1.useCallback((index,type)=>headerSelections[type][index],[headerSelections]),{filterComponent:filterComponent,showFilter:showFilter,hideFilter:hideFilter}=grid_1.useFilter({frozenRows:frozenRows,frozenColumns:frozenColumns,gridRef:gridRef,getFilterComponent:()=>props=>react_1.default.createElement(FilterComponent_1.default,Object.assign({},props,{onChange:handleChangeFilter,onCancel:hideFilter})),getValue:getValueText}),handleFilterClick=react_1.useCallback(cell=>{var _a;const filterIndex=filterViews.findIndex(views=>views.bounds.top===cell.rowIndex),filterView=filterViews[filterIndex],currentFilter=null===(_a=null==filterView?void 0:filterView.filters)||void 0===_a?void 0:_a[cell.columnIndex];filterView&&showFilter(cell,filterIndex,filterView,currentFilter)},[filterViews,frozenRows,frozenColumns]),handleAdjustColumn=react_1.useCallback(columnIndex=>{const width=getColumnWidth(columnIndex)+(columnHasFilter(columnIndex)?FilterIcon_1.FILTER_ICON_DIM:0);null==onResize||onResize(types_1.AXIS.X,columnIndex,width)},[cells,hiddenRows,frozenRows,hiddenColumns,scale]);react_1.useEffect(()=>{var _a;0!==(null==activeCell?void 0:activeCell.rowIndex)&&0!==(null==activeCell?void 0:activeCell.columnIndex)&&(null==onActiveCellChange||onActiveCellChange(activeCell,null===(_a=getValue(activeCell))||void 0===_a?void 0:_a.text))},[activeCell]),react_1.useEffect(()=>{var _a;null===(_a=onSheetChangeRef.current)||void 0===_a||_a.call(onSheetChangeRef,{activeCell:activeCell,selections:selections}),null==onSelectionChange||onSelectionChange(activeCell,selections)},[selections,activeCell]),react_1.useEffect(()=>{var _a,_b,_c;scrollState?isTouchDevice?scrollToTouch(scrollState):null===(_a=gridRef.current)||void 0===_a||_a.scrollTo(scrollState):isTouchDevice?scrollToTopTouch():null===(_b=gridRef.current)||void 0===_b||_b.scrollToTop(),null===(_c=gridRef.current)||void 0===_c||_c.resetAfterIndices({rowIndex:0,columnIndex:0},!1),setActiveCell(initialActiveCell,!1),setSelections(initialSelections),hideFilter(),hideEditor()},[selectedSheet]);const handleSubmit=react_1.useCallback((value,cell,nextActiveCell)=>{null==onChange||onChange(value,cell),nextActiveCell&&setActiveCell(nextActiveCell,!0)},[selectedSheet]),{tooltipComponent:tooltipComponent,...tooltipProps}=grid_1.useTooltip({getTooltip:cell=>{var _a;const cellConfig=getValue(cell),isValid=null===(_a=null==cellConfig?void 0:cellConfig.valid)||void 0===_a||_a,datatype=null==cellConfig?void 0:cellConfig.datatype,hasError=!!(null==cellConfig?void 0:cellConfig.error),hasTooltip=null==cellConfig?void 0:cellConfig.tooltip,isHyperLink="hyperlink"===datatype;if(!(!1===isValid||!0===hasError||isHyperLink||hasTooltip))return null;let content;if(!1===isValid){const validation=null==cellConfig?void 0:cellConfig.dataValidation;content=null==validation?void 0:validation.prompt}hasError&&(content=null==cellConfig?void 0:cellConfig.error),hasTooltip&&(content=null==cellConfig?void 0:cellConfig.tooltip);const variant=!1===isValid?"invalid":hasError?"error":void 0,position=isHyperLink?"bottom":"right";return props=>react_1.default.createElement(Tooltip,Object.assign({},props,cellConfig,{position:position,content:content,variant:variant}))},gridRef:gridRef}),{editorComponent:editorComponent,isEditInProgress:isEditInProgress,nextFocusableCell:nextFocusableCell,makeEditable:makeEditable,setValue:setValue,hideEditor:hideEditor,submitEditor:submitEditor,cancelEditor:cancelEditor,editingCell:editingCell,showEditor:showEditor,...editableProps}=grid_1.useEditable({getEditor:cell=>{var _a,_b;const config=getValue(cell),type=constants_1.getEditorType(null===(_a=null==config?void 0:config.dataValidation)||void 0===_a?void 0:_a.type),options=null===(_b=null==config?void 0:config.dataValidation)||void 0===_b?void 0:_b.formulae;return props=>react_1.default.createElement(CellEditor,Object.assign({},props,{background:null==config?void 0:config.fill,color:null==config?void 0:config.color,fontSize:null==config?void 0:config.fontSize,fontFamily:null==config?void 0:config.fontFamily,underline:null==config?void 0:config.underline,horizontalAlign:null==config?void 0:config.horizontalAlign,scale:scale,wrap:null==config?void 0:config.wrap,editorType:type,options:options}))},frozenRows:frozenRows,frozenColumns:frozenColumns,isHiddenRow:isHiddenRow,isHiddenColumn:isHiddenColumn,gridRef:gridRef,selections:selections,activeCell:activeCell,onSubmit:handleSubmit,getValue:getValueText,onChange:onActiveCellValueChange,canEdit:cell=>{var _a;if(0===cell.rowIndex||0===cell.columnIndex)return!1;return!(null===(_a=getValue(cell))||void 0===_a?void 0:_a.readOnly)},onDelete:onDelete}),eventRefs=react_1.useRef({selectionProps:{onMouseDown:selectionProps.onMouseDown,onKeyDown:selectionProps.onKeyDown},editableProps:{onMouseDown:editableProps.onMouseDown,onKeyDown:editableProps.onKeyDown}});react_1.useEffect(()=>{eventRefs.current={selectionProps:{onMouseDown:selectionProps.onMouseDown,onKeyDown:selectionProps.onKeyDown},editableProps:{onMouseDown:editableProps.onMouseDown,onKeyDown:editableProps.onKeyDown}}});const getNextFocusableCell=react_1.useCallback((cell,direction)=>nextFocusableCell(cell,direction),[hiddenRows,hiddenColumns]),columnWidth=react_1.useCallback(columnIndex=>{var _a;return hiddenColumns[columnIndex]?0:0===columnIndex?constants_1.COLUMN_HEADER_WIDTH:null!==(_a=columnSizes[columnIndex])&&void 0!==_a?_a:minColumnWidth},[minColumnWidth,columnSizes,selectedSheet]),rowHeight=react_1.useCallback(rowIndex=>{var _a;return hiddenRows[rowIndex]?0:0===rowIndex?constants_1.ROW_HEADER_HEIGHT:null!==(_a=rowSizes[rowIndex])&&void 0!==_a?_a:minRowHeight},[minRowHeight,hiddenRows,rowSizes,selectedSheet]),contextWrapper=react_1.useCallback(children=>react_1.default.createElement(core_1.ThemeProvider,{theme:theme},react_1.default.createElement(core_1.ColorModeProvider,null,children)),[theme]),selectedRowsAndCols=react_1.useMemo(()=>{var _a,_b;const activeCellBounds=activeCell&&gridRef.current?[{bounds:null===(_b=null===(_a=gridRef.current)||void 0===_a?void 0:_a.getCellBounds)||void 0===_b?void 0:_b.call(_a,activeCell)}]:[];return[].concat(selections,activeCellBounds).reduce((acc,{bounds:bounds})=>{for(let i=bounds.left;i<=bounds.right;i++)acc.cols.push(i);for(let i=bounds.top;i<=bounds.bottom;i++)acc.rows.push(i);return acc},{rows:[],cols:[]})},[selections,activeCell,null===(_a=gridRef.current)||void 0===_a?void 0:_a.getCellBounds]),isRowSelected=react_1.useCallback(rowIndex=>selectionMode!==types_1.SELECTION_MODE.CELL&&((selectionMode===types_1.SELECTION_MODE.ROW||selectionMode===types_1.SELECTION_MODE.BOTH)&&((null==activeCell?void 0:activeCell.rowIndex)===rowIndex||selectedRowsAndCols.rows.includes(rowIndex))),[selectedRowsAndCols,activeCell,selectionMode]),isColumnSelected=react_1.useCallback(columnIndex=>selectionMode!==types_1.SELECTION_MODE.CELL&&((selectionMode===types_1.SELECTION_MODE.COLUMN||selectionMode===types_1.SELECTION_MODE.BOTH)&&((null==activeCell?void 0:activeCell.columnIndex)===columnIndex||selectedRowsAndCols.cols.includes(columnIndex))),[selectedRowsAndCols,activeCell,selectionMode]),isHiddenCell=react_1.useCallback((rowIndex,columnIndex)=>{var _a;const rowSelected=isRowSelected(rowIndex),columnSelected=isColumnSelected(columnIndex);if(rowSelected||columnSelected)return!1;const isRowHeader=isCellRowHeader(rowIndex),isColumnHeader=isCellColumnHeader(columnIndex);return!isRowHeader&&!isColumnHeader&&void 0===(null===(_a=null==cells?void 0:cells[rowIndex])||void 0===_a?void 0:_a[columnIndex])},[cells,selectionMode,selectedRowsAndCols]),handleEdit=react_1.useCallback(cell=>{makeEditable(cell)},[]),handleCheck=react_1.useCallback((cell,checked)=>{var _a,_b,_c;const cellConfig=getValueRef.current(cell),type=null===(_a=null==cellConfig?void 0:cellConfig.dataValidation)||void 0===_a?void 0:_a.type,formulae=null!==(_c=null===(_b=null==cellConfig?void 0:cellConfig.dataValidation)||void 0===_b?void 0:_b.formulae)&&void 0!==_c?_c:constants_1.DEFAULT_CHECKBOX_VALUES;if(!type)return void console.error("Type is not specified. Cell Config should contain a dataValidation object",cellConfig);const text=formulae[checked?0:1];null==onChange||onChange(text,cell),null==onActiveCellValueChange||onActiveCellValueChange(text)},[]),itemRenderer=react_1.useCallback(props=>{var _a,_b;const{rowIndex:rowIndex,columnIndex:columnIndex}=props,cell={rowIndex:rowIndex,columnIndex:columnIndex},isRowHeader=isCellRowHeader(rowIndex),isColumnHeader=isCellColumnHeader(columnIndex);if(isRowHeader||isColumnHeader){const isHeaderActive=!(!isRowHeader&&!isColumnHeader)&&(isRowHeader?selectedRowsAndCols.cols.includes(columnIndex):selectedRowsAndCols.rows.includes(rowIndex)),isFilteredColumn=columnHasFilter(columnIndex),isFilteredRow=rowHasFilter(rowIndex),isSelected=isHeaderSelected(isRowHeader?columnIndex:rowIndex,isRowHeader?"cols":"rows");return react_1.default.createElement(HeaderCellRenderer,Object.assign({},props,{isLightMode:isLightMode,isActive:isHeaderActive,onResize:onResize,onAdjustColumn:handleAdjustColumn,theme:theme,scale:scale,isFiltered:isFilteredColumn||isFilteredRow,isSelected:isSelected}))}const rowSelected=isRowSelected(rowIndex),columnSelected=isColumnSelected(columnIndex),isSelected=rowSelected||columnSelected,filterIndex=filterHeaderCells[grid_2.cellIdentifier(rowIndex,columnIndex)],showFilter=void 0!==filterIndex,cellConfig=getValue(cell),isFilterActive=void 0!==filterIndex&&!!(null===(_b=null===(_a=null==filterViews?void 0:filterViews[filterIndex])||void 0===_a?void 0:_a.filters)||void 0===_b?void 0:_b[columnIndex]);return react_1.default.createElement(CellRenderer,Object.assign({},props,cellConfig,{cellConfig:cellConfig,isLightMode:isLightMode,formatter:formatter,showStrokeOnFill:showGridLines,isSelected:isSelected,showFilter:showFilter,isFilterActive:isFilterActive,onFilterClick:handleFilterClick,scale:scale,onEdit:handleEdit,onCheck:handleCheck}))},[cells,selectedRowsAndCols,activeCell,showGridLines,selectionMode,isLightMode,theme,scale,filterHeaderCells]),overlayRenderer=react_1.useCallback(props=>{const{rowIndex:rowIndex,columnIndex:columnIndex}=props,cellConfig=getValue({rowIndex:rowIndex,columnIndex:columnIndex});return grid_1.CellOverlayRenderer({...props,...cellConfig})},[cells,selectedRowsAndCols,activeCell,hiddenRows,hiddenColumns]),handleScroll=react_1.useCallback(scrollState=>{var _a,_b;null===(_a=editableProps.onScroll)||void 0===_a||_a.call(editableProps,scrollState),null===(_b=debounceScroll.current)||void 0===_b||_b.call(debounceScroll,scrollState)},[selectedSheet]),showContextMenu=react_1.useCallback(e=>{var _a;e.preventDefault();const left=e.clientX,top=e.clientY,pos=null===(_a=gridRef.current)||void 0===_a?void 0:_a.getRelativePositionFromOffset(left,top);if(!pos)return;const{x:x,y:y}=pos;setContextMenuProps({left:x,top:y})},[]),handleMouseDown=react_1.useCallback(e=>{eventRefs.current.selectionProps.onMouseDown(e),eventRefs.current.editableProps.onMouseDown(e),hideContextMenu(),hideFilter()},[cells,selectedSheet,activeCell,selections]),handleKeyDown=react_1.useCallback(e=>{eventRefs.current.selectionProps.onKeyDown(e),eventRefs.current.editableProps.onKeyDown(e),null==onKeyDown||onKeyDown(e,activeCell,selections)},[cells,selectedSheet,activeCell,selections]),hideContextMenu=react_1.useCallback(()=>{var _a;setContextMenuProps(null),null===(_a=gridRef.current)||void 0===_a||_a.focus()},[]),fillhandleBorderColor=isLightMode?"white":constants_1.DARK_MODE_COLOR_LIGHT,gridLineColor=isLightMode?constants_1.CELL_BORDER_COLOR:null==theme?void 0:theme.colors.gray[600],shadowStroke=isLightMode?constants_1.HEADER_BORDER_COLOR:null==theme?void 0:theme.colors.gray[600],shadowSettings=react_1.useMemo(()=>({stroke:shadowStroke}),[shadowStroke]);return react_1.default.createElement(styled_1.GridWrapper,null,react_1.default.createElement(grid_1.default,Object.assign({snap:snap,scale:scale,isHiddenRow:isHiddenRow,isHiddenCell:isHiddenCell,enableCellOverlay:!0,shadowSettings:shadowSettings,showFrozenShadow:!0,gridLineColor:gridLineColor,showGridLines:showGridLines,ref:gridRef,rowCount:rowCount,columnCount:columnCount,columnWidth:columnWidth,rowHeight:rowHeight,width:width,height:height,itemRenderer:itemRenderer,overlayRenderer:overlayRenderer,wrapper:contextWrapper,selections:selections,activeCell:activeCell,fillhandleBorderColor:fillhandleBorderColor,showFillHandle:!isEditInProgress,mergedCells:mergedCells,borderStyles:borderStyles,frozenRows:frozenRows,frozenColumns:frozenColumns},selectionProps,editableProps,{onMouseDown:handleMouseDown,onKeyDown:handleKeyDown,onScroll:handleScroll,onContextMenu:showContextMenu,onViewChange:onViewChange},tooltipProps)),editorComponent,void 0!==ContextMenu&&contextMenuProps&&react_1.default.createElement(ContextMenu,Object.assign({onRequestClose:hideContextMenu,activeCell:activeCell,selections:selections,onCopy:copy,onPaste:paste,onCut:cut,onInsertRow:onInsertRow,onInsertColumn:onInsertColumn,onDeleteColumn:onDeleteColumn,onDeleteRow:onDeleteRow},contextMenuProps)),filterComponent,tooltipComponent)}));exports.default=SheetGrid},933:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const HeaderCell_1=__importDefault(__webpack_require__(934));exports.default=HeaderCell_1.default},934:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(1)),grid_1=__webpack_require__(6),constants_1=__webpack_require__(30),react_konva_1=__webpack_require__(10),types_1=__webpack_require__(90),DraggableRect=react_1.memo(props=>{const{axis:axis=types_1.AXIS.X,x:x=0,y:y=0,height:height=0,width:width=0,columnIndex:columnIndex,rowIndex:rowIndex,onResize:onResize,parentX:parentX=0,parentY:parentY=0,showResizer:showResizer}=props,index=react_1.useMemo(()=>axis===types_1.AXIS.X?columnIndex:rowIndex,[axis]);return react_1.default.createElement(react_konva_1.Rect,Object.assign({perfectDrawEnabled:!1,fill:showResizer?"#4C90FD":"transparent",draggable:!0,strokeScaleEnabled:!1,shadowForStrokeEnable:!1,hitStrokeWidth:10,onMouseDown:e=>e.evt.stopPropagation(),dragBoundFunc:pos=>({...pos,...axis===types_1.AXIS.X?{y:0}:{x:0}}),onDragMove:e=>{const node=e.target,dimension=axis===types_1.AXIS.X?node.x()-parentX+5:node.y()-parentY+5;null==onResize||onResize(axis,index,dimension)},onTouchStart:e=>{e.evt.stopPropagation()},x:x,y:y,width:width,height:height},props))}),HeaderCell=react_1.memo(props=>{const[showResizer,setShowResizer]=react_1.useState(!1),{rowIndex:rowIndex,columnIndex:columnIndex,isActive:isActive,x:x=0,y:y=0,width:width=0,height:height=0,isLightMode:isLightMode,theme:theme}=props,{onResize:onResize,onAdjustColumn:onAdjustColumn,scale:scale=1,isFiltered:isFiltered,isSelected:isSelected,...rest}=props,isCorner=rowIndex===columnIndex,value=isCorner?"":0===rowIndex?constants_1.number2Alpha(columnIndex-1):rowIndex.toString(),isRowHeader=0===rowIndex,fill=isLightMode?isFiltered?isSelected?"#198039":"#E6F4EA":isSelected?"#5F6268":isActive?"#E9EAED":"#F8F9FA":isActive?theme.colors.gray[700]:constants_1.DARK_MODE_COLOR,textColor=isSelected||!isLightMode?"white":"#333",stroke=isLightMode?constants_1.HEADER_BORDER_COLOR:theme.colors.gray[600],axis=isRowHeader?types_1.AXIS.X:types_1.AXIS.Y,cursor=axis===types_1.AXIS.X?"e-resize":"n-resize",handleMouseEnter=react_1.useCallback(()=>{document.body.style.cursor=cursor,setShowResizer(!0)},[]),handleMouseLeave=react_1.useCallback(()=>{document.body.style.cursor="default",setShowResizer(!1)},[]),fontSize=10*scale;return react_1.default.createElement(grid_1.Cell,Object.assign({},rest,{x:x+.5,y:y+.5,fill:fill,align:"center",value:value,textColor:textColor,stroke:stroke,fontSize:fontSize}),isCorner?null:react_1.default.createElement(DraggableRect,{parentX:x,parentY:y,x:isRowHeader?x+width-5:x,y:isRowHeader?y:y+height-5,width:isRowHeader?5:width,height:isRowHeader?height:5,axis:axis,rowIndex:rowIndex,columnIndex:columnIndex,onResize:onResize,onDblClick:()=>null==onAdjustColumn?void 0:onAdjustColumn(columnIndex),showResizer:showResizer,onMouseEnter:handleMouseEnter,onMouseLeave:handleMouseLeave}))});exports.default=HeaderCell},935:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ErrorTag=void 0;const react_1=__importStar(__webpack_require__(1)),grid_1=__webpack_require__(6),constants_1=__webpack_require__(30),types_1=__webpack_require__(90),react_konva_1=__webpack_require__(10),FilterIcon_1=__importDefault(__webpack_require__(936)),ListArrow_1=__importDefault(__webpack_require__(937)),Checkbox_1=__importDefault(__webpack_require__(938)),FilterIcon_2=__webpack_require__(254),DEFAULT_WRAP="none",Cell=react_1.memo(props=>{var _a;const{datatype:datatype,formatter:formatter,isLightMode:isLightMode}=props,{stroke:stroke,strokeTopColor:strokeTopColor,strokeRightColor:strokeRightColor,strokeBottomColor:strokeBottomColor,strokeLeftColor:strokeLeftColor,strokeDash:strokeDash,strokeTopDash:strokeTopDash,strokeRightDash:strokeRightDash,strokeBottomDash:strokeBottomDash,strokeLeftDash:strokeLeftDash,strokeWidth:strokeWidth,strokeTopWidth:strokeTopWidth,strokeRightWidth:strokeRightWidth,strokeBottomWidth:strokeBottomWidth,strokeLeftWidth:strokeLeftWidth,lineCap:lineCap,format:format,currencySymbol:currencySymbol,dataValidation:dataValidation,cellConfig:cellConfig,...cellProps}=props,validatorType=null==dataValidation?void 0:dataValidation.type,checked="boolean"===validatorType&&props.text===(null===(_a=null==dataValidation?void 0:dataValidation.formulae)||void 0===_a?void 0:_a[0]),textValue="formula"===datatype&&(props.error||props.result)||props.text,text=formatter?formatter(textValue,datatype,cellConfig):constants_1.castToString(textValue);return react_1.default.createElement(DefaultCell,Object.assign({isLightMode:isLightMode},cellProps,{text:text,type:validatorType,checked:checked}))}),DefaultCell=react_1.memo(props=>{const{x:x=0,y:y=0,width:width,height:height,isMergedCell:isMergedCell,fill:fill,datatype:datatype,color:userColor,italic:italic,bold:bold,horizontalAlign:horizontalAlign,verticalAlign:verticalAlign="bottom",underline:underline,strike:strike,fontFamily:fontFamily,padding:padding=4,fontSize:fontSize=constants_1.DEFAULT_FONT_SIZE,wrap:wrap=DEFAULT_WRAP,lineHeight:lineHeight=1,isLightMode:isLightMode,text:text,showStrokeOnFill:showStrokeOnFill=!0,isSelected:isSelected,selectionFill:selectionFill="rgb(14, 101, 235, 0.1)",plaintext:plaintext,showFilter:showFilter,isFilterActive:isFilterActive,onFilterClick:onFilterClick,scale:scale,rotation:rotation,valid:valid,type:validatorType,onEdit:onEdit,checked:checked,onCheck:onCheck,error:error}=props,isBoolean="boolean"===validatorType,textWrap="wrap"===wrap?"word":DEFAULT_WRAP,textDecoration=`${underline?types_1.TEXT_DECORATION.UNDERLINE+" ":""}${strike?types_1.TEXT_DECORATION.STRIKE:""}`,userFill=isSelected?selectionFill:fill,textStyle=`${bold?types_1.FONT_WEIGHT.BOLD:types_1.FONT_WEIGHT.NORMAL} ${italic?types_1.FONT_STYLE.ITALIC:types_1.FONT_STYLE.NORMAL}`,vAlign=verticalAlign,hAlign=void 0===horizontalAlign?"number"!==datatype||plaintext?"left":"right":horizontalAlign,defaultFill=isLightMode?"white":constants_1.DARK_MODE_COLOR_LIGHT,textColor=userColor||(isLightMode?"#333":"white"),showRect=!grid_1.isNull(userFill)||isMergedCell,hasFill=!grid_1.isNull(userFill)||isSelected,hasText=!grid_1.isNull(text),showArrow="list"===validatorType,isInValid=!1===valid,showTag=isInValid||!!error,textWidth=showFilter||showArrow?width-FilterIcon_2.FILTER_ICON_DIM-1:width-1,fillFunc=react_1.useCallback((context,shape)=>{context.beginPath(),context.setAttr("fillStyle",userFill||defaultFill),context.fillRect(1,1,shape.width()-1,shape.height()-1),hasFill&&(context.setAttr("strokeStyle",showStrokeOnFill?constants_1.luminance(userFill,-20):userFill),context.strokeRect(.5,.5,shape.width(),shape.height()))},[hasFill,userFill,isSelected,defaultFill]);return react_1.default.createElement(react_1.default.Fragment,null,showRect?react_1.default.createElement(react_konva_1.Shape,{visible:showRect,x:x,y:y,width:width,height:height,sceneFunc:fillFunc}):null,isBoolean&&!isInValid?react_1.default.createElement(Checkbox_1.default,{x:x,y:y,width:width,height:height,checked:checked,onChange:onCheck,rowIndex:props.rowIndex,columnIndex:props.columnIndex}):hasText?react_1.default.createElement(react_konva_1.Text,{visible:hasText,x:x+1,y:y+1.5,height:height,width:textWidth,text:text,fill:textColor,verticalAlign:vAlign,align:hAlign,fontFamily:fontFamily,fontStyle:textStyle,textDecoration:textDecoration,padding:padding,wrap:textWrap,fontSize:fontSize*scale,lineHeight:lineHeight,hitStrokeWidth:0,perfectDrawEnabled:!1,listening:!1,rotation:rotation}):null,showFilter?react_1.default.createElement(FilterIcon_1.default,{isActive:isFilterActive,onClick:onFilterClick,rowIndex:props.rowIndex,columnIndex:props.columnIndex,x:x,y:y,height:height,width:width}):showArrow?react_1.default.createElement(ListArrow_1.default,{onClick:onEdit,rowIndex:props.rowIndex,columnIndex:props.columnIndex,x:x,y:y,height:height,width:width}):null,showTag?react_1.default.createElement(exports.ErrorTag,{color:isInValid?constants_1.INVALID_COLOR:constants_1.ERROR_COLOR,x:x+width-6.5,y:y+1}):null)});exports.ErrorTag=({x:x,y:y,color:color=constants_1.INVALID_COLOR})=>react_1.default.createElement(react_konva_1.Shape,{x:x,y:y,sceneFunc:context=>{context.beginPath(),context.setAttr("fillStyle",color),context.moveTo(0,0),context.lineTo(6.5,0),context.lineTo(6.5,6.5),context.closePath(),context.fill()}}),exports.default=Cell},936:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const FilterIcon_1=__importDefault(__webpack_require__(254));exports.default=FilterIcon_1.default},937:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const ListArrow_1=__importDefault(__webpack_require__(410));exports.default=ListArrow_1.default},938:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const Checkbox_1=__importDefault(__webpack_require__(939));exports.default=Checkbox_1.default},939:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.CHECKBOX_CHECKED_ICON=exports.CHECKBOX_ICON=exports.CHECKBOX_ICON_DIM=void 0;const react_1=__importStar(__webpack_require__(1)),react_konva_1=__webpack_require__(10);exports.CHECKBOX_ICON_DIM=16;exports.CHECKBOX_ICON="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z",exports.CHECKBOX_CHECKED_ICON="M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z";exports.default=({x:x=0,y:y=0,width:width=0,height:height=0,checked:checked,onChange:onChange,rowIndex:rowIndex,columnIndex:columnIndex})=>{const[isHovered,setIsHovered]=react_1.useState(!1),dim=exports.CHECKBOX_ICON_DIM,posX=x+width/2-dim/2+.5-1.5,posY=y+height/2-dim/2+.5-1.5,handleMouseEnter=react_1.useCallback(()=>{setIsHovered(!0)},[]),handleMouseLeave=react_1.useCallback(()=>{setIsHovered(!1)},[]),handleClick=react_1.useCallback(()=>{null==onChange||onChange({rowIndex:rowIndex,columnIndex:columnIndex},!checked)},[checked,rowIndex,columnIndex]);return react_1.default.createElement(react_konva_1.Group,{onClick:handleClick,onMouseEnter:handleMouseEnter,onMouseLeave:handleMouseLeave},react_1.default.createElement(react_konva_1.Rect,{x:posX,y:posY,width:dim,height:dim,cornerRadius:2}),react_1.default.createElement(react_konva_1.Path,{data:checked?exports.CHECKBOX_CHECKED_ICON:exports.CHECKBOX_ICON,x:posX,y:posY,scaleY:.8,scaleX:.8,listening:!1,fill:isHovered?"#444":"#808080"}))}},940:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(1)),grid_1=__webpack_require__(6),TextEditor=react_1.memo(react_1.forwardRef((props,forwardedRef)=>{const inputRef=react_1.useRef(null);react_1.useEffect(()=>{inputRef.current&&(inputRef.current.focus(),inputRef.current.selectionStart=value.length)},[]);const{value:value,onChange:onChange,onSubmit:onSubmit,onCancel:onCancel,fontFamily:fontFamily,fontSize:fontSize,scale:scale,color:color,wrapping:wrapping,horizontalAlign:horizontalAlign,underline:underline,...rest}=props;return react_1.default.createElement("textarea",Object.assign({rows:1,cols:1,ref:inputRef,value:value,style:{fontFamily:fontFamily,fontSize:fontSize*scale,width:"100%",height:"100%",padding:"0 1px",margin:0,boxSizing:"border-box",borderWidth:0,outline:"none",resize:"none",overflow:"hidden",verticalAlign:"top",background:"transparent",color:color,whiteSpace:wrapping,textAlign:horizontalAlign,textDecoration:underline?"underline":"none"},onChange:e=>{onChange(e.target.value)},onKeyDown:e=>{if(!inputRef.current)return;const isShiftKey=e.nativeEvent.shiftKey,isMetaKey=e.nativeEvent.metaKey,value=inputRef.current.value;if(e.which===grid_1.KeyCodes.Enter){if(isMetaKey)return onChange(value+"\n");onSubmit&&onSubmit(value,isShiftKey?grid_1.Direction.Up:grid_1.Direction.Down)}e.which===grid_1.KeyCodes.Escape&&onCancel&&onCancel(),e.which===grid_1.KeyCodes.Tab&&(e.preventDefault(),onSubmit&&onSubmit(value,isShiftKey?grid_1.Direction.Left:grid_1.Direction.Right))}},rest))}));exports.default=TextEditor},941:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(1)),grid_1=__webpack_require__(6),downshift_1=__importDefault(__webpack_require__(417)),core_1=__webpack_require__(33),constants_1=__webpack_require__(30),EMPTY_ARRAY=[],ListEditor=react_1.memo(react_1.forwardRef((props,forwardedRef)=>{const inputRef=react_1.useRef(null),{value:initialValue,onChange:onChange,onSubmit:onSubmit,onCancel:onCancel,fontFamily:fontFamily,fontSize:fontSize,scale:scale,color:color,wrapping:wrapping,horizontalAlign:horizontalAlign,options:options=EMPTY_ARRAY,...rest}=props,initialInputValue=react_1.useRef(initialValue),direction=react_1.useRef(null);react_1.useEffect(()=>{inputRef.current&&(inputRef.current.focus(),inputRef.current.selectionStart=initialValue.length)},[]);const theme=core_1.useTheme(),{colorMode:colorMode}=core_1.useColorMode(),isLight="light"===colorMode,borderColor=isLight?theme.colors.gray[300]:theme.colors.gray[600],inputColor=isLight?constants_1.DARK_MODE_COLOR:theme.colors.white,dropdownBgColor=isLight?theme.colors.white:theme.colors.gray[700];return react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(downshift_1.default,{initialInputValue:initialValue,onChange:value=>{onSubmit(null!=value?value:void 0)},initialIsOpen:!0,initialSelectedItem:initialValue},({getRootProps:getRootProps,getInputProps:getInputProps,getMenuProps:getMenuProps,isOpen:isOpen,getItemProps:getItemProps,inputValue:inputValue,selectedItem:selectedItem,highlightedIndex:highlightedIndex})=>{direction.current=null;const inputProps=getInputProps(),items=options.filter(item=>!inputValue||inputValue===initialInputValue.current||new RegExp(inputValue,"gi").test(item));return react_1.default.createElement(core_1.Box,Object.assign({},getRootProps()),react_1.default.createElement("input",Object.assign({},inputProps,{ref:inputRef,style:{fontFamily:fontFamily,fontSize:fontSize*scale,width:"100%",height:"100%",padding:"0 1px",margin:0,boxSizing:"border-box",borderWidth:0,outline:"none",resize:"none",overflow:"hidden",verticalAlign:"top",background:"transparent",color:color,whiteSpace:wrapping,textAlign:horizontalAlign},onChange:e=>{var _a;null===(_a=inputProps.onChange)||void 0===_a||_a.call(inputProps,e),null==onChange||onChange(e.target.value)},onKeyDown:e=>{if(!inputRef.current)return;const isShiftKey=e.nativeEvent.shiftKey,isMetaKey=e.nativeEvent.metaKey,value=inputRef.current.value;if(inputProps&&inputProps.onKeyDown&&e.which!==grid_1.KeyCodes.Enter&&inputProps.onKeyDown(e),e.which===grid_1.KeyCodes.Enter){if(isMetaKey)return onChange(value+"\n");onSubmit&&onSubmit(null===highlightedIndex?value:items[highlightedIndex],isShiftKey?grid_1.Direction.Up:grid_1.Direction.Down)}e.which===grid_1.KeyCodes.Escape&&onCancel&&onCancel(),e.which===grid_1.KeyCodes.Tab&&onSubmit&&onSubmit(null===highlightedIndex?value:items[highlightedIndex],isShiftKey?grid_1.Direction.Left:grid_1.Direction.Right)}})),react_1.default.createElement(core_1.Box,Object.assign({},getMenuProps(),{width:"auto",left:"-2px",shadow:"md",background:dropdownBgColor,pb:1,pt:1,position:"absolute",top:"100%",mt:"2px",borderColor:borderColor,borderStyle:"solid",borderWidth:1,minWidth:"calc(100% + 4px)"}),items.map((item,index)=>react_1.default.createElement(core_1.Box,Object.assign({fontSize:12,padding:1,pl:2,pr:2,whiteSpace:"nowrap"},getItemProps({key:item,item:item,index:index}),{color:inputColor,cursor:"pointer",style:{fontWeight:selectedItem===item?"bold":"normal",backgroundColor:highlightedIndex===index||selectedItem===item?isLight?theme.colors.gray[100]:"rgba(255,255,255,0.06)":dropdownBgColor}}),item))))}))}));exports.default=ListEditor},942:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const FilterComponent_1=__importDefault(__webpack_require__(943));exports.default=FilterComponent_1.default},943:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(1)),core_1=__webpack_require__(33),constants_1=__webpack_require__(30),styled_1=__webpack_require__(89),react_list_1=__importDefault(__webpack_require__(944)),sortFn=(a,b)=>"string"==typeof a&&"string"==typeof b?Intl.Collator().compare(a,b):a==b?0:a>b?1:-1;exports.default=({position:position,onChange:onChange,onCancel:onCancel,values:values=[],filter:filter,columnIndex:columnIndex,index:index,width:width})=>{if(!columnIndex)return null;const[filterText,setFilterText]=react_1.useState(""),{values:selectedValues=[]}=filter||{},[userValues,setUserValues]=react_1.useState(filter?selectedValues:values),searchInputRef=react_1.useRef(null),theme=core_1.useTheme(),{colorMode:colorMode}=core_1.useColorMode(),isLight="light"===colorMode,color=isLight?constants_1.DARK_MODE_COLOR:theme.colors.white,borderColor=isLight?theme.colors.gray[300]:theme.colors.gray[600],bgColor=isLight?theme.colors.white:theme.colors.gray[700];let{x:x=0,y:y}=position;const handleChange=react_1.useCallback(e=>{const{value:value,checked:checked}=e.target;setUserValues(checked?prev=>prev.concat(value):prev=>prev.filter(v=>v!==value))},[]);react_1.useEffect(()=>{var _a;null===(_a=searchInputRef.current)||void 0===_a||_a.focus()},[]);const handleSubmit=react_1.useCallback(()=>{const selectedFilter=userValues.length===values.length?void 0:{values:userValues,operator:null==filter?void 0:filter.operator};null==onChange||onChange(index,columnIndex,selectedFilter)},[userValues]),items=(!(values.length===userValues.length)&&userValues.length,values.filter(value=>new RegExp(filterText,"gi").test(value.toString())).sort(sortFn)),itemRenderer=react_1.useCallback((index,key)=>{const value=items[index],valueItem=value||"",isChecked=-1!==userValues.indexOf(valueItem),label=value||"(Blanks)";return react_1.default.createElement(core_1.Box,{key:key,pb:1,display:"flex"},react_1.default.createElement(core_1.Checkbox,{onChange:handleChange,value:valueItem,size:"sm",borderColor:borderColor,isChecked:isChecked,alignItems:"flex-start",lineHeight:"1rem",color:color},react_1.default.createElement(core_1.Box,{fontSize:12},label)))},[items]);return react_1.default.createElement(core_1.Box,{left:0,top:0,position:"absolute",zIndex:1,transform:`translate(${x}px, ${y}px)`},react_1.default.createElement(core_1.Box,{shadow:"md",bg:bgColor,borderColor:borderColor,borderWidth:1,borderStyle:"solid",borderRadius:5,width:width},react_1.default.createElement(core_1.Box,{padding:3},react_1.default.createElement(styled_1.Button,{onClick:()=>setUserValues(values),variant:"link",fontSize:12,mr:2,background:"none",size:"sm"},"Select all"),react_1.default.createElement(styled_1.Button,{onClick:()=>setUserValues([]),variant:"link",fontSize:12,background:"none",size:"sm"},"Clear"),react_1.default.createElement(core_1.InputGroup,{size:"sm",mt:2},react_1.default.createElement(core_1.InputLeftElement,{height:"26px",children:react_1.default.createElement(core_1.Icon,{name:"search",color:"gray.300"})}),react_1.default.createElement(core_1.Input,{type:"text",size:"sm",borderColor:borderColor,value:filterText,onChange:e=>{setFilterText(e.target.value)},color:color,ref:searchInputRef,height:"26px"})),react_1.default.createElement(core_1.Box,{overflow:"auto",minHeight:100,maxHeight:200,mt:2,mb:1,pt:2,pb:2,pl:1,pr:1},react_1.default.createElement(react_list_1.default,{itemRenderer:itemRenderer,length:items.length,type:"variable"})),react_1.default.createElement(core_1.Box,{pt:2},react_1.default.createElement(styled_1.Button,{size:"sm",variantColor:"green",variant:"solid",onClick:handleSubmit,mr:1},"Done"),react_1.default.createElement(styled_1.Button,{bg:borderColor,size:"sm",variant:"outline",onClick:onCancel},"Cancel")))))}},945:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const Tabs_1=__importDefault(__webpack_require__(946));exports.default=Tabs_1.default},946:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importDefault(__webpack_require__(1)),go_1=__webpack_require__(947),md_1=__webpack_require__(170),core_1=__webpack_require__(33),constants_1=__webpack_require__(30),styled_1=__webpack_require__(89),core_2=__webpack_require__(33),TabItem_1=__importDefault(__webpack_require__(948)),translations_1=__webpack_require__(398);exports.default=props=>{const{sheets:sheets,onSelect:onSelect,onNewSheet:onNewSheet,selectedSheet:selectedSheet,onChangeSheetName:onChangeSheetName,onDeleteSheet:onDeleteSheet,onDuplicateSheet:onDuplicateSheet,isTabEditable:isTabEditable,allowNewSheet:allowNewSheet}=props,theme=core_1.useTheme(),{colorMode:colorMode}=core_1.useColorMode(),isLight="light"===colorMode,color=isLight?theme.colors.gray[900]:theme.colors.gray[300];return react_1.default.createElement(core_1.Flex,{pl:constants_1.COLUMN_HEADER_WIDTH,alignItems:"center",minWidth:0,flex:1},allowNewSheet&&react_1.default.createElement(styled_1.Tooltip,{placement:"top-start",hasArrow:!0,"aria-label":translations_1.translations.add_sheet,label:translations_1.translations.add_sheet},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.add_sheet,icon:go_1.GoPlus,onClick:onNewSheet,variant:"ghost",color:color})),react_1.default.createElement(core_2.Popover,{placement:"top"},react_1.default.createElement(core_2.PopoverTrigger,null,react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.Tooltip,{placement:"top-start",hasArrow:!0,"aria-label":translations_1.translations.all_sheets,label:translations_1.translations.all_sheets},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.all_sheets,icon:md_1.MdMenu,variant:"ghost",color:color})))),react_1.default.createElement(core_2.PopoverContent,{width:200,borderColor:isLight?void 0:constants_1.DARK_MODE_COLOR},react_1.default.createElement(core_2.PopoverArrow,null),react_1.default.createElement(core_2.PopoverBody,{overflow:"auto",maxHeight:400},sheets.map((sheet,idx)=>{const isActive=selectedSheet===sheet.id;return react_1.default.createElement(styled_1.Button,{key:idx,fontWeight:"normal",size:"sm",variant:"ghost",background:"none",isFullWidth:!0,textAlign:"left",justifyContent:"left",borderRadius:0,onClick:()=>null==onSelect?void 0:onSelect(sheet.id)},react_1.default.createElement(core_1.Box,{as:md_1.MdCheck,mr:2,visibility:isActive?"visible":"hidden"}),sheet.name)})))),react_1.default.createElement(core_1.Box,{overflow:"auto",display:"flex",pl:1,pr:1},sheets.map((sheet,idx)=>{const isActive=selectedSheet===sheet.id;return react_1.default.createElement(TabItem_1.default,{key:idx,id:sheet.id,name:sheet.name,isLight:isLight,onSelect:onSelect,isActive:isActive,onChangeSheetName:onChangeSheetName,onDeleteSheet:onDeleteSheet,onDuplicateSheet:onDuplicateSheet})})))}},948:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(1)),core_1=__webpack_require__(33),md_1=__webpack_require__(170),types_1=__webpack_require__(62),styled_1=__webpack_require__(89);exports.default=({name:name,isLight:isLight,isActive:isActive,id:id,onSelect:onSelect,onChangeSheetName:onChangeSheetName,onDeleteSheet:onDeleteSheet,onDuplicateSheet:onDuplicateSheet})=>{const theme=core_1.useTheme(),[isEditmode,setIsEditmode]=react_1.useState(!1),[value,setValue]=react_1.useState(name),bg=isActive?"white":void 0,color=isActive||isLight?theme.colors.gray[900]:theme.colors.gray[300],shadow=isActive?"0 1px 3px 1px rgba(60,64,67,.15)":void 0,borderColor=isLight?theme.colors.gray[300]:theme.colors.gray[600],enableEditmode=()=>setIsEditmode(!0),disableEditmode=()=>setIsEditmode(!1);return react_1.default.createElement(core_1.Box,{position:"relative",display:"flex",alignItems:"center",height:"39px",background:bg,boxShadow:shadow},isEditmode?react_1.default.createElement(core_1.Input,{defaultValue:name,onChange:e=>setValue(e.target.value),width:"auto",onBlur:e=>{const value=e.currentTarget.value;value!==name&&(null==onChangeSheetName||onChangeSheetName(id,value)),disableEditmode()},height:"26px",background:"white",pl:1,pr:1,ml:2,mr:2,size:"sm",autoFocus:!0,onKeyDown:e=>{e.which===types_1.KeyCodes.Enter&&(null==onChangeSheetName||onChangeSheetName(id,value),disableEditmode()),e.which===types_1.KeyCodes.Escape&&disableEditmode()}}):react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(styled_1.Button,{as:"div",size:"sm",fontWeight:"normal",borderRadius:0,color:color,height:"39px",onDoubleClick:enableEditmode,onClick:()=>null==onSelect?void 0:onSelect(id),background:bg,cursor:"pointer",_hover:{background:isActive?bg:isLight?theme.colors.gray[200]:theme.colors.gray[800]}},name,react_1.default.createElement(core_1.Popover,{placement:"top",usePortal:!0},({onClose:onClose})=>react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(styled_1.IconButton,{variant:"ghost",size:"sm",pl:0,pr:0,minWidth:4,height:4,ml:1,mr:-1,"aria-label":"More",icon:md_1.MdArrowDropDown,fontSize:20,color:"gray.400"})),react_1.default.createElement(styled_1.PopoverContent,{width:200,borderStyle:"solid",borderColor:borderColor},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.PopoverBody,null,react_1.default.createElement(styled_1.Button,{fontWeight:"normal",size:"sm",variant:"ghost",isFullWidth:!0,textAlign:"left",justifyContent:"left",borderRadius:0,background:"none",onClick:e=>{null==onClose||onClose(),null==onDeleteSheet||onDeleteSheet(id),e.preventDefault(),e.stopPropagation()}},"Delete"),react_1.default.createElement(styled_1.Button,{fontWeight:"normal",size:"sm",variant:"ghost",background:"none",isFullWidth:!0,textAlign:"left",justifyContent:"left",borderRadius:0,onClick:e=>{null==onClose||onClose(),null==onDuplicateSheet||onDuplicateSheet(id),e.preventDefault(),e.stopPropagation()}},"Duplicate"),react_1.default.createElement(styled_1.Button,{fontWeight:"normal",size:"sm",variant:"ghost",isFullWidth:!0,textAlign:"left",background:"none",justifyContent:"left",borderRadius:0,onClick:e=>{enableEditmode(),e.preventDefault(),e.stopPropagation()}},"Rename"))))))))}},949:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const StatusBar_1=__importDefault(__webpack_require__(950));exports.default=StatusBar_1.default},950:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(1)),core_1=__webpack_require__(33),grid_1=__webpack_require__(6),constants_1=__webpack_require__(30),EMPTY_ARRAY=[],StatusBar=react_1.memo(({selections:selections=EMPTY_ARRAY,cells:cells})=>{var _a;const{colorMode:colorMode}=core_1.useColorMode(),isLight="light"===colorMode,bg=isLight?"white":"#000",color=isLight?"#333":"#ccc",shadow=isLight?"0 0 2px 1px rgba(0,0,0,0.2)":"0 0 2px 1px rgba(255,255,255,0.2)";let count=0,avg=0,sum=0;const getMinMax=o=>{const keys=Object.keys(null!=o?o:{}).map(Number);return[Math.min(...keys),Math.max(...keys)]},[minRow,maxRow]=react_1.useMemo(()=>getMinMax(cells),[cells]);for(let i=0;i<selections.length;i++){const{bounds:bounds}=selections[i],top=Math.max(minRow,bounds.top),bottom=Math.min(maxRow,bounds.bottom);for(let j=top;j<=bottom;j++){const[minCol,maxCol]=getMinMax(cells[j]),left=Math.max(minCol,bounds.left),right=Math.min(maxCol,bounds.right);for(let k=left;k<=right;k++){const cell=null===(_a=cells[j])||void 0===_a?void 0:_a[k];void 0!==cell&&(!grid_1.isNull(cell.text)&&constants_1.isNumeric(cell)&&(count+=1,sum+=Number(cell.text)))}}}if(avg=sum/count,0===count&&0===sum&&0===avg)return null;const avgFixed=avg.toFixed(2);return react_1.default.createElement(core_1.Box,{display:"flex",alignItems:"center",pr:2,pl:2},0!==count&&react_1.default.createElement(core_1.Box,{ml:2,boxShadow:shadow,bg:bg,color:color,borderRadius:5,pl:2,pr:2,pt:1,pb:1},react_1.default.createElement(core_1.Text,{as:"div",fontSize:"xs"},"Count: ",count)),count>0&&react_1.default.createElement(core_1.Box,{ml:2,boxShadow:shadow,bg:bg,color:color,borderRadius:5,pl:2,pr:2,pt:1,pb:1},react_1.default.createElement(core_1.Text,{as:"div",fontSize:"xs"},"Sum: ",sum)),count>0&&react_1.default.createElement(core_1.Box,{ml:2,boxShadow:shadow,bg:bg,color:color,borderRadius:5,pl:2,pr:2,pt:1,pb:1},react_1.default.createElement(core_1.Text,{as:"div",fontSize:"xs"},"Avg: ",avgFixed)))});exports.default=StatusBar},951:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__webpack_require__(1),WebFont=__webpack_require__(6).canUseDOM?__webpack_require__(952):null;exports.default=config=>{const[isFontActive,setIsFontActive]=react_1.useState(!1);return react_1.useEffect(()=>{config&&null!==WebFont&&WebFont.load({...config,loading:()=>setIsFontActive(!1),active:()=>setIsFontActive(!0)})},[config]),{isFontActive:isFontActive}}},954:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const ContextMenu_1=__importDefault(__webpack_require__(955));exports.default=ContextMenu_1.default},955:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importDefault(__webpack_require__(1)),core_1=__webpack_require__(33),md_1=__webpack_require__(170),styled_1=__webpack_require__(89);exports.default=({left:left,top:top,onInsertRow:onInsertRow,onDeleteRow:onDeleteRow,onInsertColumn:onInsertColumn,onDeleteColumn:onDeleteColumn,onCut:onCut,onCopy:onCopy,onPaste:onPaste,activeCell:activeCell,selections:selections,onRequestClose:onRequestClose})=>{const theme=core_1.useTheme(),{colorMode:colorMode}=core_1.useColorMode(),isLight="light"===colorMode,color=isLight?theme.colors.gray[800]:theme.colors.gray[100],borderColor=isLight?theme.colors.gray[300]:theme.colors.gray[600],dividerColor=isLight?theme.colors.gray[300]:"rgba(255, 255, 255, 0.16)";return react_1.default.createElement(core_1.Box,{left:0,top:0,position:"absolute",zIndex:1,transform:`translate(${left}px, ${top}px)`},react_1.default.createElement(core_1.Menu,{isOpen:!0},react_1.default.createElement(core_1.MenuList,{fontSize:14,color:color,borderColor:borderColor,borderStyle:"solid"},react_1.default.createElement(styled_1.MenuItem,{alignItems:"center",onClick:()=>{null==onCut||onCut(activeCell,selections),null==onRequestClose||onRequestClose()}},react_1.default.createElement(core_1.Box,{mr:2,as:md_1.MdContentCut}),"Cut"),react_1.default.createElement(styled_1.MenuItem,{onClick:()=>{null==onCopy||onCopy(activeCell,selections),null==onRequestClose||onRequestClose()}},react_1.default.createElement(core_1.Box,{mr:2,as:md_1.MdContentCopy}),"Copy"),react_1.default.createElement(styled_1.MenuItem,{onClick:()=>{null==onPaste||onPaste(activeCell,selections),null==onRequestClose||onRequestClose()}},react_1.default.createElement(core_1.Box,{mr:2,as:md_1.MdContentPaste}),"Paste"),react_1.default.createElement(core_1.MenuDivider,{borderColor:dividerColor}),react_1.default.createElement(styled_1.MenuItem,{onClick:()=>{null==onInsertRow||onInsertRow(activeCell,selections),null==onRequestClose||onRequestClose()}},"Insert row"),react_1.default.createElement(styled_1.MenuItem,{onClick:()=>{null==onInsertColumn||onInsertColumn(activeCell,selections),null==onRequestClose||onRequestClose()}},"Insert column"),react_1.default.createElement(core_1.MenuDivider,{borderColor:dividerColor}),react_1.default.createElement(styled_1.MenuItem,{onClick:()=>{null==onDeleteRow||onDeleteRow(activeCell,selections),null==onRequestClose||onRequestClose()}},"Delete row"),react_1.default.createElement(styled_1.MenuItem,{onClick:()=>{null==onDeleteColumn||onDeleteColumn(activeCell,selections),null==onRequestClose||onRequestClose()}},"Delete column"))))}},956:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.createExcelFileFromSheets=exports.parseExcel=exports.hasBorder=exports.removeHex=exports.getTypeFromDataType=exports.getDataTypeFromType=void 0;const exceljs_1=__importStar(__webpack_require__(957)),spreadsheet_1=__webpack_require__(42),grid_1=__webpack_require__(6);exports.getDataTypeFromType=type=>{switch(type){case exceljs_1.ValueType.Number:return"number";case exceljs_1.ValueType.Date:return"date";case exceljs_1.ValueType.Formula:return"formula";case exceljs_1.ValueType.Hyperlink:return"hyperlink";case exceljs_1.ValueType.Null:return"null";default:return"string"}},exports.getTypeFromDataType=datatype=>{switch(datatype){case"number":return exceljs_1.ValueType.Number;case"date":return exceljs_1.ValueType.Date;default:return exceljs_1.ValueType.String}};const getCellText=cell=>{var _a;switch(cell.type){case exceljs_1.ValueType.Null:return"";case exceljs_1.ValueType.Formula:return"="+cell.value.formula;case exceljs_1.ValueType.Hyperlink:{const text=cell.value.text;return"string"==typeof text?text:"Unable to parse"}case exceljs_1.ValueType.RichText:return cell.value.richText.map(value=>value.text).join(" ");default:return null===(_a=cell.value)||void 0===_a?void 0:_a.toString()}},getCellAttributes=cell=>{const attrs={};switch(cell.type){case exceljs_1.ValueType.Formula:attrs.result=cell.value.result,attrs.error=(cell=>Object.values(exceljs_1.ErrorValue).find(val=>val===cell.value.result))(cell);break;case exceljs_1.ValueType.Hyperlink:attrs.hyperlink=cell.value.hyperlink}return attrs};exports.removeHex=str=>str.replace("#",""),exports.hasBorder=cell=>cell.strokeTopWidth||cell.strokeBottomWidth||cell.strokeLeftWidth||cell.strokeRightWidth,exports.parseExcel=async({file:file})=>{let resolver;const sheetPromise=new Promise(resolve=>resolver=resolve),wb=new exceljs_1.default.Workbook,reader=new FileReader,sheets=[];return reader.onload=async()=>{const buffer=reader.result;if(!buffer||"string"==typeof buffer)return void console.warn("Invalid file",buffer);(await wb.xlsx.load(buffer)).eachSheet(sheet=>{var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t,_u,_v,_w,_x,_y,_z,_0,_1,_2,_3,_4,_5,_6,_7;if("hidden"===sheet.state)return;const _sheet={id:spreadsheet_1.uuid(),name:sheet.name,cells:{},activeCell:null,selections:[],mergedCells:[],hiddenRows:[],hiddenColumns:[],filterViews:[],rowCount:Math.max(spreadsheet_1.DEFAULT_ROW_COUNT,sheet.rowCount),columnCount:Math.max(spreadsheet_1.DEFAULT_COLUMN_COUNT,sheet.columns.length)},mergedCellMap=new Map;if(sheet.hasMerges)for(const address in sheet._merges){const{model:bounds}=sheet._merges[address],{top:top,bottom:bottom,left:left,right:right}=bounds;for(const cell of grid_1.getBoundedCells(bounds))mergedCellMap.set(cell,bounds);null===(_a=_sheet.mergedCells)||void 0===_a||_a.push({top:top,bottom:bottom,left:left,right:right})}if(sheet.autoFilter){const[from,to]=sheet.autoFilter.replace(/\$/gi,"").split(":"),topBound=spreadsheet_1.addressToCell(from),bottomBound=spreadsheet_1.addressToCell(to);topBound&&bottomBound&&(null===(_b=_sheet.filterViews)||void 0===_b||_b.push({bounds:{top:null==topBound?void 0:topBound.rowIndex,left:null==topBound?void 0:topBound.columnIndex,right:null==bottomBound?void 0:bottomBound.columnIndex,bottom:null==bottomBound?void 0:bottomBound.rowIndex}}))}const isMergedCell=({rowIndex:rowIndex,columnIndex:columnIndex})=>mergedCellMap.has(grid_1.cellIdentifier(rowIndex,columnIndex)),{views:views}=sheet;for(let i=0;i<views.length;i++){const view=views[i],{activeCell:activeCell}=view;activeCell&&(_sheet.activeCell=spreadsheet_1.addressToCell(activeCell));const{xSplit:xSplit,ySplit:ySplit}=view;void 0!==xSplit&&(_sheet.frozenColumns=xSplit),void 0!==ySplit&&(_sheet.frozenRows=ySplit)}const rowCount=sheet.rowCount;for(let i=1;i<=rowCount;i++){const row=sheet.getRow(i),rowId=row.number,columnCount=row.cellCount;row.hidden&&(null===(_c=_sheet.hiddenRows)||void 0===_c||_c.push(rowId)),_sheet.cells[rowId]={};for(let j=1;j<=columnCount;j++){const cell=row.getCell(j);let value=cell.value;const currentCell={rowIndex:rowId,columnIndex:j};if(isMergedCell(currentCell)){const mergedBounds=mergedCellMap.get(grid_1.cellIdentifier(currentCell.rowIndex,currentCell.columnIndex));if(mergedBounds.top!==currentCell.rowIndex||mergedBounds.left!==currentCell.columnIndex)continue}let fill=void 0,color=void 0,strokes={},fontConfig={};const fillType=cell.style.fill,datatype=exports.getDataTypeFromType(cell.type),border=cell.style.border;if(void 0!==fillType&&"pattern"===(null===(_d=cell.style.fill)||void 0===_d?void 0:_d.type)){const fillValue=null===(_f=null===(_e=cell.style.fill.bgColor)||void 0===_e?void 0:_e.argb)||void 0===_f?void 0:_f.slice(2);fillValue&&(fill="#"+fillValue)}if(null===(_g=cell.font)||void 0===_g?void 0:_g.color){const colorValue=null===(_h=cell.font.color.argb)||void 0===_h?void 0:_h.slice(2);colorValue&&(color="#"+colorValue)}if((null===(_j=cell.font)||void 0===_j?void 0:_j.bold)&&(fontConfig.bold=cell.font.bold),(null===(_k=cell.font)||void 0===_k?void 0:_k.italic)&&(fontConfig.italic=cell.font.italic),(null===(_l=cell.font)||void 0===_l?void 0:_l.underline)&&(fontConfig.underline=!!cell.font.underline),(null===(_m=cell.font)||void 0===_m?void 0:_m.name)&&(fontConfig.fontFamily=cell.font.name),(null===(_o=cell.alignment)||void 0===_o?void 0:_o.horizontal)&&(fontConfig.horizontalAlign=cell.alignment.horizontal),(null===(_p=cell.alignment)||void 0===_p?void 0:_p.vertical)&&(fontConfig.verticalAlign=cell.alignment.vertical),border)for(const key in border)(null===(_r=null===(_q=border[key])||void 0===_q?void 0:_q.color)||void 0===_r?void 0:_r.argb)&&("bottom"===key&&(strokes.strokeBottomDash="dotted"===(null===(_s=border[key])||void 0===_s?void 0:_s.style)?spreadsheet_1.dotArray:[],strokes.strokeBottomWidth=1,strokes.strokeBottomColor="#"+(null===(_v=null===(_u=null===(_t=border[key])||void 0===_t?void 0:_t.color)||void 0===_u?void 0:_u.argb)||void 0===_v?void 0:_v.slice(2))),"top"===key&&(strokes.strokeTopDash="dotted"===(null===(_w=border[key])||void 0===_w?void 0:_w.style)?spreadsheet_1.dotArray:[],strokes.strokeTopWidth=1,strokes.strokeTopColor="#"+(null===(_z=null===(_y=null===(_x=border[key])||void 0===_x?void 0:_x.color)||void 0===_y?void 0:_y.argb)||void 0===_z?void 0:_z.slice(2))),"left"===key&&(strokes.strokeLeftDash="dotted"===(null===(_0=border[key])||void 0===_0?void 0:_0.style)?spreadsheet_1.dotArray:[],strokes.strokeLeftWidth=1,strokes.strokeLeftColor="#"+(null===(_3=null===(_2=null===(_1=border[key])||void 0===_1?void 0:_1.color)||void 0===_2?void 0:_2.argb)||void 0===_3?void 0:_3.slice(2))),"right"===key&&(strokes.strokeRightDash="dotted"===(null===(_4=border[key])||void 0===_4?void 0:_4.style)?spreadsheet_1.dotArray:[],strokes.strokeRightWidth=1,strokes.strokeRightColor="#"+(null===(_7=null===(_6=null===(_5=border[key])||void 0===_5?void 0:_5.color)||void 0===_6?void 0:_6.argb)||void 0===_7?void 0:_7.slice(2))));if(!grid_1.isNull(value)&&"object"==typeof value){const result=value.result;"string"==typeof result&&(value=result)}const text=getCellText(cell),attributes=getCellAttributes(cell);_sheet.cells[rowId][j]={text:text,fill:fill,color:color,datatype:datatype,...strokes,...fontConfig,...attributes}}}sheets.push(_sheet)}),resolver({sheets:sheets})},reader.readAsArrayBuffer(file),sheetPromise},exports.createExcelFileFromSheets=async sheets=>{var _a,_b,_c;const workbook=new exceljs_1.default.Workbook;for(let i=0;i<sheets.length;i++){const sheet=sheets[i],{name:name,cells:cells,frozenColumns:frozenColumns=0,frozenRows:frozenRows=0,mergedCells:mergedCells=[],hiddenRows:hiddenRows=[],hiddenColumns:hiddenColumns=[]}=sheet,rowCount=Math.max(0,...Object.keys(null!=cells?cells:{}).map(Number)),workSheet=workbook.addWorksheet(name),viewState=frozenColumns>0||frozenRows>0?"frozen":"normal";if(workSheet.views.push({state:viewState,xSplit:frozenColumns,ySplit:frozenRows}),mergedCells.length)for(let i=0;i<mergedCells.length;i++){const cur=mergedCells[i],topLeft=spreadsheet_1.cellToAddress({rowIndex:cur.top,columnIndex:cur.left}),bottomRight=spreadsheet_1.cellToAddress({rowIndex:cur.bottom,columnIndex:cur.right});workSheet.mergeCells(`${topLeft}:${bottomRight}`)}hiddenRows.length&&hiddenRows.forEach(id=>workSheet.getRow(id).hidden=!0),hiddenColumns.length&&hiddenColumns.forEach(id=>workSheet.getColumn(id).hidden=!0);for(let j=1;j<=rowCount;j++){const row=cells[j],cellCount=Math.max(0,...Object.keys(null!=row?row:{}).map(Number));for(let k=1;k<=cellCount;k++){const cell=row[k];if(void 0===cell)continue;const address=spreadsheet_1.cellToAddress({rowIndex:j,columnIndex:k});if(null!==address){const newCell=workSheet.getCell(address),value="number"===cell.datatype&&void 0!==cell.text?parseFloat(cell.text.toString()):cell.text;void 0!==value&&(newCell.value=value),newCell.font=null!==(_a=newCell.font)&&void 0!==_a?_a:{},cell.fontFamily&&(newCell.font.name=cell.fontFamily),cell.bold&&(newCell.font.bold=cell.bold),cell.italic&&(newCell.font.italic=cell.italic),cell.underline&&(newCell.font.underline=cell.underline),(cell.horizontalAlign||cell.verticalAlign)&&(newCell.alignment=null!==(_b=newCell.alignment)&&void 0!==_b?_b:{},newCell.alignment.horizontal=cell.horizontalAlign,newCell.alignment.vertical=cell.verticalAlign),cell.color&&(newCell.font.color={argb:"FF"+exports.removeHex(cell.color)}),cell.fill&&(newCell.fill={type:"pattern",pattern:"solid",bgColor:{argb:"FF"+exports.removeHex(cell.fill)},fgColor:{argb:"FF"+exports.removeHex(cell.fill)}});exports.hasBorder(cell)&&(newCell.border=null!==(_c=newCell.border)&&void 0!==_c?_c:{},cell.strokeTopWidth&&cell.strokeTopColor&&(newCell.border.top={style:"thin",color:{argb:"FF"+exports.removeHex(cell.strokeTopColor)}}),cell.strokeBottomWidth&&cell.strokeBottomColor&&(newCell.border.bottom={style:"thin",color:{argb:"FF"+exports.removeHex(cell.strokeBottomColor)}}),cell.strokeLeftWidth&&cell.strokeLeftColor&&(newCell.border.left={style:"thin",color:{argb:"FF"+exports.removeHex(cell.strokeLeftColor)}}),cell.strokeRightWidth&&cell.strokeRightColor&&(newCell.border.right={style:"thin",color:{argb:"FF"+exports.removeHex(cell.strokeRightColor)}}))}}}}return await workbook.xlsx.writeBuffer()}},958:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseCSV=exports.createCSVFromSheets=void 0;const spreadsheet_1=__webpack_require__(42);exports.createCSVFromSheets=async sheets=>{if(0===sheets.length)return"";const{cells:cells}=sheets[0],rowCount=Math.max(0,...Object.keys(null!=cells?cells:{}).map(Number));let csv="";for(let i=1;i<=rowCount;i++){const row=cells[i],cellCount=Math.max(0,...Object.keys(null!=row?row:{}).map(Number)),rowCells=[];for(let j=1;j<=cellCount;j++){const cell=null==row?void 0:row[j];rowCells.push(void 0===cell?"":cell.text)}csv+=rowCells.join(",")+"\n"}return csv},exports.parseCSV=({file:file})=>{let resolver;const sheetPromise=new Promise(resolve=>resolver=resolve),reader=new FileReader,sheet=spreadsheet_1.createNewSheet({count:1});return reader.onload=async()=>{const rows=reader.result.split("\n"),rowCount=rows.length;for(let i=0;i<rowCount;i++){const rowIndex=i+1;sheet.cells[rowIndex]={};const row=rows[i];if(void 0===row)continue;const columns=row.split(","),columnCount=columns.length;for(let j=0;j<columnCount;j++){const columnIndex=j+1;void 0!==columns[j]&&(sheet.cells[rowIndex][columnIndex]={text:columns[j]})}}resolver({sheets:[sheet]})},reader.readAsText(file),sheetPromise}},959:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Borders",(function(){return Borders}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}__webpack_exports__.default={title:"Styling",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a};var Borders=function Borders(){var App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),_useSelection=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.useSelection)({gridRef:gridRef}),selections=_useSelection.selections,selectionProps=_objectWithoutProperties(_useSelection,["selections"]);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,_extends({ref:gridRef,rowCount:100,columnCount:100,selections:selections,borderStyles:[{bounds:{top:1,left:1,right:1,bottom:1},style:{strokeWidth:1,stroke:"red"}},{bounds:{top:5,left:5,right:8,bottom:8},style:{strokeWidth:1,stroke:"green",fill:"red"}}]},selectionProps))};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)};Borders.story={name:"Borders"}},960:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ThemedGrid",(function(){return ThemedGrid}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_exports__.default={title:"Themes",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a};var darkTheme={cellColor:"#ccc",cellBackground:"#181E20",cellOddBackground:"#444"},lightTheme={cellColor:"#333",cellBackground:"white",cellOddBackground:"#eee"},ThemeContext=Object(react__WEBPACK_IMPORTED_MODULE_0__.createContext)(lightTheme),ThemedGrid=function ThemedGrid(){var App=function App(){var _useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(lightTheme),2),theme=_useState2[0],setTheme=_useState2[1],gridRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("button",{type:"button",onClick:function switchTheme(){setTheme((function(prev){return prev===lightTheme?darkTheme:lightTheme}))}},"Switch to ",theme===lightTheme?"Dark":"Light"),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,{ref:gridRef,rowCount:100,columnCount:100,itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(ThemedCell,props)},wrapper:function wrapper(children){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(ThemeContext.Provider,{value:theme},children)}}))};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)},ThemedCell=function ThemedCell(props){var theme=Object(react__WEBPACK_IMPORTED_MODULE_0__.useContext)(ThemeContext),fill=props.rowIndex%2==0?theme.cellBackground:theme.cellOddBackground;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.Cell,_extends({},props,{value:"".concat(props.rowIndex," x ").concat(props.columnIndex),fill:fill,textColor:theme.cellColor}))};ThemedGrid.story={name:"Dark mode"}},961:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"TickingGrid",(function(){return TickingGrid}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__);function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}__webpack_exports__.default={title:"Ticking",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a};var generateKey=function generateKey(){var min=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,rowIndex=Math.floor(30*Math.random())+min,columnIndex=Math.floor(30*Math.random())+min;return[rowIndex,columnIndex]},DataCell=Object(react__WEBPACK_IMPORTED_MODULE_0__.memo)((function(props){var color=props.value>0?"green":"red";return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.Cell,_extends({},props,{textColor:color,align:"right",padding:5}))})),TickingGrid=function TickingGrid(){var _useState3,_useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)((_defineProperty(_useState3={},[0,0],1),_defineProperty(_useState3,[0,2],-20),_useState3)),2),data=_useState2[0],setData=_useState2[1],gridRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)();Object(react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){var interval=setInterval((function(){setData((function(prev){var _objectSpread2,isNegative=Math.random()<.5?-1:1,key=generateKey(),key2=generateKey();return _objectSpread(_objectSpread({},prev),{},(_defineProperty(_objectSpread2={},key,isNegative*Math.floor(100*Math.random())+1),_defineProperty(_objectSpread2,key2,isNegative*Math.floor(100*Math.random())+1),_objectSpread2))}))}),20);return function(){return clearInterval(interval)}}),[]);var getValue=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(_ref){var rowIndex=_ref.rowIndex,columnIndex=_ref.columnIndex;return data[[rowIndex,columnIndex]]}),[data]),_useSelection=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.useSelection)({gridRef:gridRef,rowCount:200,columnCount:200}),selections=_useSelection.selections,selectionProps=_objectWithoutProperties(_useSelection,["selections"]);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,_extends({ref:gridRef,itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(DataCell,_extends({},props,{value:getValue({rowIndex:props.rowIndex,columnIndex:props.columnIndex})}))},rowCount:200,columnCount:200,selections:selections},selectionProps))};TickingGrid.story={name:"Default"}},962:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"TouchGrid",(function(){return TouchGrid}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}__webpack_exports__.default={title:"Mobile (touch)",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a};var TouchGrid=function TouchGrid(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),_useSelection=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.useSelection)({gridRef:gridRef,rowCount:200,columnCount:200}),selections=_useSelection.selections,selectionProps=_objectWithoutProperties(_useSelection,["selections"]),touchProps=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.useTouch)({gridRef:gridRef});return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,_extends({ref:gridRef,itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.Cell,_extends({},props,{value:"".concat(props.rowIndex,":").concat(props.columnIndex)}))},rowCount:200,columnCount:200,selections:selections},selectionProps,touchProps))};TouchGrid.story={name:"Default"}},963:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"TreeTable",(function(){return TreeTable})),__webpack_require__.d(__webpack_exports__,"ExpandCollapseRows",(function(){return ExpandCollapseRows}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__),react_konva__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(10),_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(172);function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_exports__.default={title:"Treetable",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a};var TreeTable=function TreeTable(){var width=Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_3__.number)("width",900),height=Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_3__.number)("height",600),ColumnHeader=function ColumnHeader(_ref){var _data,rowIndex=_ref.rowIndex,columnIndex=_ref.columnIndex,x=_ref.x,y=_ref.y,width=_ref.width,height=_ref.height,data=_ref.data,headers=_ref.headers,onToggleNode=_ref.onToggleNode,treeState=_ref.treeState,column=headers[columnIndex]&&headers[columnIndex].name,datapoint=data[rowIndex-2],text=column&&data[rowIndex-2]?data[rowIndex-2].text:null,hasKids=datapoint&&datapoint.kids,isOpen=!!data[rowIndex-2]&&treeState.open.includes(data[rowIndex-2].id),paddingLeft=8+12*((null===(_data=data[rowIndex-2])||void 0===_data?void 0:_data.depth)||0);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_2__.Group,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_2__.Rect,{x:x,y:y,height:height,width:width,fill:"white",stroke:"#ccc",strokeWidth:.5}),hasKids&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_2__.RegularPolygon,{x:x+paddingLeft,y:y+10,sides:3,radius:5,rotation:isOpen?180:90,fill:"#333",onClick:function onClick(){return onToggleNode(data[rowIndex-2].id,!isOpen)},hitStrokeWidth:20}),text&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_2__.Text,{x:x+paddingLeft+8,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"left"}))},RowHeader=function RowHeader(_ref2){_ref2.rowIndex;var columnIndex=_ref2.columnIndex,x=_ref2.x,y=_ref2.y,width=_ref2.width,height=_ref2.height,headers=_ref2.headers,text=headers[columnIndex]&&headers[columnIndex].header[columnIndex-1].name,_useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),setIsHovered=(_useState2[0],_useState2[1]);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_2__.Group,{onMouseEnter:function onMouseEnter(){return setIsHovered(!0)},onMouseLeave:function onMouseLeave(){return setIsHovered(!1)}},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_2__.Rect,{x:x,y:y,height:height,width:width,fill:"#eee",stroke:"#ccc",strokeWidth:.5}),text&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_2__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"center"})))},Cell=function Cell(_ref3){var rowIndex=_ref3.rowIndex,columnIndex=_ref3.columnIndex,x=_ref3.x,y=_ref3.y,width=_ref3.width,height=_ref3.height,data=(_ref3.isHovered,_ref3.data),headers=_ref3.headers,frozenRows=_ref3.frozenRows,column=headers[columnIndex]&&headers[columnIndex].name,text=column&&data[rowIndex-frozenRows]?data[rowIndex-frozenRows][column]:null;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_2__.Rect,{x:x,y:y,height:height,width:width,fill:"white",stroke:"#ccc",strokeWidth:.5}),text&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_2__.Text,{x:x,y:y,offsetX:10,height:height,width:width,text:text,verticalAlign:"middle",align:"right"}))},EmptyCell=function EmptyCell(_ref4){var rowIndex=_ref4.rowIndex,columnIndex=_ref4.columnIndex,x=_ref4.x,y=_ref4.y,width=_ref4.width,height=_ref4.height;"".concat(rowIndex,"x").concat(columnIndex);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_2__.Rect,{x:x,y:y,height:height,width:width,fill:"#eee",stroke:"#ccc",strokeWidth:.5}))},App=function App(){var _useState4=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)({open:[]}),2),treeState=_useState4[0],setTreeState=_useState4[1],headers=[{name:"id",header:["id"]},{name:"Aggregate",header:[{name:"Group Header"},{name:"Aggregated Value"}]},{name:"Aggregate",header:[null,{name:"Aggregated Value 2"}]}],data=[{id:"Parent",text:"Parent",Aggregate:.2012312312,parent:"",leaf:!1,kids:!0,depth:0},{id:"Parent_Child",text:"Child",Aggregate:12.02,parent:"Parent",leaf:!0,kids:!0,depth:1},{id:"Parent_Child_GrandChild",text:"Grandchild",Aggregate:12.02,parent:"Parent_Child",leaf:!0,kids:!1,depth:2}].filter((function(item){var grandParents=item.parent.split("_").reduce((function(acc,item,index,arr){var prev=arr[index-1]?arr[index-1]+"_":"";return acc.push(prev+item),acc}),[]);return!item.parent||!grandParents.some((function(id){return!treeState.open.includes(id)}))&&treeState.open.includes(item.parent)})),gridRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),_useState6=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)({rowIndex:0,columnIndex:0}),2),setHoveredCell=(_useState6[0],_useState6[1]),rowCount=data.length+2,columnCount=headers.length+1,_useSelection=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.useSelection)({gridRef:gridRef,rowCount:rowCount,columnCount:columnCount}),selection=_useSelection.selection,selectionProps=_objectWithoutProperties(_useSelection,["selection"]),onToggleNode=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(id,isOpen){setTreeState((function(prev){return _objectSpread(_objectSpread({},prev),{},{open:isOpen?prev.open.concat(id):prev.open.filter((function(item){return item!==id}))})}))}),[]);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,_extends({ref:gridRef,width:width,height:height,columnCount:columnCount,rowCount:rowCount,selection:selection,frozenRows:2,frozenColumns:1,mergedCells:[{top:0,left:0,right:0,bottom:1},{top:0,left:1,right:2,bottom:0}],columnWidth:function columnWidth(index){return 150},onMouseMove:function onMouseMove(_,rowIndex,columnIndex){return setHoveredCell({rowIndex:rowIndex,columnIndex:columnIndex})},itemRenderer:function itemRenderer(props){return props.rowIndex<2&&props.columnIndex<1?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(EmptyCell,props):props.rowIndex<2?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(RowHeader,_extends({headers:headers},props)):props.columnIndex<1?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(ColumnHeader,_extends({treeState:treeState,data:data,headers:headers,onToggleNode:onToggleNode},props)):react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Cell,_extends({frozenRows:2,data:data,headers:headers},props))},rowHeight:function rowHeight(index){return 20}},selectionProps))};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)},ExpandCollapseRows=function ExpandCollapseRows(){var App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),_useState8=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)([]),2),open=_useState8[0],toggleOpen=_useState8[1],headers=[{name:"Title"},{name:"Year"},{name:"Votes"}],data=[{id:1,Title:"The Shawshank Redemption",Year:"1994",Votes:"678790"},{parentId:1,Details:"Andy Dufresne, a successful banker, is arrested for the murders of his wife and her lover, and is sentenced to life imprisonment at the Shawshank prison. He becomes the most unconventional prisoner."},{id:2,Title:"The Godfather",Year:1972,Votes:511495},{parentId:2,Details:"Don Vito Corleone, head of a mafia family, decides to hand over his empire to his youngest son Michael. However, his decision unintentionally puts the lives of his loved ones in grave danger."},{id:3,Title:"The Godfather: Part II",Year:"1974",Votes:319352},{parentId:3,Details:"Michael, Vito Corleone's son, attempts to expand his family's criminal empire. While he strikes a business deal with gangster Hyman Roth, he remains unaware of the lurking danger."}].filter((function(row){return!row.parentId||open.includes(row.parentId)})),rowCount=data.length+1,columnCount=headers.length,_useSelection2=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.useSelection)({gridRef:gridRef,rowCount:rowCount,columnCount:columnCount}),selections=_useSelection2.selections,selectionProps=_objectWithoutProperties(_useSelection2,["selections"]),mergedCells=data.reduce((function(acc,row,index){return row.parentId&&acc.push({top:index+1,left:0,right:columnCount-1,bottom:index+1}),acc}),[]),handleToggle=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(rowIndex,columnIndex){var row=data[rowIndex];row&&row.id&&(toggleOpen((function(prev){return prev.includes(row.id)?prev.filter((function(id){return id!==row.id})):[].concat(_toConsumableArray(prev),[row.id])})),gridRef.current.resetAfterIndices({rowIndex:rowIndex},!0))}),[data]);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,_extends({mergedCells:mergedCells,ref:gridRef,rowCount:rowCount,columnCount:columnCount,columnWidth:function columnWidth(columnIndex){return 0===columnIndex?300:100},rowHeight:function rowHeight(rowIndex){var item=data[rowIndex-1];return item&&item.Details?40:20},itemRenderer:function itemRenderer(props){var _headers$columnIndex2,_data$dataStartRowInd,_headers$columnIndex,rowIndex=props.rowIndex,columnIndex=props.columnIndex;if(props.rowIndex<1)return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.Cell,_extends({},props,{align:"left",value:null===(_headers$columnIndex=headers[columnIndex])||void 0===_headers$columnIndex?void 0:_headers$columnIndex.name,fill:"#eee"}));var dataStartRowIndex=rowIndex-1,key=null===(_headers$columnIndex2=headers[columnIndex])||void 0===_headers$columnIndex2?void 0:_headers$columnIndex2.name,id=null===(_data$dataStartRowInd=data[dataStartRowIndex])||void 0===_data$dataStartRowInd?void 0:_data$dataStartRowInd.id,details=data[dataStartRowIndex]?data[dataStartRowIndex].Details:null,value=key&&data[dataStartRowIndex]?data[dataStartRowIndex][key]:"",isOpen=open.includes(id),toggleable=0===columnIndex&&value&&!details;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.Cell,_extends({onClick:function onClick(){return handleToggle(dataStartRowIndex,columnIndex)},verticalAlign:details?"top":"middle",value:value||details},props,{align:"left",padding:toggleable?20:5,wrap:"word"}),0===columnIndex&&value&&!details?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_2__.RegularPolygon,{x:props.x+10,y:props.y+10,sides:3,radius:5,fill:"black",rotation:isOpen?180:90,hitStrokeWidth:20}):null)},frozenRows:1,selections:selections},selectionProps))};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)};ExpandCollapseRows.story={name:"Expand collapse rows"}},964:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"UndoRedo",(function(){return UndoRedo}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}__webpack_exports__.default={title:"Undo Redo",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a};var UndoRedo=function UndoRedo(){var App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),_useUndo=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.useUndo)({onUndo:function onUndo(patches){var path=patches.path,value=patches.value,_path=_slicedToArray(path,2),key=_path[0],_path$=_path[1],rowIndex=_path$.rowIndex,columnIndex=_path$.columnIndex;"data"===key&&(setData((function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},[rowIndex,columnIndex],value))})),setActiveCell({rowIndex:rowIndex,columnIndex:columnIndex}))},onRedo:function onRedo(patches){var path=patches.path,value=patches.value,_path2=_slicedToArray(path,2),key=_path2[0],_path2$=_path2[1],rowIndex=_path2$.rowIndex,columnIndex=_path2$.columnIndex;"data"===key&&(setData((function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},[rowIndex,columnIndex],value))})),setActiveCell({rowIndex:rowIndex,columnIndex:columnIndex}))}}),undo=_useUndo.undo,redo=_useUndo.redo,addToUndoStack=_useUndo.add,canUndo=_useUndo.canUndo,canRedo=_useUndo.canRedo,undoProps=_objectWithoutProperties(_useUndo,["undo","redo","add","canUndo","canRedo"]),_useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)({"1,1":"Hello"}),2),data=_useState2[0],setData=_useState2[1],getCellValue=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(_ref){var rowIndex=_ref.rowIndex,columnIndex=_ref.columnIndex;return data[[rowIndex,columnIndex]]}),[data]),cellValueRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)();cellValueRef.current=getCellValue;var _useSelection=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.useSelection)({rowCount:100,columnCount:100,gridRef:gridRef}),selections=_useSelection.selections,activeCell=_useSelection.activeCell,setActiveCell=_useSelection.setActiveCell,selectionProps=_objectWithoutProperties(_useSelection,["selections","activeCell","setActiveCell"]),_useEditable=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.useEditable)({gridRef:gridRef,getValue:getCellValue,selections:selections,activeCell:activeCell,onDelete:function onDelete(activeCell,selections){if(selections.length){var newValues=selections.reduce((function(acc,_ref2){for(var sel=_ref2.bounds,i=sel.top;i<=sel.bottom;i++)for(var j=sel.left;j<=sel.right;j++)acc[[i,j]]="";return acc}),{});setData((function(prev){return _objectSpread(_objectSpread({},prev),newValues)}));var selectionBounds=selections[0].bounds;gridRef.current.resetAfterIndices({columnIndex:selectionBounds.left,rowIndex:selectionBounds.top},!0)}else activeCell&&(addToUndoStack(Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.createPatches)(["data",activeCell],void 0,cellValueRef.current(activeCell))),setData((function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},[activeCell.rowIndex,activeCell.columnIndex],""))})),gridRef.current.resetAfterIndices(activeCell))},onSubmit:function onSubmit(value,cell,nextActiveCell){var rowIndex=cell.rowIndex,columnIndex=cell.columnIndex,previousValue=cellValueRef.current(cell);setData((function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},[rowIndex,columnIndex],value))})),gridRef.current.resizeColumns([columnIndex]),addToUndoStack(Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.createPatches)(["data",cell],value,previousValue)),nextActiveCell&&setActiveCell(nextActiveCell)}}),editorComponent=_useEditable.editorComponent,editableProps=(_useEditable.editingCell,_useEditable.isEditInProgress,_objectWithoutProperties(_useEditable,["editorComponent","editingCell","isEditInProgress"]));return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1___default.a,_extends({ref:gridRef,activeCell:activeCell,rowCount:100,columnCount:100,selections:selections,itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_1__.Cell,_extends({},props,{padding:0,value:getCellValue({rowIndex:props.rowIndex,columnIndex:props.columnIndex})}))}},selectionProps,editableProps,{onKeyDown:function onKeyDown(){selectionProps.onKeyDown.apply(selectionProps,arguments),editableProps.onKeyDown.apply(editableProps,arguments),undoProps.onKeyDown.apply(undoProps,arguments)},onMouseDown:function onMouseDown(){selectionProps.onMouseDown.apply(selectionProps,arguments),editableProps.onMouseDown.apply(editableProps,arguments)}})),editorComponent,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("button",{disabled:!canUndo,onClick:undo},"Undo"),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("button",{disabled:!canRedo,onClick:redo},"Redo"))};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(App,null)};UndoRedo.story={name:"Default"}}},[[428,1,2]]]);
//# sourceMappingURL=main.049158b6f7c000d29675.bundle.js.map